<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Simplify your type traits with C++14 variable templates | Blog blog("Baptiste Wicht");</title>
<link href="../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../../rss.xml">
<link rel="canonical" href="https://baptiste-wicht.com/posts/2017/08/simplify-your-type-traits-with-c%2B%2B14-variable-templates.html">
<!--[if lt IE 9]><script src="../../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Baptiste Wicht">
<link rel="prev" href="how-to-fix-mdadm-raid5-raid6-growing-stuck-at-0ks.html" title="How to fix mdadm RAID5 / RAID6 growing stuck at 0K/s ?" type="text/html">
<link rel="next" href="../09/cpp11-concurrency-tutorial-futures.html" title="C++11 Concurrency Tutorial - Part 5: Futures" type="text/html">
<meta property="og:site_name" content='Blog blog("Baptiste Wicht");'>
<meta property="og:title" content="Simplify your type traits with C++14 variable templates">
<meta property="og:url" content="https://baptiste-wicht.com/posts/2017/08/simplify-your-type-traits-with-c%2B%2B14-variable-templates.html">
<meta property="og:description" content="Often if you write templated code, you have to write and use a lot of different
traits. In this article, I'll focus on the traits that are representing values,
typically a boolean value. For instance,">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2017-08-22T14:45:11+02:00">
<meta property="article:tag" content="C++">
<meta property="article:tag" content="C++14">
<meta property="article:tag" content="Compilers">
<meta property="article:tag" content="etl">
<meta property="article:tag" content="projects">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://baptiste-wicht.com/">

                <span id="blog-title">Blog blog("Baptiste Wicht");</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../../stories/about.html">About</a>
                </li>
<li>
<a href="../../../stories/publications.html">Publications</a>
                </li>
<li>
<a href="../../../stories/projects.html">Projects</a>
                </li>
<li>
<a href="../../../categories/index.html">Tags</a>
                </li>
<li>
<a href="../../../archive.html">Archives</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<li>
    <a href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.rst" id="sourcelink">Source</a>
    </li>

                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html" class="u-url">Simplify your type traits with C++14 variable templates</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    Baptiste Wicht
            </span></p>
            <p class="dateline">
            <a href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html" rel="bookmark">
            <time class="published dt-published" datetime="2017-08-22T14:45:11+02:00" itemprop="datePublished" title="2017-08-22 14:45">2017-08-22 14:45</time></a>
            </p>
                <p class="commentline">
    
    <a href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#disqus_thread" data-disqus-identifier="cache/posts/2017/08/simplify-your-type-traits-with-c++14-variable-templates.html">Comments</a>


            
        </p>
<p class="sourceline"><a href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.rst" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>Often if you write templated code, you have to write and use a lot of different
traits. In this article, I'll focus on the traits that are representing values,
typically a boolean value. For instance, std::is_const, std::is_same or
std::is_reference are type traits provided by the STL. They are giving you some
information at compile time for a certain type. If you need to write a type
traits, let's say is_float, here is how you would maybe do it in C++11:</p>
<div class="code"><pre class="code c++"><a id="rest_code_8a216448c84644878b288cd2377df2be-1" name="rest_code_8a216448c84644878b288cd2377df2be-1" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_8a216448c84644878b288cd2377df2be-1"></a><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">T</span><span class="o">&gt;</span>
<a id="rest_code_8a216448c84644878b288cd2377df2be-2" name="rest_code_8a216448c84644878b288cd2377df2be-2" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_8a216448c84644878b288cd2377df2be-2"></a><span class="k">struct</span><span class="w"> </span><span class="nc">is_float</span><span class="w"> </span><span class="p">{</span>
<a id="rest_code_8a216448c84644878b288cd2377df2be-3" name="rest_code_8a216448c84644878b288cd2377df2be-3" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_8a216448c84644878b288cd2377df2be-3"></a><span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="k">constexpr</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">is_same</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="o">&gt;::</span><span class="n">value</span><span class="p">;</span>
<a id="rest_code_8a216448c84644878b288cd2377df2be-4" name="rest_code_8a216448c84644878b288cd2377df2be-4" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_8a216448c84644878b288cd2377df2be-4"></a><span class="p">};</span>
</pre></div>
<p>or a bit nicer with a template type alias and std::integral constant:</p>
<div class="code"><pre class="code c++"><a id="rest_code_5fe47aa9cc5249579e5495fb780c17f4-1" name="rest_code_5fe47aa9cc5249579e5495fb780c17f4-1" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_5fe47aa9cc5249579e5495fb780c17f4-1"></a><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">T</span><span class="o">&gt;</span>
<a id="rest_code_5fe47aa9cc5249579e5495fb780c17f4-2" name="rest_code_5fe47aa9cc5249579e5495fb780c17f4-2" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_5fe47aa9cc5249579e5495fb780c17f4-2"></a><span class="k">using</span><span class="w"> </span><span class="n">is_float</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">integral_constant</span><span class="o">&lt;</span><span class="kt">bool</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">is_same</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="o">&gt;::</span><span class="n">value</span><span class="o">&gt;</span><span class="p">;</span>
</pre></div>
<p>or since is_same is itself a type traits, you can also directly alias it:</p>
<div class="code"><pre class="code c++"><a id="rest_code_f45475396d634412bc907efc967deb72-1" name="rest_code_f45475396d634412bc907efc967deb72-1" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_f45475396d634412bc907efc967deb72-1"></a><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">T</span><span class="o">&gt;</span>
<a id="rest_code_f45475396d634412bc907efc967deb72-2" name="rest_code_f45475396d634412bc907efc967deb72-2" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_f45475396d634412bc907efc967deb72-2"></a><span class="k">using</span><span class="w"> </span><span class="n">is_float</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">is_same</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="o">&gt;</span><span class="p">;</span>
</pre></div>
<p>This makes for some very nice syntax, but we still have a type rather than a value.</p>
<p>Note that in some cases, you cannot use the using technique since it cannot be
specialized and you often need specialization to write some more advanced
traits.</p>
<p>And then you would use your traits to do something specific based on that
information. For instance with a very basic example:</p>
<div class="code"><pre class="code C++"><a id="rest_code_9278eca933cb4a84ba0febd1dcc8c35e-1" name="rest_code_9278eca933cb4a84ba0febd1dcc8c35e-1" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_9278eca933cb4a84ba0febd1dcc8c35e-1"></a><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">T</span><span class="o">&gt;</span>
<a id="rest_code_9278eca933cb4a84ba0febd1dcc8c35e-2" name="rest_code_9278eca933cb4a84ba0febd1dcc8c35e-2" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_9278eca933cb4a84ba0febd1dcc8c35e-2"></a><span class="kt">void</span><span class="w"> </span><span class="n">test</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="n">t</span><span class="p">){</span>
<a id="rest_code_9278eca933cb4a84ba0febd1dcc8c35e-3" name="rest_code_9278eca933cb4a84ba0febd1dcc8c35e-3" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_9278eca933cb4a84ba0febd1dcc8c35e-3"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">is_float</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">value</span><span class="p">){</span>
<a id="rest_code_9278eca933cb4a84ba0febd1dcc8c35e-4" name="rest_code_9278eca933cb4a84ba0febd1dcc8c35e-4" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_9278eca933cb4a84ba0febd1dcc8c35e-4"></a><span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">"I'm a float"</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<a id="rest_code_9278eca933cb4a84ba0febd1dcc8c35e-5" name="rest_code_9278eca933cb4a84ba0febd1dcc8c35e-5" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_9278eca933cb4a84ba0febd1dcc8c35e-5"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="rest_code_9278eca933cb4a84ba0febd1dcc8c35e-6" name="rest_code_9278eca933cb4a84ba0febd1dcc8c35e-6" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_9278eca933cb4a84ba0febd1dcc8c35e-6"></a><span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">"I'm not a float"</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<a id="rest_code_9278eca933cb4a84ba0febd1dcc8c35e-7" name="rest_code_9278eca933cb4a84ba0febd1dcc8c35e-7" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_9278eca933cb4a84ba0febd1dcc8c35e-7"></a><span class="w">    </span><span class="p">}</span>
<a id="rest_code_9278eca933cb4a84ba0febd1dcc8c35e-8" name="rest_code_9278eca933cb4a84ba0febd1dcc8c35e-8" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_9278eca933cb4a84ba0febd1dcc8c35e-8"></a><span class="p">}</span>
</pre></div>
<p>Really nothing fancy here, but that will be enough as examples.</p>
<p>Even though all this works pretty, it can be made better on two points. First,
every time you use a traits, you need to use the value member (via ::value).
Secondly, every time you declare a new traits, you have to declare a new type or
a type alias. But all you want is a boolean value.</p>
<p>C++14 introduced a new feature, variable templates. As their name indicates,
they are variables, parametrized with a type. This allows us to write type
traits without using a type alias or struct, meaning we have a real value
instead of a type. If we rewrite our is_float traits with variable templates, we
have the following:</p>
<div class="code"><pre class="code c++"><a id="rest_code_045ef625c19f452ba25228171c7178e7-1" name="rest_code_045ef625c19f452ba25228171c7178e7-1" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_045ef625c19f452ba25228171c7178e7-1"></a><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">T</span><span class="o">&gt;</span>
<a id="rest_code_045ef625c19f452ba25228171c7178e7-2" name="rest_code_045ef625c19f452ba25228171c7178e7-2" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_045ef625c19f452ba25228171c7178e7-2"></a><span class="k">constexpr</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">is_float</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">is_same</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="o">&gt;::</span><span class="n">value</span><span class="p">;</span>
</pre></div>
<p>I think it's much nicer, the intent is clearly stated and there is no
unnecessary code. Moreover, it's also nicer to use:</p>
<div class="code"><pre class="code C++"><a id="rest_code_25b61526db6f43859ff0c66e3be6f3b1-1" name="rest_code_25b61526db6f43859ff0c66e3be6f3b1-1" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_25b61526db6f43859ff0c66e3be6f3b1-1"></a><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">T</span><span class="o">&gt;</span>
<a id="rest_code_25b61526db6f43859ff0c66e3be6f3b1-2" name="rest_code_25b61526db6f43859ff0c66e3be6f3b1-2" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_25b61526db6f43859ff0c66e3be6f3b1-2"></a><span class="kt">void</span><span class="w"> </span><span class="n">test</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="n">t</span><span class="p">){</span>
<a id="rest_code_25b61526db6f43859ff0c66e3be6f3b1-3" name="rest_code_25b61526db6f43859ff0c66e3be6f3b1-3" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_25b61526db6f43859ff0c66e3be6f3b1-3"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">is_float</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">){</span>
<a id="rest_code_25b61526db6f43859ff0c66e3be6f3b1-4" name="rest_code_25b61526db6f43859ff0c66e3be6f3b1-4" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_25b61526db6f43859ff0c66e3be6f3b1-4"></a><span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">"I'm a float"</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<a id="rest_code_25b61526db6f43859ff0c66e3be6f3b1-5" name="rest_code_25b61526db6f43859ff0c66e3be6f3b1-5" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_25b61526db6f43859ff0c66e3be6f3b1-5"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="rest_code_25b61526db6f43859ff0c66e3be6f3b1-6" name="rest_code_25b61526db6f43859ff0c66e3be6f3b1-6" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_25b61526db6f43859ff0c66e3be6f3b1-6"></a><span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">"I'm not a float"</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<a id="rest_code_25b61526db6f43859ff0c66e3be6f3b1-7" name="rest_code_25b61526db6f43859ff0c66e3be6f3b1-7" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_25b61526db6f43859ff0c66e3be6f3b1-7"></a><span class="w">    </span><span class="p">}</span>
<a id="rest_code_25b61526db6f43859ff0c66e3be6f3b1-8" name="rest_code_25b61526db6f43859ff0c66e3be6f3b1-8" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_25b61526db6f43859ff0c66e3be6f3b1-8"></a><span class="p">}</span>
</pre></div>
<p>No more ::value everywhere :) I think it's really cool.</p>
<p>Note that, unlike type alias template, they can be specialized, either fully or
partially, so no more limitation on that side.</p>
<p>Interestingly, variable templates are used in C++17 to provide helpers for each
type traits with values. For instance, std::is_same will have a std::is_same_v
helper that is a variable template. With that, we can simplify our traits a bit
more:</p>
<div class="code"><pre class="code c++"><a id="rest_code_715f0a48205d4cec8afcc8b77fb5c11a-1" name="rest_code_715f0a48205d4cec8afcc8b77fb5c11a-1" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_715f0a48205d4cec8afcc8b77fb5c11a-1"></a><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">T</span><span class="o">&gt;</span>
<a id="rest_code_715f0a48205d4cec8afcc8b77fb5c11a-2" name="rest_code_715f0a48205d4cec8afcc8b77fb5c11a-2" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_715f0a48205d4cec8afcc8b77fb5c11a-2"></a><span class="k">constexpr</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">is_float</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">is_same_v</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="o">&gt;</span><span class="p">;</span>
</pre></div>
<p>Personally, I replaced all the type traits inside ETL using variable templates.
If you don't want to do it, you can also introduce helpers like in the C++17 STL
and start using the wrappers when you see fit so that you don't break any code.</p>
<p>If you want to use this feature, you need a C++14 compiler, such as any version
from GCC5 family or clang 3.6. Although I haven't tested, it should also work on
Microsoft VS2015 Update 2.</p>
<p>Unfortunately there is a bug in both clang (fixed in clang 3.7) and GCC (fixed
in GCC 6 only) that you may encounter if you start using variable templates in
template classes or variable templates used in another variable templates. If
you plan to use variable templates inside a template, such as something like
this:</p>
<div class="code"><pre class="code c++"><a id="rest_code_3adf558aa4884d19836b7087a72a8c96-1" name="rest_code_3adf558aa4884d19836b7087a72a8c96-1" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_3adf558aa4884d19836b7087a72a8c96-1"></a><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">T</span><span class="o">&gt;</span>
<a id="rest_code_3adf558aa4884d19836b7087a72a8c96-2" name="rest_code_3adf558aa4884d19836b7087a72a8c96-2" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_3adf558aa4884d19836b7087a72a8c96-2"></a><span class="k">struct</span><span class="w"> </span><span class="nc">outer_traits</span><span class="w"> </span><span class="p">{</span>
<a id="rest_code_3adf558aa4884d19836b7087a72a8c96-3" name="rest_code_3adf558aa4884d19836b7087a72a8c96-3" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_3adf558aa4884d19836b7087a72a8c96-3"></a><span class="w">    </span><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">X</span><span class="o">&gt;</span>
<a id="rest_code_3adf558aa4884d19836b7087a72a8c96-4" name="rest_code_3adf558aa4884d19836b7087a72a8c96-4" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_3adf558aa4884d19836b7087a72a8c96-4"></a><span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="k">constexpr</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">sub_traits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">is_same</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="o">&gt;::</span><span class="n">value</span><span class="p">;</span>
<a id="rest_code_3adf558aa4884d19836b7087a72a8c96-5" name="rest_code_3adf558aa4884d19836b7087a72a8c96-5" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_3adf558aa4884d19836b7087a72a8c96-5"></a><span class="p">};</span>
<a id="rest_code_3adf558aa4884d19836b7087a72a8c96-6" name="rest_code_3adf558aa4884d19836b7087a72a8c96-6" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_3adf558aa4884d19836b7087a72a8c96-6"></a>
<a id="rest_code_3adf558aa4884d19836b7087a72a8c96-7" name="rest_code_3adf558aa4884d19836b7087a72a8c96-7" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_3adf558aa4884d19836b7087a72a8c96-7"></a><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span><span class="w"> </span><span class="nc">X</span><span class="o">&gt;</span>
<a id="rest_code_3adf558aa4884d19836b7087a72a8c96-8" name="rest_code_3adf558aa4884d19836b7087a72a8c96-8" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_3adf558aa4884d19836b7087a72a8c96-8"></a><span class="k">constexpr</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">outer_helper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">outer_traits</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">template</span><span class="w"> </span><span class="n">sub_traits</span><span class="o">&lt;</span><span class="n">X</span><span class="o">&gt;</span><span class="p">;</span>
<a id="rest_code_3adf558aa4884d19836b7087a72a8c96-9" name="rest_code_3adf558aa4884d19836b7087a72a8c96-9" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_3adf558aa4884d19836b7087a72a8c96-9"></a>
<a id="rest_code_3adf558aa4884d19836b7087a72a8c96-10" name="rest_code_3adf558aa4884d19836b7087a72a8c96-10" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_3adf558aa4884d19836b7087a72a8c96-10"></a><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(){</span>
<a id="rest_code_3adf558aa4884d19836b7087a72a8c96-11" name="rest_code_3adf558aa4884d19836b7087a72a8c96-11" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_3adf558aa4884d19836b7087a72a8c96-11"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">outer_helper</span><span class="o">&lt;</span><span class="kt">float</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="o">&gt;</span><span class="p">;</span>
<a id="rest_code_3adf558aa4884d19836b7087a72a8c96-12" name="rest_code_3adf558aa4884d19836b7087a72a8c96-12" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_3adf558aa4884d19836b7087a72a8c96-12"></a>
<a id="rest_code_3adf558aa4884d19836b7087a72a8c96-13" name="rest_code_3adf558aa4884d19836b7087a72a8c96-13" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_3adf558aa4884d19836b7087a72a8c96-13"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="rest_code_3adf558aa4884d19836b7087a72a8c96-14" name="rest_code_3adf558aa4884d19836b7087a72a8c96-14" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_3adf558aa4884d19836b7087a72a8c96-14"></a><span class="p">}</span>
</pre></div>
<p>You will encounter a not-helpful at all error message with GCC5 family, such as:</p>
<div class="code"><pre class="code text"><a id="rest_code_6053d77025b9420089fd7b1b02d4bcb1-1" name="rest_code_6053d77025b9420089fd7b1b02d4bcb1-1" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_6053d77025b9420089fd7b1b02d4bcb1-1"></a>test.cpp: In instantiation of ‘constexpr const bool outer_helper&lt;float, float&gt;’:
<a id="rest_code_6053d77025b9420089fd7b1b02d4bcb1-2" name="rest_code_6053d77025b9420089fd7b1b02d4bcb1-2" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_6053d77025b9420089fd7b1b02d4bcb1-2"></a>test.cpp:14:22:   required from here
<a id="rest_code_6053d77025b9420089fd7b1b02d4bcb1-3" name="rest_code_6053d77025b9420089fd7b1b02d4bcb1-3" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_6053d77025b9420089fd7b1b02d4bcb1-3"></a>test.cpp:11:20: error: ‘template&lt;class X&gt; constexpr const bool outer_traits&lt;float&gt;::sub_traits&lt;X&gt;’ is not a function template
<a id="rest_code_6053d77025b9420089fd7b1b02d4bcb1-4" name="rest_code_6053d77025b9420089fd7b1b02d4bcb1-4" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_6053d77025b9420089fd7b1b02d4bcb1-4"></a>     constexpr bool outer_helper = outer_traits&lt;T&gt;::template sub_trait
<a id="rest_code_6053d77025b9420089fd7b1b02d4bcb1-5" name="rest_code_6053d77025b9420089fd7b1b02d4bcb1-5" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_6053d77025b9420089fd7b1b02d4bcb1-5"></a>                    ^
<a id="rest_code_6053d77025b9420089fd7b1b02d4bcb1-6" name="rest_code_6053d77025b9420089fd7b1b02d4bcb1-6" href="simplify-your-type-traits-with-c%2B%2B14-variable-templates.html#rest_code_6053d77025b9420089fd7b1b02d4bcb1-6"></a>test.cpp:11:20: error: ‘sub_traits&lt;X&gt;’ is not a member of ‘outer_traits&lt;float&gt;’
</pre></div>
<p>It comes from a bug in the handling of variable templates as dependent names. If
you don't come in this cases, you can use GCC5 family directly, otherwise,
you'll have to use GCC6 family only.</p>
<p>I hope this can help some of you to improve your type traits or at least to
discover the power of the new variable templates. Personally, I've rewritten all
the traits from the ETL library using this new feature and I'm pretty satisfied
with the result. Of course, that means that the compiler support was reduced,
but since I don't have many users, it's not a real issue.</p>
    <h3>Related articles</h3>
    

    <li><a href="../../2015/03/named-optional-template-parameters-compile-time.html">Named Optional Template parameters to configure a class at compile-time</a></li>
<li><a href="../../2015/07/simulate-static_if-with-c11c14.html">Simulate static_if with C++11/C++14</a></li>
<li><a href="../../2011/11/cpp-templates-complete-guide-book.html">C++ Templates : The Complete Guide - Book Review</a></li>
<li><a href="../../2014/07/compile-integer-square-roots-at-compile-time-in-cpp.html">Compile integer Square Roots at compile-time in C++</a></li>
<li><a href="../../2018/02/c++17-migration-of-expression-templates-library-etl.html">C++17 Migration of Expression Templates Library (ETL)</a></li>
<li><a href="../../2016/01/improve-dll-and-etl-compile-time-further.html">Improve DLL and ETL Compile Time further</a></li>


    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../../categories/c%2B%2B.html" rel="tag">C++</a></li>
            <li><a class="tag p-category" href="../../../categories/c%2B%2B14.html" rel="tag">C++14</a></li>
            <li><a class="tag p-category" href="../../../categories/compilers.html" rel="tag">Compilers</a></li>
            <li><a class="tag p-category" href="../../../categories/etl.html" rel="tag">etl</a></li>
            <li><a class="tag p-category" href="../../../categories/projects.html" rel="tag">projects</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="how-to-fix-mdadm-raid5-raid6-growing-stuck-at-0ks.html" rel="prev" title="How to fix mdadm RAID5 / RAID6 growing stuck at 0K/s ?">Previous post</a>
            </li>
            <li class="next">
                <a href="../09/cpp11-concurrency-tutorial-futures.html" rel="next" title="C++11 Concurrency Tutorial - Part 5: Futures">Next post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
        
    
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="blogwichtounet",
            disqus_url="https://baptiste-wicht.com/posts/2017/08/simplify-your-type-traits-with-c%2B%2B14-variable-templates.html",
        disqus_title="Simplify your type traits with C++14 variable templates",
        disqus_identifier="cache/posts/2017/08/simplify-your-type-traits-with-c++14-variable-templates.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section></article><script>var disqus_shortname="blogwichtounet";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         <a href="mailto:baptistewicht@gmail.com">Baptiste Wicht</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         - License: 
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="padding-left:5px;border-width:0" src="../../../assets/img/cc.png"></a>
            
        </footer>
</div>
</div>


            <script src="../../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script>
</body>
</html>
