<!DOCTYPE html>
<html lang=en><head><link href=favicon.ico rel=icon type=image/x-icon><meta name=viewport content="width=device-width, initial-scale=1.0"><meta charset=utf-8><meta name=viewport content="width=device-width, initial-scale=1.0"><meta name=author content="Baptiste Wicht"><title>Manage command-line options with Boost Program Options | @Blog("Baptiste Wicht")</title><link href=../../../assets/css/all-nocdn.css rel=stylesheet type=text/css><link rel=canonical href=http://wichtounet.github.io/posts/2012/07/manage-command-line-boost-program-options.html><link rel=alternate type=application/rss+xml title=RSS href=../../../rss.xml></head><body><div class=social_container> <div class=social_container_gplus> <a target=_blank title="Share on Google+" href="https://plusone.google.com/_/+1/confirm?hl=en&amp;url=http://wichtounet.github.io/posts/2012/07/manage-command-line-boost-program-options.html"><img src=../../../assets/img/google_plus.png></a> </div> <div class=social_container_facebook> <a target=_blank title="Share on Facebook" href="http://www.facebook.com/sharer/sharer.php?u=#url"><img src=../../../assets/img/facebook.png></a> </div> <div class=social_container_twitter> <a target=_blank title="Tweet on Twitter" href="http://twitter.com/home?status=#url"><img src=../../../assets/img/twitter.svg></a> </div></div><nav class="navbar navbar-inverse navbar-fixed-top" role=navigation> <div class=container-fluid> <div class=navbar-header> <button type=button class=navbar-toggle data-toggle=collapse data-target=.navbar-ex1-collapse> <span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span> </button> <a class=navbar-brand href=http://wichtounet.github.io/>@Blog("Baptiste Wicht")</a> </div> <div class="collapse navbar-collapse navbar-ex1-collapse"> <ul class="nav navbar-nav"> <li><a href=../../../stories/about.html>About</a> </li><li><a href=../../../stories/publications.html>Publications</a> </li><li><a href=../../../stories/donate.html>Donate</a> </li><li><a href=../../../stories/contact.html>Contact</a> </li><li><a href=../../../stories/faq.html>FAQ</a> </li><li><a href=../../../stories/legal.html>Legal</a> </li><li><a href=../../../archive.html>Archives</a> </li><li><a href=../../../categories/index.html>Tags</a> </li><li><a href=../../../rss.xml>RSS</a> </li></ul> <span class="navbar-form pull-left"> <form action=../../../stories/search.html> <input type=text name=q id=tipue_search_input> </form> </span> <ul class="nav navbar-nav navbar-right"> <li> <a target=_blank title="Follow @wichtounet on Twitter" href=https://twitter.com/wichtounewichtounet> <img src=../../../assets/img/twitter.svg alt="Follow @wichtounet on Twitter"> </a> </li> <li> <a target=_blank title="Follow +BaptisteWicht on Google+" href=https://plus.google.com/+BaptisteWicht> <img src=../../../assets/img/google_plus.svg alt="Follow +BaptisteWicht on Google+"> </a> </li> </ul> </div> </div></nav><div class=body-container> <div class=left-sidebar> <div class=left-sidebar-widget> <div class=left-sidebar-widget-content> <div class=g-person data-width=275 data-href=//plus.google.com/u/0/103113673902796202116 data-theme=dark data-layout=landscape data-rel=author></div> </div> </div> <div class=left-sidebar-widget> <h3>Related posts</h3> <div class=left-sidebar-widget-content> <ol><li><a href=../../2010/10/compute-command-line-arguments-with-apache-commons-cli.html>Compute command-line arguments with Apache Commons CLI</a></li><li><a href=../../2011/11/boost-1-48-0-has-been-released.html>Boost 1.48.0 has been released </a></li><li><a href=../../2011/11/eddic-0-5-1-better-assembly-generation-and-faster-parsing.html>eddic 0.5.1 : Better assembly generation and faster parsing</a></li><li><a href=../01/boost-enable_if-handle-ambiguous-function-overload-void.html>Use Boost enable_if to handle ambiguous function overload return types</a></li><li><a href=../12/cpp-benchmark-std-list-boost-intrusive-list.html>C++ Benchmark - std::list VS boost::intrusive::list</a></li></ol> </div> </div> <div class=left-sidebar-widget> <h3>Recent comments</h3> <div class=left-sidebar-widget-content> <div id=recentcomments class=dsq-widget> <script type=text/javascript src="http://blogwichtounet.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=0&amp;avatar_size=28&amp;excerpt_length=50"></script> </div> </div> </div> <div class=left-sidebar-widget> <h3>Popular posts</h3> <div class=left-sidebar-widget-content> <div id=popularthreads class=dsq-widget> <script type=text/javascript src="http://blogwichtounet.disqus.com/popular_threads_widget.js?num_items=5&amp;days_back=90"></script> </div> </div> </div> <div class=left-sidebar-widget> <h3>Blogroll</h3> <div class=left-sidebar-widget-content> <ul> <li><a target=_blank href=http://www.asjava.com/>AsJava.com : Java Tutorial</a></li> <li><a target=_blank href=http://www.mkyong.com/>Mkyong : Java Tutorials</a></li> </ul> </div> </div> </div> <div class=container> <div class=body-content style="margin-top: -75px;"> <div class=row> <article class="postbox post-text"> <div class=h-entry itemscope=itemscope itemtype=http://schema.org/Article> <h1 class=p-name itemprop="headline name">Manage command-line options with Boost Program Options</h1> <hr> <small> Posted: <time class="published dt-published" datetime=2012-07-19T08:19:37+02:00 itemprop=datePublished>2012-07-19 08:19</time>   |   More posts about <span itemprop=keywords> <a class="tag p-category" href=../../../categories/boost.html><span class="badge badge-info">Boost</span></a> <a class="tag p-category" href=../../../categories/c.html><span class="badge badge-info">C++</span></a> </span> </small> <hr> <div class=e-content itemprop="articleBody text"> <div><p>In command-line program, we often faces problems with the management of command-line options. When you have a few options, it's not a problem. But when writing complex programs with tens of options (or hundreds), it starts to be too complicated to manage by hand. That's where <strong>Boost Program Options</strong> enters the game!</p><p>Boost Program Options is one of the Boost C++ Libraries. It is a very powerful library to handle command-line options. You define all the options of the program and then Boost Program Options takes care of all. It parses the command line, handles errors, gets values and even displays help. It is not a perfect library. But it is very complete that will answer most of the common needs. </p><p>This library is not header-only. You will need to build the library and link your program with the library. </p><h4>Getting started</h4><p>In this article, I will use <em>po</em> as an abbreviation of boost::program_options and all source will contains this namespace alias:</p><div class=code><pre><span class=k>namespace</span> <span class=n>po</span> <span class=o>=</span> <span class=n>boost</span><span class=o>::</span><span class=n>program_options</span><span class=p>;</span>
</pre></div><p>First of all, it is necessary to create an instance of po::option_description:</p><div class=code><pre><span class=n>po</span><span class=o>::</span><span class=n>options_description</span> <span class=n>description</span><span class=p>(</span><span class=s>"MyTool Usage"</span><span class=p>);</span>

<span class=n>description</span><span class=p>.</span><span class=n>add_options</span><span class=p>()</span>
    <span class=p>(</span><span class=s>"help"</span><span class=p>,</span> <span class=s>"Display this help message"</span><span class=p>)</span>
    <span class=p>(</span><span class=s>"version"</span><span class=p>,</span> <span class=s>"Display the version number"</span><span class=p>);</span>
</pre></div><p>The parameter to the constructor is the title of the options. To add options, you use the add_options() function and append all your options, each one surrounded with parenthesis. Here, we declared two options (help and version). They can be set with <em>--help</em> and <em>--version</em>. </p><p>Then, you can parse the command line by declaring a po::variables_map to store the variables and parse the command line into that storage: </p><div class=code><pre><span class=n>po</span><span class=o>::</span><span class=n>variables_map</span> <span class=n>vm</span><span class=p>;</span>
<span class=n>po</span><span class=o>::</span><span class=n>store</span><span class=p>(</span><span class=n>po</span><span class=o>::</span><span class=n>command_line_parser</span><span class=p>(</span><span class=n>argc</span><span class=p>,</span> <span class=n>argv</span><span class=p>).</span><span class=n>options</span><span class=p>(</span><span class=n>description</span><span class=p>).</span><span class=n>run</span><span class=p>(),</span> <span class=n>vm</span><span class=p>);</span>
<span class=n>po</span><span class=o>::</span><span class=n>notify</span><span class=p>(</span><span class=n>vm</span><span class=p>);</span>
</pre></div><p>Then, you can easily verify if an option has been set by using the <em>count(const std::string&amp; name)</em> function on the <em>vm</em> object: </p><div class=code><pre><span class=k>if</span><span class=p>(</span><span class=n>vm</span><span class=p>.</span><span class=n>count</span><span class=p>(</span><span class=s>"help"</span><span class=p>)){</span>
    <span class=n>std</span><span class=o>::</span><span class=n>cout</span> <span class=o>&amp;</span><span class=n>lt</span><span class=p>;</span><span class=o>&amp;</span><span class=n>lt</span><span class=p>;</span> <span class=n>description</span><span class=p>;</span>
<span class=p>}</span>
</pre></div><p>You can use <em>operator on the description to output all the options of program. </em></p><h4>Short options</h4><p>By default, all the options are accessed by using -- in front of them. You can also specify a short version for each option: </p><div class=code><pre><span class=n>description</span><span class=p>.</span><span class=n>add_options</span><span class=p>()</span>
    <span class=p>(</span><span class=s>"help,h"</span><span class=p>,</span> <span class=s>"Display this help message"</span><span class=p>)</span>
    <span class=p>(</span><span class=s>"version,v"</span><span class=p>,</span> <span class=s>"Display the version number"</span><span class=p>);</span>
</pre></div><p>With that, you can display with either --help or -h. Even if you select help with -h, you can still verify if help has been set with count("help"). </p><h4>Option with value</h4><p>Boost Program Options can also handle option that need a specific value. Lets add a <i>compression</i> option:</p><div class=code><pre><span class=n>description</span><span class=p>.</span><span class=n>add_options</span><span class=p>()</span>
    <span class=p>(</span><span class=s>"help,h"</span><span class=p>,</span> <span class=s>"Display this help message"</span><span class=p>)</span>
    <span class=p>(</span><span class=s>"compression,c"</span><span class=p>,</span> <span class=n>po</span><span class=o>::</span><span class=n>value</span><span class=o>&amp;</span><span class=n>lt</span><span class=p>;</span><span class=kt>int</span><span class=o>&amp;</span><span class=n>gt</span><span class=p>;(),</span> <span class=s>"Compression level"</span><span class=p>)</span>
    <span class=p>(</span><span class=s>"version,v"</span><span class=p>,</span> <span class=s>"Display the version number"</span><span class=p>);</span>
</pre></div><p>You can then get the value of option easily: </p><div class=code><pre><span class=k>if</span><span class=p>(</span><span class=n>vm</span><span class=p>.</span><span class=n>count</span><span class=p>(</span><span class=s>"compression"</span><span class=p>)){</span>
    <span class=n>std</span><span class=o>::</span><span class=n>cout</span> <span class=o>&amp;</span><span class=n>lt</span><span class=p>;</span><span class=o>&amp;</span><span class=n>lt</span><span class=p>;</span> <span class=s>"Compression level "</span> <span class=o>&amp;</span><span class=n>lt</span><span class=p>;</span><span class=o>&amp;</span><span class=n>lt</span><span class=p>;</span> <span class=n>vm</span><span class=p>[</span><span class=s>"compression"</span><span class=p>].</span><span class=n>as</span><span class=o>&amp;</span><span class=n>lt</span><span class=p>;</span><span class=kt>int</span><span class=o>&amp;</span><span class=n>gt</span><span class=p>;()</span> <span class=o>&amp;</span><span class=n>lt</span><span class=p>;</span><span class=o>&amp;</span><span class=n>lt</span><span class=p>;</span> <span class=n>std</span><span class=o>::</span><span class=n>endl</span><span class=p>;</span>
<span class=p>}</span>
</pre></div><p>For the story, the option value are stored as boost::any. You can get the value of the option by using operator[] on the po::variables_map. You can get the value type with the as function with the type you need. </p><p>On the command line, the value can be set with --compression 10, -c 10 or -c10. </p><p>You can also configure a default value for an option:</p><div class=code><pre><span class=n>description</span><span class=p>.</span><span class=n>add_options</span><span class=p>()</span>
    <span class=p>(</span><span class=s>"help,h"</span><span class=p>,</span> <span class=s>"Display this help message"</span><span class=p>)</span>
    <span class=p>(</span><span class=s>"compression,c"</span><span class=p>,</span> <span class=n>po</span><span class=o>::</span><span class=n>value</span><span class=o>&amp;</span><span class=n>lt</span><span class=p>;</span><span class=kt>int</span><span class=o>&amp;</span><span class=n>gt</span><span class=p>;()</span><span class=o>-&amp;</span><span class=n>gt</span><span class=p>;</span><span class=n>default_value</span><span class=p>(</span><span class=mi>5</span><span class=p>),</span> <span class=s>"Compression level"</span><span class=p>)</span>
    <span class=p>(</span><span class=s>"version,v"</span><span class=p>,</span> <span class=s>"Display the version number"</span><span class=p>);</span>
</pre></div><p>With that, if the option is not set on the command line, the option has the specified value. With that, the option is always defined. </p><p>Finally, you can also set an implicit value. This is the value of the option is the option is set to the command line without a value (--compression or -c): </p><div class=code><pre><span class=n>description</span><span class=p>.</span><span class=n>add_options</span><span class=p>()</span>
    <span class=p>(</span><span class=s>"help,h"</span><span class=p>,</span> <span class=s>"Display this help message"</span><span class=p>)</span>
    <span class=p>(</span><span class=s>"compression,c"</span><span class=p>,</span> <span class=n>po</span><span class=o>::</span><span class=n>value</span><span class=o>&amp;</span><span class=n>lt</span><span class=p>;</span><span class=kt>int</span><span class=o>&amp;</span><span class=n>gt</span><span class=p>;()</span><span class=o>-&amp;</span><span class=n>gt</span><span class=p>;</span><span class=n>default_value</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span><span class=o>-&amp;</span><span class=n>gt</span><span class=p>;</span><span class=n>implicit_value</span><span class=p>(</span><span class=mi>10</span><span class=p>),</span> <span class=s>"Compression level"</span><span class=p>)</span>
    <span class=p>(</span><span class=s>"version,v"</span><span class=p>,</span> <span class=s>"Display the version number"</span><span class=p>);</span>
</pre></div><h4>Positional options</h4><p>It is often convenient to have a list of files on the command line. These options does not have a name. In Boost Program Options, these options are called positional options. You have to declare them in the describe as any other action. For example, for a list of files: </p><div class=code><pre><span class=n>description</span><span class=p>.</span><span class=n>add_options</span><span class=p>()</span>
    <span class=p>(</span><span class=s>"help,h"</span><span class=p>,</span> <span class=s>"Display this help message"</span><span class=p>)</span>
    <span class=p>(</span><span class=s>"compression,c"</span><span class=p>,</span> <span class=n>po</span><span class=o>::</span><span class=n>value</span><span class=o>&amp;</span><span class=n>lt</span><span class=p>;</span><span class=kt>int</span><span class=o>&amp;</span><span class=n>gt</span><span class=p>;()</span><span class=o>-&amp;</span><span class=n>gt</span><span class=p>;</span><span class=n>default_value</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span><span class=o>-&amp;</span><span class=n>gt</span><span class=p>;</span><span class=n>implicit_value</span><span class=p>(</span><span class=mi>10</span><span class=p>),</span><span class=s>"Compression level"</span><span class=p>)</span>
    <span class=p>(</span><span class=s>"input-files"</span><span class=p>,</span> <span class=n>po</span><span class=o>::</span><span class=n>value</span><span class=o>&amp;</span><span class=n>lt</span><span class=p>;</span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&amp;</span><span class=n>lt</span><span class=p>;</span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=o>&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>&amp;</span><span class=n>gt</span><span class=p>;(),</span> <span class=s>"Input files"</span><span class=p>)</span>
    <span class=p>(</span><span class=s>"version,v"</span><span class=p>,</span> <span class=s>"Display the version number"</span><span class=p>);</span>
</pre></div><p>Then, you have to declare it as positional and then finally specify it when parsing the command-line: </p><div class=code><pre><span class=n>po</span><span class=o>::</span><span class=n>positional_options_description</span> <span class=n>p</span><span class=p>;</span>
<span class=n>p</span><span class=p>.</span><span class=n>add</span><span class=p>(</span><span class=s>"input-files"</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>);</span>
<span class=n>po</span><span class=o>::</span><span class=n>variables_map</span> <span class=n>vm</span><span class=p>;</span>
<span class=n>po</span><span class=o>::</span><span class=n>store</span><span class=p>(</span><span class=n>po</span><span class=o>::</span><span class=n>command_line_parser</span><span class=p>(</span><span class=n>argc</span><span class=p>,</span> <span class=n>argv</span><span class=p>).</span><span class=n>options</span><span class=p>(</span><span class=n>description</span><span class=p>).</span><span class=n>positional</span><span class=p>(</span><span class=n>p</span><span class=p>).</span><span class=n>run</span><span class=p>(),</span> <span class=n>vm</span><span class=p>);</span>
<span class=n>po</span><span class=o>::</span><span class=n>notify</span><span class=p>(</span><span class=n>vm</span><span class=p>);</span>
</pre></div><p>The positional options values are retrieved the exact same way as other options: </p><div class=code><pre><span class=k>if</span><span class=p>(</span><span class=n>vm</span><span class=p>.</span><span class=n>count</span><span class=p>(</span><span class=s>"input-files"</span><span class=p>)){</span>
    <span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&amp;</span><span class=n>lt</span><span class=p>;</span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=o>&amp;</span><span class=n>gt</span><span class=p>;</span> <span class=n>files</span> <span class=o>=</span> <span class=n>vm</span><span class=p>[</span><span class=s>"input-files"</span><span class=p>].</span><span class=n>as</span><span class=o>&amp;</span><span class=n>lt</span><span class=p>;</span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&amp;</span><span class=n>lt</span><span class=p>;</span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=o>&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>&amp;</span><span class=n>gt</span><span class=p>;();</span>
    <span class=k>for</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>string</span> <span class=n>file</span> <span class=o>:</span> <span class=n>files</span><span class=p>){</span>
        <span class=n>std</span><span class=o>::</span><span class=n>cout</span> <span class=o>&amp;</span><span class=n>lt</span><span class=p>;</span><span class=o>&amp;</span><span class=n>lt</span><span class=p>;</span> <span class=s>"Input file "</span> <span class=o>&amp;</span><span class=n>lt</span><span class=p>;</span><span class=o>&amp;</span><span class=n>lt</span><span class=p>;</span> <span class=n>file</span> <span class=o>&amp;</span><span class=n>lt</span><span class=p>;</span><span class=o>&amp;</span><span class=n>lt</span><span class=p>;</span> <span class=n>std</span><span class=o>::</span><span class=n>endl</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>}</span>
</pre></div><h4>Wrap-Up</h4><p>In this article, we saw the most important aspects of Boost Program Options. With these notions, you can start using this great library. If you need more information about the library, you can read <a href=http://www.boost.org/doc/libs/1_50_0/doc/html/program_options.html title="Boost Program Options documentation">the official documentation</a> that is very well made. </p><p>You can download the final sources of this article on Github: <a href=https://github.com/wichtounet/articles/blob/master/src/boost_po/v1.cpp title="Source file for this article">v1.cpp</a></p></div> </div> </div> <ul class=pager> <li class=previous> <a href=c11-concurrency-tutorial-part-4-atomic-type.html rel=prev>← Previous post</a> </li> <li class=next> <a href=eddi-compiler-1-1-0-member-functions.html rel=next>Next post →</a> </li> </ul> <div id=disqus_thread></div> <script>
        var disqus_shortname ="blogwichtounet",
            disqus_url="http://wichtounet.github.io/posts/2012/07/manage-command-line-boost-program-options.html",
        disqus_title="Manage command-line options with Boost Program Options",
        disqus_identifier="cache/posts/2012/07/manage-command-line-boost-program-options.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script> <noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript rel=nofollow>comments powered by Disqus.</a></noscript> <a href=http://disqus.com class=dsq-brlink rel=nofollow>Comments powered by <span class=logo-disqus>Disqus</span></a> </article> </div> </div> </div></div><footer> Contents © 2014 <a href=mailto:baptistewicht@gmail.com>Baptiste Wicht</a> - Powered by <a href=http://getnikola.com rel=nofollow>Nikola</a><a rel=license href=http://creativecommons.org/licenses/by/4.0/><img alt="Creative Commons License" style=padding-left:5px;border-width:0 src=../../../assets/img/cc.png></a> <ul class=footer_inline_ul> <li> <a href=manage-command-line-boost-program-options.wp id=sourcelink>Source</a> </li> </ul></footer> <script src=../../../assets/js/all-nocdn.js type=text/javascript></script><script type=text/javascript src=https://apis.google.com/js/platform.js></script></body></html>