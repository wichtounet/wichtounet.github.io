<!DOCTYPE html>
<html lang=en><head><link href=favicon.ico rel=icon type=image/x-icon><meta name=viewport content="width=device-width, initial-scale=1.0"><meta charset=utf-8><meta name=viewport content="width=device-width, initial-scale=1.0"><meta name=author content="Baptiste Wicht"><title>NIO.2 : The new Path API in Java 7 | @Blog("Baptiste Wicht")</title><link href=../../../assets/css/all-nocdn.css rel=stylesheet type=text/css><link rel=canonical href=http://wichtounet.github.io/posts/2010/03/nio-2-path-api-java-7.html><link rel=alternate type=application/rss+xml title=RSS href=../../../rss.xml></head><body><div class=social_container> <div class=social_container_gplus> <a target=_blank title="Share on Google+" href="https://plusone.google.com/_/+1/confirm?hl=en&amp;url=http://wichtounet.github.io/posts/2010/03/nio-2-path-api-java-7.html"><img src=../../../assets/img/google_plus.png></a> </div> <div class=social_container_facebook> <a target=_blank title="Share on Facebook" href="http://www.facebook.com/sharer/sharer.php?u=#url"><img src=../../../assets/img/facebook.png></a> </div> <div class=social_container_twitter> <a target=_blank title="Tweet on Twitter" href="http://twitter.com/home?status=#url"><img src=../../../assets/img/twitter.svg></a> </div></div><nav class="navbar navbar-inverse navbar-fixed-top" role=navigation> <div class=container-fluid> <div class=navbar-header> <button type=button class=navbar-toggle data-toggle=collapse data-target=.navbar-ex1-collapse> <span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span> </button> <a class=navbar-brand href=http://wichtounet.github.io/>@Blog("Baptiste Wicht")</a> </div> <div class="collapse navbar-collapse navbar-ex1-collapse"> <ul class="nav navbar-nav"> <li><a href=../../../stories/about.html>About</a> </li><li><a href=../../../stories/publications.html>Publications</a> </li><li><a href=../../../stories/donate.html>Donate</a> </li><li><a href=../../../stories/contact.html>Contact</a> </li><li><a href=../../../stories/faq.html>FAQ</a> </li><li><a href=../../../stories/legal.html>Legal</a> </li><li><a href=../../../categories/index.html>Tags</a> </li><li><a href=../../../archive.html>Archives</a> </li><li><a href=http://feeds.feedburner.com/BaptisteWicht>RSS</a> </li></ul> <span class="navbar-form pull-left"> <form action=../../../stories/search.html> <input type=text name=q id=tipue_search_input> </form> </span> <ul class="nav navbar-nav navbar-right"> <li> <a target=_blank title="Follow @wichtounet on Twitter" href=https://twitter.com/wichtounewichtounet> <img src=../../../assets/img/twitter.svg alt="Follow @wichtounet on Twitter"> </a> </li> <li> <a target=_blank title="Follow +BaptisteWicht on Google+" href=https://plus.google.com/+BaptisteWicht> <img src=../../../assets/img/google_plus.svg alt="Follow +BaptisteWicht on Google+"> </a> </li> </ul> </div> </div></nav><div class=body-container> <div class=left-sidebar> <div class=left-sidebar-widget> <div class=left-sidebar-widget-content> <div class=g-person data-width=275 data-href=//plus.google.com/u/0/103113673902796202116 data-theme=dark data-layout=landscape data-rel=author></div> </div> </div> <div class=left-sidebar-widget> <h3>Related posts</h3> <div class=left-sidebar-widget-content> <ol><li><a href=../08/file-copy-benchmark-updates-once-again.html>Java File Copy Benchmark Updates (once again)</a></li><li><a href=../08/do-not-use-relative-path-with-logback.html>Do not use relative path with LogBack</a></li><li><a href=../08/file-copy-in-java-benchmark.html>File copy in Java - Benchmark</a></li><li><a href=../04/java-7-new-io-features-asynchronous-operations-multicasting-random-access-with-jsr-203-nio-2.html>Java 7 : New I/O features (Asynchronous operations, multicasting, random access) with JSR 203 (NIO.2)</a></li><li><a href=../../2011/07/java-7-has-been-released.html>Java 7 has been released!</a></li></ol> </div> </div> <div class=left-sidebar-widget> <h3>Recent comments</h3> <div class=left-sidebar-widget-content> <div id=recentcomments class=dsq-widget> <script type=text/javascript src="http://blogwichtounet.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=0&amp;avatar_size=28&amp;excerpt_length=50"></script> </div> </div> </div> <div class=left-sidebar-widget> <h3>Popular posts</h3> <div class=left-sidebar-widget-content> <div id=popularthreads class=dsq-widget> <script type=text/javascript src="http://blogwichtounet.disqus.com/popular_threads_widget.js?num_items=5&amp;days_back=90"></script> </div> </div> </div> <div class=left-sidebar-widget> <h3>Blogroll</h3> <div class=left-sidebar-widget-content> <ul> <li><a target=_blank href=http://www.asjava.com/>AsJava.com : Java Tutorial</a></li> <li><a target=_blank href=http://www.mkyong.com/>Mkyong : Java Tutorials</a></li> </ul> </div> </div> </div> <div class=container> <div class=body-content style="margin-top: -75px;"> <div class=row> <article class="postbox post-text"> <div class=h-entry itemscope=itemscope itemtype=http://schema.org/Article> <h1 class=p-name itemprop="headline name">NIO.2 : The new Path API in Java 7</h1> <hr> <small> Posted: <time class="published dt-published" datetime=2010-03-31T06:55:52+02:00 itemprop=datePublished>2010-03-31 06:55</time>   |   More posts about <span itemprop=keywords> <a class="tag p-category" href=../../../categories/io.html><span class="badge badge-info">I/O</span></a> <a class="tag p-category" href=../../../categories/java.html><span class="badge badge-info">Java</span></a> <a class="tag p-category" href=../../../categories/java-7.html><span class="badge badge-info">Java 7</span></a> <a class="tag p-category" href=../../../categories/performances.html><span class="badge badge-info">Performances</span></a> </span> </small> <hr> <div class=e-content itemprop="articleBody text"> <div><p>In Java 7 we'll see a new API to manipulate file paths. This is part of the NIO.2 API.</p><p>Instead of using the class <strong>java.io.File</strong> to manipulate a file of the file system of the computer we will now use the <strong>java.nio.file.Path</strong> class to manipulate a file in any file system (<strong>FileSystem</strong>). This <strong>FileSystem </strong>can use any storage place (<strong>FileStorage</strong>). To support several implementations, this new API is based on factories. With that, you doesn't have to care about the real implementation.</p><p>A little example to start : In Java &lt; 7, you do that :</p><div class=code><pre><span class=n>File</span> <span class=n>file</span> <span class=o>=</span> <span class=k>new</span> <span class=n>File</span><span class=o>(</span><span class=s>"index.html"</span><span class=o>);</span>
</pre></div><p>and with Java 7, you can do that :</p><div class=code><pre><span class=n>Path</span> <span class=n>path</span> <span class=o>=</span> <span class=n>Paths</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=s>"index.html"</span><span class=o>);</span>
</pre></div><p>To make the migration easier, the File class has a new method toPath() that allows you to transform File to Path :</p><div class=code><pre><span class=n>Path</span> <span class=n>path</span> <span class=o>=</span> <span class=k>new</span> <span class=n>File</span><span class=o>(</span><span class=s>"index.html"</span><span class=o>).</span><span class=na>toPath</span><span class=o>();</span>
</pre></div><p>But, it's only useful for migration purpose, we will not use that normally.</p><p>By default, all the Path will refers to files in the basic file system (the file system of the computer), but this new API is totally modular. We could imagine an implementation of FileSystem for data in memory, on the network or a virtual file system.</p><p>Like File, a Path can also refer to a not existing file. That's only file path, not the data containing in a file.</p><p>If we look at the methods of this new class, we can see that we have almost the same methods than the File class. But there is an important difference. The methods of the Path class throws Exception and that's a really good points. In fact, with the old File methods, we doesn't know anything if there is a problem. Sometimes we know that a problem occured with a simple boolean, but that's all.</p><p>Now we can have the cause of the Exception, that's far better. Here is a little example to delete a file using File :</p><div class=code><pre><span class=k>if</span> <span class=o>(!</span><span class=n>file</span><span class=o>.</span><span class=na>delete</span><span class=o>()){</span>
    <span class=c1>//What happens ?</span>
<span class=o>}</span>
</pre></div><p>and now using Path :</p><div class=code><pre><span class=k>try</span> <span class=o>{</span>      
    <span class=n>path</span><span class=o>.</span><span class=na>delete</span><span class=o>();</span>    
<span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>IOException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
    <span class=c1>// We can know the cause and have a good reaction</span>
<span class=o>}</span>
</pre></div><p>An other enormous difference is the access to the attributes of the denoted file. In the old style, we have only access to the properties available in all the operating system. Now with views we can access the basic views, existing for all the operating systems and more specific views (DOS and POSIX) for properties available only in certain operating systems.</p><p>Here is a little example to get the basic attributes of a Path :</p><div class=code><pre><span class=n>BasicFileAttributeView</span> <span class=n>basicView</span> <span class=o>=</span> <span class=n>path</span><span class=o>.</span><span class=na>getFileAttributeView</span><span class=o>(</span><span class=n>BasicFileAttributeView</span><span class=o>.</span><span class=na>class</span><span class=o>,</span> <span class=n>LinkOption</span><span class=o>.</span><span class=na>NOFOLLOW_LINKS</span><span class=o>);</span> 

<span class=c1>//This attribute view is perhaps not available in this system</span>
<span class=k>if</span> <span class=o>(</span><span class=n>basicView</span> <span class=o>!=</span> <span class=kc>null</span><span class=o>)</span> <span class=o>{</span>
    <span class=n>BasicFileAttributes</span> <span class=n>basic</span> <span class=o>=</span> <span class=n>basicView</span><span class=o>.</span><span class=na>readAttributes</span><span class=o>();</span> <span class=c1>//Get the attributes of the view</span>

    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>"Path refers to a regular file : "</span> <span class=o>+</span> <span class=n>basic</span><span class=o>.</span><span class=na>isRegularFile</span><span class=o>());</span>
    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>"Path refers to a directory : "</span> <span class=o>+</span> <span class=n>basic</span><span class=o>.</span><span class=na>isDirectory</span><span class=o>());</span>
    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>"Path refers to a symbolic link : "</span> <span class=o>+</span> <span class=n>basic</span><span class=o>.</span><span class=na>isSymbolicLink</span><span class=o>());</span>
    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>"Path refers to a file with a size of : "</span> <span class=o>+</span> <span class=n>basic</span><span class=o>.</span><span class=na>size</span><span class=o>());</span>
    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>"Path refers to a file last created at : "</span> <span class=o>+</span> <span class=n>basic</span><span class=o>.</span><span class=na>creationTime</span><span class=o>());</span>
    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>"Path refers to a file last accessed at : "</span> <span class=o>+</span> <span class=n>basic</span><span class=o>.</span><span class=na>lastAccessTime</span><span class=o>());</span>
    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>"Path refers to a file last modified at  : "</span> <span class=o>+</span> <span class=n>basic</span><span class=o>.</span><span class=na>lastModifiedTime</span><span class=o>());</span>
<span class=o>}</span>
</pre></div><p>This methods can return null if the attribute is not supported. We can also do that for the DOS attributes :</p><div class=code><pre><span class=n>DosFileAttributeView</span> <span class=n>dosView</span> <span class=o>=</span> <span class=n>path</span><span class=o>.</span><span class=na>getFileAttributeView</span><span class=o>(</span><span class=n>DosFileAttributeView</span><span class=o>.</span><span class=na>class</span><span class=o>);</span> 

<span class=c1>//This attribute view is perhaps not available in this system</span>

<span class=k>if</span> <span class=o>(</span><span class=n>dosView</span> <span class=o>!=</span> <span class=kc>null</span><span class=o>)</span> <span class=o>{</span>
    <span class=n>DosFileAttributes</span> <span class=n>dos</span> <span class=o>=</span> <span class=n>dosView</span><span class=o>.</span><span class=na>readAttributes</span><span class=o>();</span> <span class=c1>//Get the attributes of the view</span>

    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>"Path refers to a hidden file : "</span> <span class=o>+</span> <span class=n>dos</span> <span class=o>.</span><span class=na>isHidden</span><span class=o>());</span>
    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>"Path refers to a read only file : "</span> <span class=o>+</span> <span class=n>dos</span> <span class=o>.</span><span class=na>isReadOnly</span><span class=o>());</span>
    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>"Path refers to a system file: "</span> <span class=o>+</span> <span class=n>dos</span> <span class=o>.</span><span class=na>isSystem</span><span class=o>());</span>
    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>"Path refers to an archive file : "</span> <span class=o>+</span> <span class=n>dos</span> <span class=o>.</span><span class=na>isArchive</span><span class=o>());</span>
<span class=o>}</span>
</pre></div><p>You're really lucky if that works in Unix ;)</p><p>All the DOS and POSIX implementations extends the Basic view, so you can access all the basic attributes from an implementation view.</p><p>To make easier, there is also static methods in the Attributes class to access the attributes. By example :</p><div class=code><pre><span class=n>BasicFileAttributes</span> <span class=n>basic</span> <span class=o>=</span> <span class=n>Attributes</span><span class=o>.</span><span class=na>readBasicFileAttributes</span><span class=o>(</span><span class=n>path</span><span class=o>);</span>
</pre></div><p>In the other functionalities, we can note that this new API supports symbolic links (only if the system supports them, of course). Next, the Path class has also flows factories methods like newInputStream() or newByteChannel() to easily create streams to or from the Path. That's also an advantage because the system can choose the good stream implementations to open depending on the system specifications.</p><p>An other facility offered by Path, is stream on directories. It seems that you can iterate through a directory with an iterator. That's better than File.listFiles() because not all the File are loaded in memory and that's also a bit clearer in code :</p><div class=code><pre><span class=n>DirectoryStream</span> <span class=n>directory</span> <span class=o>=</span> <span class=n>path</span><span class=o>.</span><span class=na>newDirectoryStream</span><span class=o>();</span> 

<span class=k>try</span> <span class=o>{</span>
    <span class=k>for</span> <span class=o>(</span><span class=n>Path</span> <span class=n>p</span> <span class=o>:</span> <span class=n>directory</span><span class=o>)</span> <span class=o>{</span>
        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>p</span><span class=o>);</span>
    <span class=o>}</span>
<span class=o>}</span> <span class=k>finally</span> <span class=o>{</span>
    <span class=n>directory</span><span class=o>.</span><span class=na>close</span><span class=o>();</span>
<span class=o>}</span>
</pre></div><p>And last, but not least, you can now watch for modifications in a directory with WatchService :</p><div class=code><pre><span class=n>WatchService</span> <span class=n>watcher</span> <span class=o>=</span> <span class=n>path</span><span class=o>.</span><span class=na>getFileSystem</span><span class=o>().</span><span class=na>newWatchService</span><span class=o>();</span> 

<span class=n>path</span><span class=o>.</span><span class=na>register</span><span class=o>(</span><span class=n>watcher</span><span class=o>,</span>
      <span class=n>StandardWatchEventKind</span><span class=o>.</span><span class=na>ENTRY_CREATE</span><span class=o>,</span>
      <span class=n>StandardWatchEventKind</span><span class=o>.</span><span class=na>ENTRY_MODIFY</span><span class=o>,</span>
      <span class=n>StandardWatchEventKind</span><span class=o>.</span><span class=na>ENTRY_DELETE</span><span class=o>);</span> 

<span class=k>while</span> <span class=o>(</span><span class=kc>true</span><span class=o>)</span> <span class=o>{</span>
    <span class=n>WatchKey</span> <span class=n>watchKey</span> <span class=o>=</span> <span class=n>watcher</span><span class=o>.</span><span class=na>take</span><span class=o>();</span> 

    <span class=k>for</span> <span class=o>(</span><span class=n>WatchEvent</span> <span class=n>event</span> <span class=o>:</span> <span class=n>watchKey</span> <span class=o>.</span><span class=na>pollEvents</span><span class=o>())</span> <span class=o>{</span>
        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>event</span><span class=o>.</span><span class=na>kind</span><span class=o>()</span> <span class=o>+</span> <span class=s>" : "</span> <span class=o>+</span> <span class=n>event</span><span class=o>.</span><span class=na>context</span><span class=o>());</span>
    <span class=o>}</span> 

    <span class=n>watchKey</span> <span class=o>.</span><span class=na>reset</span><span class=o>();</span>
<span class=o>}</span>
</pre></div><p>That will use the services offered by the operating system (Notification, inotify, FSEvents). This is really easier than writing native code to do that, isn't it ?</p><p>Here we are. We've covered the main functionalities of the new Path API in Java 7.</p><p>I hope you find this article interesting and that helped you discovering the new features of Java 7.</p></div> </div> </div> <ul class=pager> <li class=previous> <a href=4-reasons-not-using-osmorc-anymore.html rel=prev>← Previous post</a> </li> <li class=next> <a href=../04/java-7-the-new-java-util-objects-class.html rel=next>Next post →</a> </li> </ul> <div id=disqus_thread></div> <script>
        var disqus_shortname ="blogwichtounet",
            disqus_url="http://wichtounet.github.io/posts/2010/03/nio-2-path-api-java-7.html",
        disqus_title="NIO.2 : The new Path API in Java 7",
        disqus_identifier="cache/posts/2010/03/nio-2-path-api-java-7.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script> <noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript rel=nofollow>comments powered by Disqus.</a></noscript> <a href=http://disqus.com class=dsq-brlink rel=nofollow>Comments powered by <span class=logo-disqus>Disqus</span></a> </article> </div> </div> </div></div><footer> Contents © 2014 <a href=mailto:baptistewicht@gmail.com>Baptiste Wicht</a> - Powered by <a href=http://getnikola.com rel=nofollow>Nikola</a><a rel=license href=http://creativecommons.org/licenses/by/4.0/><img alt="Creative Commons License" style=padding-left:5px;border-width:0 src=../../../assets/img/cc.png></a> <ul class=footer_inline_ul> <li> <a href=nio-2-path-api-java-7.wp id=sourcelink>Source</a> </li> </ul></footer> <script src=../../../assets/js/all-nocdn.js type=text/javascript></script><script type=text/javascript src=https://apis.google.com/js/platform.js></script></body></html>