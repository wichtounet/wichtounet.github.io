<!DOCTYPE html>
<html lang=en><head><link href=favicon.ico rel=icon type=image/x-icon><meta name=viewport content="width=device-width, initial-scale=1.0"><meta charset=utf-8><meta name=viewport content="width=device-width, initial-scale=1.0"><meta name=author content="Baptiste Wicht"><title>Compute command-line arguments with Apache Commons CLI | @Blog("Baptiste Wicht")</title><link href=../../../assets/css/all-nocdn.css rel=stylesheet type=text/css><link rel=canonical href=http://wichtounet.github.io/posts/2010/10/compute-command-line-arguments-with-apache-commons-cli.html><link rel=alternate type=application/rss+xml title=RSS href=../../../rss.xml></head><body><div class=social_container> <div class=social_container_gplus> <a target=_blank title="Share on Google+" href="https://plusone.google.com/_/+1/confirm?hl=en&amp;url=http://wichtounet.github.io/posts/2010/10/compute-command-line-arguments-with-apache-commons-cli.html"><img src=../../../assets/img/google_plus.png></a> </div> <div class=social_container_facebook> <a target=_blank title="Share on Facebook" href="http://www.facebook.com/sharer/sharer.php?u=#url"><img src=../../../assets/img/facebook.png></a> </div> <div class=social_container_twitter> <a target=_blank title="Tweet on Twitter" href="http://twitter.com/home?status=#url"><img src=../../../assets/img/twitter.svg></a> </div></div><nav class="navbar navbar-inverse navbar-fixed-top" role=navigation> <div class=container-fluid> <div class=navbar-header> <button type=button class=navbar-toggle data-toggle=collapse data-target=.navbar-ex1-collapse> <span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span> </button> <a class=navbar-brand href=http://wichtounet.github.io/>@Blog("Baptiste Wicht")</a> </div> <div class="collapse navbar-collapse navbar-ex1-collapse"> <ul class="nav navbar-nav"> <li><a href=../../../stories/about.html>About</a> </li><li><a href=../../../stories/publications.html>Publications</a> </li><li><a href=../../../stories/donate.html>Donate</a> </li><li><a href=../../../stories/contact.html>Contact</a> </li><li><a href=../../../stories/faq.html>FAQ</a> </li><li><a href=../../../stories/legal.html>Legal</a> </li><li><a href=../../../categories/index.html>Tags</a> </li><li><a href=../../../archive.html>Archives</a> </li><li><a href=http://feeds.feedburner.com/BaptisteWicht>RSS</a> </li></ul> <span class="navbar-form pull-left"> <form action=../../../stories/search.html> <input type=text name=q id=tipue_search_input> </form> </span> <ul class="nav navbar-nav navbar-right"> <li> <a target=_blank title="Follow @wichtounet on Twitter" href=https://twitter.com/wichtounewichtounet> <img src=../../../assets/img/twitter.svg alt="Follow @wichtounet on Twitter"> </a> </li> <li> <a target=_blank title="Follow +BaptisteWicht on Google+" href=https://plus.google.com/+BaptisteWicht> <img src=../../../assets/img/google_plus.svg alt="Follow +BaptisteWicht on Google+"> </a> </li> </ul> </div> </div></nav><div class=body-container> <div class=left-sidebar> <div class=left-sidebar-widget> <div class=left-sidebar-widget-content> <div class=g-person data-width=275 data-href=//plus.google.com/u/0/103113673902796202116 data-theme=dark data-layout=landscape data-rel=author></div> </div> </div> <div class=left-sidebar-widget> <h3>Related posts</h3> <div class=left-sidebar-widget-content> <ol><li><a href=../../2012/07/manage-command-line-boost-program-options.html>Manage command-line options with Boost Program Options</a></li><li><a href=../04/java-7-the-new-java-util-objects-class.html>Java 7 : The new java.util.Objects class</a></li><li><a href=../02/java-keywords.html>The reserved keywords of the Java Language</a></li><li><a href=../../2012/01/boost-enable_if-handle-ambiguous-function-overload-void.html>Use Boost enable_if to handle ambiguous function overload return types</a></li><li><a href=../../2012/02/eddic-0-8-64bit-generation.html>EDDIC 0.8 : 64bit generation</a></li></ol> </div> </div> <div class=left-sidebar-widget> <h3>Recent comments</h3> <div class=left-sidebar-widget-content> <div id=recentcomments class=dsq-widget> <script type=text/javascript src="http://blogwichtounet.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=0&amp;avatar_size=28&amp;excerpt_length=50"></script> </div> </div> </div> <div class=left-sidebar-widget> <h3>Popular posts</h3> <div class=left-sidebar-widget-content> <div id=popularthreads class=dsq-widget> <script type=text/javascript src="http://blogwichtounet.disqus.com/popular_threads_widget.js?num_items=5&amp;days_back=90"></script> </div> </div> </div> <div class=left-sidebar-widget> <h3>Blogroll</h3> <div class=left-sidebar-widget-content> <ul> <li><a target=_blank href=http://www.asjava.com/>AsJava.com : Java Tutorial</a></li> <li><a target=_blank href=http://www.mkyong.com/>Mkyong : Java Tutorials</a></li> </ul> </div> </div> </div> <div class=container> <div class=body-content> <div class=row> <article class="postbox post-text"> <div class=h-entry itemscope=itemscope itemtype=http://schema.org/Article> <h1 class=p-name itemprop="headline name">Compute command-line arguments with Apache Commons CLI</h1> <hr> <small> Posted: <time class="published dt-published" datetime=2010-10-14T07:22:45+02:00 itemprop=datePublished>2010-10-14 07:22</time>   |   More posts about <span itemprop=keywords> <a class="tag p-category" href=../../../categories/apache.html><span class="badge badge-info">Apache</span></a> <a class="tag p-category" href=../../../categories/java.html><span class="badge badge-info">Java</span></a> <a class="tag p-category" href=../../../categories/libraries.html><span class="badge badge-info">Libraries</span></a> </span> </small> <hr> <div class=e-content itemprop="articleBody text"> <div><p>For a project at school, I needed to refactor an old code parsing almost 30 command line arguments. I needed to add some more arguments and change some old args, but the old code was not maintainable at all. So I decided to use a library to make the parsing. of the args. </p><p>I chose Apache Commons CLI. This is a really simple library to make that parsing. It's not perfect, but it makes the work I needed and is powerful to do that job. </p><p>With this API, you have to declare an Options instance. This class is used to describe the command line arguments of the program. Options constructor don't take any arguments. </p><div class=code><pre><span class=n>Options</span> <span class=n>options</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Options</span><span class=o>();</span>
</pre></div><p>Then you have to use the addOption methods to add some arguments to the application. There is three versions of the methods : </p><ul> <li>addOption(Option opt) : Add an option of the class Option. </li> <li>addOption(String opt, boolean hasArg, String description) : Add a new option to the arguments. This option has only a short name. </li> <li>addOption(String opt, String longOpt, boolean hasArg, String description) : Add a new option to the arguments. The option has a short name and a long name. </li></ul><p>We need some explanations here. The short opt is used to define an arg with a simple dash (-shortopt) and the long opt is defined with double dash (--longopt). The hasArg indicate if the parameter accepts an argument. The description is, like its name indicates, the description of the option. It's used to print the help of the program.</p><p>Using Option instances you can configure all the properties of an option using the setters and the constructor. Here is all the setters that can be used to configure the option : </p><ul> <li> void setArgName(String argName) : The name of the args</li> <li> void setArgs(int num) : The number of args the option takes</li> <li>void setDescription(String description) : The description of the option</li> <li> void setLongOpt(String longOpt) : The long option name</li> <li> void setOptionalArg(boolean optionalArg) : Indicate if the argument of this option is optional</li> <li> void setRequired(boolean required) : Indicate if the option is required or not</li> <li>void setType(Object type) : Set the type of the Option. Here are the supported type : File.class, Number.class, Class.class, Object.class, Url.class</li> <li> void setValueSeparator(char sep) : Set the value separator, it's used to make a system like the property of Java like -Dmaven.test.skip=true, the separator is = </li></ul><p>There is also an other way to create Option instance, using the OptionBuilder class. It's a little weird because all the methods are static and the method returns a reference to the builder. And then you make a call to the builder instance using the static method. The method are equivalent with the methods of the Option class with different names (withXXX, hasXXX, ...). When you have configured the option, you have to call one of the create methods to create the instance and reset the OptionBuilder. </p><p>Once you filled the Options instance with the arguments of the program, you can use it. You have to use a CommandLineParser to parse the Options. There is three implementation of this interface : </p><ul> <li><strong>BasicParser</strong> : A very simple parser</li> <li><strong>PosixParser</strong> : A parser to parse short options</li> <li><strong>GnuParser </strong>: A parser to parse both long and short options</li></ul><p>A simple example using the GnuParser : </p><div class=code><pre><span class=n>CommandLineParser</span> <span class=n>parser</span> <span class=o>=</span> <span class=k>new</span> <span class=n>GnuParser</span><span class=o>();</span>

<span class=n>CommandLine</span> <span class=n>cmd</span> <span class=o>=</span> <span class=n>parser</span><span class=o>.</span><span class=na>parse</span><span class=o>(</span><span class=n>options</span><span class=o>,</span> <span class=n>args</span><span class=o>);</span>
</pre></div><p>You receive a CommandLine object representing all the arguments. The parse() method can throw a ParseException if the given arguments are not valid. With that object, you can get the options that have been passed to the application. For that, you can use the given methods : </p><p></p><ul> <li>Object getOptionObject : Return the option value parsed to the specified type</li> <li> Properties getOptionProperties(String opt) </li> <li> String getOptionValue : Return the value of the option</li> <li> String[] getOptionValues : Return the values of the option</li> <li> Object getParsedOptionValue(String opt) : Return the option value parsed to the specified type</li> <li> boolean hasOption : Indicate if the option has been specified or not</li> <li> List getArgList() : Return all the args that are not specified args</li> <li> String[] getArgs() : Return all the args that are not specified args</li></ul><p>With this API, you can also generate the help of the program : </p><div class=code><pre><span class=n>HelpFormatter</span> <span class=n>formatter</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HelpFormatter</span><span class=o>();</span>

<span class=n>formatter</span><span class=o>.</span><span class=na>printHelp</span><span class=o>(</span> <span class=s>"program"</span><span class=o>,</span> <span class=n>options</span><span class=o>);</span>
</pre></div><p>With that, you display the list of arguments taken by the program. </p><p>With that example, we've seen the main features of this library. </p><p>For more information, you consult the <a target=_blank href=http://commons.apache.org/cli/index.html>Apache Commons CLI</a> website.</p></div> </div> </div> <ul class=pager> <li class=previous> <a href=../09/the-pragmatic-programmer-book-review.html rel=prev>← Previous post</a> </li> <li class=next> <a href=jtheque-core-2-1-0-released.html rel=next>Next post →</a> </li> </ul> <div id=disqus_thread></div> <script>
        var disqus_shortname ="blogwichtounet",
            disqus_url="http://wichtounet.github.io/posts/2010/10/compute-command-line-arguments-with-apache-commons-cli.html",
        disqus_title="Compute command-line arguments with Apache Commons CLI",
        disqus_identifier="cache/posts/2010/10/compute-command-line-arguments-with-apache-commons-cli.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script> <noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript rel=nofollow>comments powered by Disqus.</a></noscript> <a href=http://disqus.com class=dsq-brlink rel=nofollow>Comments powered by <span class=logo-disqus>Disqus</span></a> </article> </div> </div> </div></div><footer> Contents © 2014 <a href=mailto:baptistewicht@gmail.com>Baptiste Wicht</a> - Powered by <a href=http://getnikola.com rel=nofollow>Nikola</a><a rel=license href=http://creativecommons.org/licenses/by/4.0/><img alt="Creative Commons License" style=padding-left:5px;border-width:0 src=../../../assets/img/cc.png></a> <ul class=footer_inline_ul> <li> <a href=compute-command-line-arguments-with-apache-commons-cli.wp id=sourcelink>Source</a> </li> </ul></footer> <script src=../../../assets/js/all-nocdn.js type=text/javascript></script><script type=text/javascript src=https://apis.google.com/js/platform.js></script></body></html>