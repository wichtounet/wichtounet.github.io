<!DOCTYPE html><html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Baptiste Wicht">
    <title>Introduction to JR programming language | @Blog("Baptiste Wicht")</title>
    
            <link href="../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
      <link rel="canonical" href="http://wichtounet.github.io/posts/2010/01/jr-introduction.html">
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js" type="text/javascript"></script>
    <![endif]-->
            <link rel="alternate" type="application/rss+xml" title="RSS" href="../../../rss.xml">

    





    
<link rel="stylesheet" type="text/css" href="../../../assets/css/tipuesearch.css">
</head><body><div id="tipue_search_content" style="margin-left: auto; margin-right: auto; padding: 20px;"></div>




<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container-fluid"><!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://wichtounet.github.io/">@Blog("Baptiste Wicht")</a>
        </div><!-- /.navbar-header -->
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                
                <li><a href="../../../stories/about.html">About</a>
                </li><li><a href="../../../stories/publications.html">Publications</a>
                </li><li><a href="../../../stories/donate.html">Donate</a>
                </li><li><a href="../../../stories/faq.html">FAQ</a>
                </li><li><a href="../../../stories/legal.html">Legal</a>
                </li><li><a href="../../../archive.html">Archives</a>
                </li><li><a href="../../../categories/index.html">Tags</a>
                </li><li><a href="../../../rss.xml">RSS</a>

            </li></ul>
                
<span class="navbar-form pull-left">
<input type="text" id="tipue_search_input">
</span>

            <ul class="nav navbar-nav navbar-right">
                
                
            </ul>
        </div><!-- /.navbar-collapse -->
    </div><!-- /.container-fluid -->
</nav>

<!-- End of Menubar -->

<div class="body-container">

    <!-- Sidebar -->

    <div class="left-sidebar">
        <div class="left-sidebar-widget">
            <h3>Something, something</h3>
            <div class="left-sidebar-widget-content">
                ...dark side...
            </div>
        </div>
        
        <div class="left-sidebar-widget">
            <h3>Blogroll</h3>
            <div class="left-sidebar-widget-content">
                <ul>
                    <li><a target="_blank" href="http://www.asjava.com/">AsJava.com : Java Tutorial</a></li>
                    <li><a target="_blank" href="http://www.mkyong.com/">Mkyong : Java Tutorials</a></li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Content -->

    <div class="container">
        <div class="body-content">
            <!--Body content-->
            <div class="row">
                
    <article class="postbox post-text">
    <div class="h-entry" itemscope="itemscope" itemtype="http://schema.org/Article">
    
    <h1 class="p-name" itemprop="headline name">Introduction to JR programming language</h1>

    <hr>
    <small>
        Posted: <time class="published dt-published" datetime="2010-01-30T13:01:49+00:00" itemprop="datePublished">2010-01-30 13:01</time>
        

        
          |  
        More posts about 
    <span itemprop="keywords">
        <a class="tag p-category" href="../../../categories/java.html"><span class="badge badge-info">Java</span></a>
        <a class="tag p-category" href="../../../categories/java.html"><span class="badge badge-info">Java</span></a>
        <a class="tag p-category" href="../../../categories/jr.html"><span class="badge badge-info">JR</span></a>
    </span>


    </small>
    <hr>
    <div class="e-content" itemprop="articleBody text">
    <div><p></p><h4>1. Language overview</h4>
JR is a programming language especially created to solve concurrent programming problems. This language is an overview of Java who add to this last the main paradigms of concurrent programming. Moreover JR make easier the concepts still implemented in Java like process or semaphores. There is also several extensions for JR to add more functionalities like monitors and Conditional Critical Region (CCR). JR is the implementation of the SR language for Java.
<p>JR makes nothing else than add a layer over Java. Once we use the JR compiler, the JR source files are transformed in Java files and are executed by the virtual machine like any other Java class.</p>
<p>JR is often used as a school support to learn concurrent programming.</p>
<p>In this article, we will see the bases of the programmation with JR.</p>
<p>The presented version is the one of June 2009, the version 2.00602 who are based on Java 6.0.</p>
<p>This article need that you've installed the JR environment on your system. An article is available here for the installation under Windows.</p>
<p>In this article, we will especially focus on the apports of the JR language for the concurrent programming. We will not see the the integrality of the language. JR has other benefits than make easier concurrent programming, but we will not see that in this article. Moreover, all the aspects of concurrent programming in JR will not be treated here.</p>
<!--more-->

<h4>2. Hello World</h4>

<p>Like all other languages, we must start with a simple Hello World. Thus we'll create a file Hello.jr. Nothing special here, it's pure Java :</p>
<p>[java]public class Hello {
    public static void main(String[] args){
        System.out.println("Hello World");
    }
}[/java]</p>
<p>Then we can compile it :</p>
<pre>jrc Hello.jr</pre>

<p>This will create a jrGen folder containing Java files. The result of a JR compilation is always a set of Java files corresponding to the translation of the JR files.</p>
<p>To launch your JR program, use the jr command followed by the name of the main class (class containing the main method) :</p>
<pre>jr Hello</pre>

<p>That will display :</p>
<pre>Hello World</pre>

<p>The jr command will also launch the compilation of Java files. This compilation will be done every time. If you want to make only the launch of compiled files, you can use the jrrun command.</p>
<p>Like said in introduction, the JR language extends the Java language. So, you can code in Java with JR. Thus an Hello World is only Java.</p>
<h4>3. Processes</h4>

<p>The first thing to see is the declaration of processes. This is done in an easier way than in Java. No need to instanciate some objects, this is done in a declarative way and JR make the rest.</p>
<p>For the declaration of process, JR introduce a new keyword process who enable to declare a process. Here is the simplest declaration of a process :</p>
<p>[java]process Hello {
    System.out.println("Processus");
[/java]</p>
<p>Like you can see it, it's easier than in Java. And better, no need to launch it, you just have to instanciate the class. A process can also be declared static. This times, it will not be launched at the instanciation of the class but at the resolution of the class by the virtual machine. By example, we can rewrite an HelloWorld in that way :</p>
<p>[java]public class HelloProcess {
    static process Hello {
        System.out.println("Hello World");
    }</p>
<div class="code"><pre><span class="n">public</span> <span class="k">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="p">[]</span> <span class="n">args</span><span class="p">){}</span>
</pre></div>


<p>[/java]</p>
<p>who display exactly the same thing as the first version of the Hello World. At the difference that our display is made from a thread.</p>
<p>Moreover, JR enable to declare a big set of threads in a declaration with the following syntax :</p>
<p>[java]static process Hello((int id = 0; id &amp;lt; n; id++)){}[/java]</p>
<p>This will declare n threads. The syntax is the same as the for loop. Let's declare 25 threads Hello World :</p>
<p>[java]public class HelloProcess {
    static process Hello((int id = 0; id &amp;lt; 25; id++)){
        System.out.println("Hello World from thread " + id);
    }</p>
<div class="code"><pre><span class="n">public</span> <span class="k">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="p">[]</span> <span class="n">args</span><span class="p">){}[</span><span class="o">/</span><span class="n">java</span><span class="p">]</span>
</pre></div>


<p>When we launch that, we could have the following result :</p>
<pre>Hello World from thread 2

Hello World from thread 24

Hello World from thread 11

Hello World from thread 22

Hello World from thread 0

Hello World from thread 4

Hello World from thread 6

Hello World from thread 8

Hello World from thread 10

Hello World from thread 12

Hello World from thread 14

Hello World from thread 16

Hello World from thread 18

Hello World from thread 20

Hello World from thread 23

Hello World from thread 21

Hello World from thread 19

Hello World from thread 17

Hello World from thread 15

Hello World from thread 13

Hello World from thread 9

Hello World from thread 7

Hello World from thread 5

Hello World from thread 3

Hello World from thread 1</pre>

<p>Like you can see, if you launch several times the program, the display is not same and the message commes in an order completely different order at each launch. Nothing can guarantee the order of the threads launches and still less the order of the execution of the instructions and you must not count on it.</p>
<p>It's the basis of the concurrent programming. You cannot predict the order of the instructions in the different threads.</p>
<!--nextpage-->

<h4>4. Quiescence action</h4>

<p>JR introduce a new concept, really powerful, the quiescence action. It's an action who's executed when the system is quiescent. It seems that all the process are finished or remains in deadlocks.</p>
<p>Before that, we use to introduce the concept of operations. In our case, an operation is a simple method declared with the op keyword. But in JR an operation is more than a method and could be invoked in different ways and permit other things that methods, but this is beyond the scope of this article.</p>
<p>Here is a declaration of a simple operation.</p>
<p>[java]public static op void end(){
    System.out.println("End")[/java]</p>
<p>So, this is a simple method with the op prefix. You can invoke it like any other method. But you can also declare it like the action to execute when the system is in quiescence state. If we take our example of the 25 hello world and if we define the quiescence action here is what we get :</p>
<p>[java]import edu.ucdavis.jr.JR;</p>
<p>public class QuiescenceProcess {
    static process Hello((int id = 0; id &amp;lt; 25; id++)){
        System.out.println("Hello World from thread " + id);
    }</p>
<div class="code"><pre><span class="n">public</span> <span class="k">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="p">[]</span> <span class="n">args</span><span class="p">){</span>
    <span class="n">try</span> <span class="p">{</span>
        <span class="n">JR</span><span class="p">.</span><span class="n">registerQuiescenceAction</span><span class="p">(</span><span class="n">end</span><span class="p">);</span>
    <span class="p">}</span> <span class="n">catch</span> <span class="p">(</span><span class="n">edu</span><span class="p">.</span><span class="n">ucdavis</span><span class="p">.</span><span class="n">jr</span><span class="p">.</span><span class="n">QuiescenceRegistrationException</span> <span class="n">e</span><span class="p">){</span>
        <span class="n">e</span><span class="p">.</span><span class="n">printStackTrace</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">public</span> <span class="k">static</span> <span class="n">op</span> <span class="kt">void</span> <span class="nf">end</span><span class="p">(){</span>
    <span class="n">System</span><span class="p">.</span><span class="n">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"End"</span><span class="p">);</span>
</pre></div>


<p>[/java]</p>
<p>We use the registerQuiescenceAction(op) method of the JR class. This class provide some utility methods for the JR programs</p>
<p>And a launch, we see something like that :</p>
<pre>Hello World from thread 0

Hello World from thread 22

Hello World from thread 23

Hello World from thread 21

Hello World from thread 24

Hello World from thread 20

Hello World from thread 19

Hello World from thread 18

Hello World from thread 17

Hello World from thread 16

Hello World from thread 15

Hello World from thread 14

Hello World from thread 13

Hello World from thread 12

Hello World from thread 11

Hello World from thread 10

Hello World from thread 9

Hello World from thread 8

Hello World from thread 7

Hello World from thread 6

Hello World from thread 5

Hello World from thread 4

Hello World from thread 3

Hello World from thread 2

Hello World from thread 1

End</pre>

<p>This is really useful to execute an action after the end of the system and verify something on the system. By example, display a message in the case of a deadlock or display debug informations on the executed operations.</p>
<!--nextpage-->

<h4>5. Semaphores</h4>

<p>We will now see how to use one of the basic concept of concurrent programming : the semaphores. The semaphores are a really simple concept but very powerful. A semaphore represent a certain integer valur representing the number of threads that can go in a certain portion of code, call it "s". A semaphore has two actions :</p>
<ul>
    <li><strong>P</strong> : make the thread wait while s equals 0 and then decrement s.</li>
    <li><strong>V</strong> : increment s.</li>
</ul>

<p>This two operations are atomic. We use the semaphores to protect a critical section who need to be executed in an atomic way. We can also use semaphores to restrain the number of threads that can execute some instructions in parralel.</p>
<p>The declaration and the use of semaphores is really easy. Here is how you can declare a semaphore with a initial value of 1 :</p>
<p>[java]sem mutex = 1;[/java]</p>
<p>Then, the operations P et V are extremely simple to use :</p>
<p>[java]P(mutex);</p>
<p>//Critical section</p>
<p>V(mutex);[/java]</p>
<p>The semaphores are principally used to solve the critical section problem. Imagine a simple example, but who show exactly the problem that the semaphore can solve :</p>
<p>[java]private static int value = 0;</p>
<p>static process Calculator((int id = 0; id &lt; 50; id++)){
    for(int i = 0; i &lt; 5; i++){
        value = value + 2;
    }
}[/java]</p>
<p>Because this code launch 50 threads who add each one 5 times 2 to value, we could think that value must be 500 at the end of the execution, isnt'it ?</p>
<p>But nothing guarantee that result. This is known as the interleaving in concurrent programming. This is because the + 2 operation is in reality 3 operations :</p>
<ul>
    <li>read the value of value</li>
    <li>add 2 to the read value</li>
    <li>set the new value to value</li>
</ul>

<p>A thread can be put in wait just after 1 and do the incrementation on the old value but other threads have still made the incrementation, but it has the old value when it mades the +2 and write and false value to value. To prove that to you, execute the following code several times :</p>
<p>[java]import edu.ucdavis.jr.JR;</p>
<p>public class SemaphoreProcess {
    private static int value = 0;</p>
<div class="code"><pre><span class="k">static</span> <span class="n">process</span> <span class="n">Calculator</span><span class="p">((</span><span class="kt">int</span> <span class="n">id</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">id</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span> <span class="mi">50</span><span class="p">;</span> <span class="n">id</span><span class="o">++</span><span class="p">)){</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span> <span class="mi">5</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">public</span> <span class="k">static</span> <span class="kt">void</span> <span class="n">main</span><span class="p">(</span><span class="n">String</span><span class="p">[]</span> <span class="n">args</span><span class="p">){</span>
    <span class="n">try</span> <span class="p">{</span>
        <span class="n">JR</span><span class="p">.</span><span class="n">registerQuiescenceAction</span><span class="p">(</span><span class="n">end</span><span class="p">);</span>
    <span class="p">}</span> <span class="n">catch</span> <span class="p">(</span><span class="n">edu</span><span class="p">.</span><span class="n">ucdavis</span><span class="p">.</span><span class="n">jr</span><span class="p">.</span><span class="n">QuiescenceRegistrationException</span> <span class="n">e</span><span class="p">){</span>
        <span class="n">e</span><span class="p">.</span><span class="n">printStackTrace</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">public</span> <span class="k">static</span> <span class="n">op</span> <span class="kt">void</span> <span class="n">end</span><span class="p">(){</span>
        <span class="n">System</span><span class="p">.</span><span class="n">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>


<p>}[/java]</p>
<p>On my computer, i've the following results.</p>
<pre>498

500

500

500

496</pre>

<p>And if we use greater values, it's even worse. By example, with 100 threads and 100 iterations :</p>
<pre>20000

19560

19912

19758

20000</pre>

<p>But this problem can be solved with semaphores :</p>
<p>[java]private static sem mutex = 1;</p>
<p>private static int value = 0;</p>
<p>static process Calculator((int id = 0; id &amp;lt; 50; id++)){
    for(int i = 0; i &amp;lt; 5; i++){
        P(mutex);
        value = value + 2;
        V(mutex)
        }
}[/java]</p>
<p>With that, we have the guarantee that only one thread can do the incrementation at a time and make it atomic. Then all the executions will finish with a value of 500. But that of course impact the performances because instead of x threads who made operations in a parralel way, we've now only one thread at a time. The example with 100 threads and 100 iterations is really slow. We can improve performance using the mutex semaphore around the loop. But the performances are to be considered differently in each example. So we must use wisely the synchronization methods of threads.</p>
<!--nextpage-->

<h4>6. Conclusion</h4>

<p>So, we've now discover the main concepts of the JR programming language. Like you have see in this article, this programming language enable to make easier the use of concurrent programming concepts.</p>
<p>I hope that this article has been useful to you to discover the JR Programming Language, and why not, to learn and use this language.</p></div>
    </div>
    </div>
    
        <ul class="pager">
            <li class="previous">
                <a href="install-jr-windows.html" rel="prev">← Previous post</a>
            </li>
            <li class="next">
                <a href="../02/logging-with-slf4j.html" rel="next">Next post →</a>
            </li>
        </ul>

        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="blogwichtounet",
            disqus_url="http://wichtounet.github.io/posts/2010/01/jr-introduction.html",
        disqus_title="Introduction to JR programming language",
        disqus_identifier="cache/posts/2010/01/jr-introduction.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


    

    </article>

            </div>
            <!--End of body content-->
        </div>
    </div>
</div>

<!-- Footer -->

<footer>
    Contents © 2014         <a href="mailto:baptistewicht@gmail.com">Baptiste Wicht</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by/4.0/88x31.png"></a>
        <ul class="footer_inline_ul">
            
    <li>
    <a href="jr-introduction.wp" id="sourcelink">Source</a>
    </li>

        </ul>
</footer>


            <script src="../../../assets/js/all-nocdn.js" type="text/javascript"></script>


    
<!-- AddThis Smart Layers BEGIN -->
<!-- Go to http://www.addthis.com/get/smart-layers to customize -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5327566b264df4ee"></script>
<script type="text/javascript">
  addthis.layers({
    'theme' : 'dark',
    'share' : {
      'position' : 'right',
      'numPreferredServices' : 5
    }, 
    'follow' : {
      'services' : [
        {'service': 'twitter', 'id': 'wichtounet'},
        {'service': 'google_follow', 'id': '+BaptisteWicht'}
      ]
    }   
  });
</script>
<!-- AddThis Smart Layers END -->


    <script type="text/javascript">jQuery("a.image-reference").colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script>
    

<script type="text/javascript" src="../../../assets/js/tipuesearch_set.js"></script>
<script type="text/javascript" src="../../../assets/js/tipuesearch.js"></script>
<script type="text/javascript">
$(document).ready(function() {
  $('#tipue_search_input').tipuesearch({
      'mode': 'json',
      'contentLocation': '/assets/js/tipuesearch_content.json',
      'showUrl': false
  });
});
</script>


</body></html>