<!DOCTYPE html>
<html lang=en><head><link href=favicon.ico rel=icon type=image/x-icon><meta name=viewport content="width=device-width, initial-scale=1.0"><meta charset=utf-8><meta name=viewport content="width=device-width, initial-scale=1.0"><meta name=author content="Baptiste Wicht"><title>Java 7 : Add "public defender methods" to Java interfaces | @Blog("Baptiste Wicht")</title><link href=../../../assets/css/all-nocdn.css rel=stylesheet type=text/css><link rel=canonical href=http://wichtounet.github.io/posts/2010/05/java-7-add-public-defender-methods-to-java-interfaces.html><link rel=alternate type=application/rss+xml title=RSS href=../../../rss.xml><script type=text/javascript>
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-2175227-7']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script></head><body><div class=social_container> <div class=social_container_gplus> <a target=_blank title="Share on Google+" href="https://plusone.google.com/_/+1/confirm?hl=en&amp;url=http://wichtounet.github.io/posts/2010/05/java-7-add-public-defender-methods-to-java-interfaces.html"><img src=../../../assets/img/google_plus.png></a> </div> <div class=social_container_facebook> <a target=_blank title="Share on Facebook" href="http://www.facebook.com/sharer/sharer.php?u=#url"><img src=../../../assets/img/facebook.png></a> </div> <div class=social_container_twitter> <a target=_blank title="Tweet on Twitter" href="http://twitter.com/home?status=#url"><img src=../../../assets/img/twitter.svg></a> </div></div><nav class="navbar navbar-inverse navbar-fixed-top" role=navigation> <div class=container-fluid> <div class=navbar-header> <button type=button class=navbar-toggle data-toggle=collapse data-target=.navbar-ex1-collapse> <span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span> </button> <a class=navbar-brand href=http://wichtounet.github.io/>@Blog("Baptiste Wicht")</a> </div> <div class="collapse navbar-collapse navbar-ex1-collapse"> <ul class="nav navbar-nav"> <li><a href=../../../stories/about.html>About</a> </li><li><a href=../../../stories/publications.html>Publications</a> </li><li><a href=../../../stories/donate.html>Donate</a> </li><li><a href=../../../stories/contact.html>Contact</a> </li><li><a href=../../../stories/faq.html>FAQ</a> </li><li><a href=../../../stories/legal.html>Legal</a> </li><li><a href=../../../categories/index.html>Tags</a> </li><li><a href=../../../archive.html>Archives</a> </li><li><a href=http://feeds.feedburner.com/BaptisteWicht>RSS</a> </li></ul> <span class="navbar-form pull-left"> <form action=../../../stories/search.html> <input type=text name=q id=tipue_search_input> </form> </span> <ul class="nav navbar-nav navbar-right"> <li> <a target=_blank title="Follow @wichtounet on Twitter" href=https://twitter.com/wichtounewichtounet> <img src=../../../assets/img/twitter.svg alt="Follow @wichtounet on Twitter"> </a> </li> <li> <a target=_blank title="Follow +BaptisteWicht on Google+" href=https://plus.google.com/+BaptisteWicht> <img src=../../../assets/img/google_plus.svg alt="Follow +BaptisteWicht on Google+"> </a> </li> </ul> </div> </div></nav><div class=body-container> <div class=left-sidebar> <div class=left-sidebar-widget> <div class=left-sidebar-widget-content> <div class=g-person data-width=275 data-href=//plus.google.com/u/0/103113673902796202116 data-theme=dark data-layout=landscape data-rel=author></div> </div> </div> <div class=left-sidebar-widget> <h3>Related posts</h3> <div class=left-sidebar-widget-content> <ol><li><a href=../07/state-of-the-lambda.html>State of the Lambda</a></li><li><a href=../04/java-7-more-dynamics.html>Java 7 : More dynamics</a></li><li><a href=oracle-pushes-a-first-version-of-closures.html>Java 7 : Oracle pushes a first version of closures</a></li><li><a href=../04/java-7-updates-project-coin.html>Java 7 : Languages updates from Project Coin</a></li><li><a href=../../2011/07/java-7-has-been-released.html>Java 7 has been released!</a></li></ol> </div> </div> <div class=left-sidebar-widget> <h3>Recent comments</h3> <div class=left-sidebar-widget-content> <div id=recentcomments class=dsq-widget> <script type=text/javascript src="http://blogwichtounet.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=0&amp;avatar_size=28&amp;excerpt_length=50"></script> </div> </div> </div> <div class=left-sidebar-widget> <h3>Popular posts</h3> <div class=left-sidebar-widget-content> <div id=popularthreads class=dsq-widget> <script type=text/javascript src="http://blogwichtounet.disqus.com/popular_threads_widget.js?num_items=5&amp;days_back=90"></script> </div> </div> </div> <div class=left-sidebar-widget> <h3>Blogroll</h3> <div class=left-sidebar-widget-content> <ul> <li><a target=_blank href=http://www.asjava.com/>AsJava.com : Java Tutorial</a></li> <li><a target=_blank href=http://www.mkyong.com/>Mkyong : Java Tutorials</a></li> </ul> </div> </div> </div> <div class=container> <div class=body-content> <div class=row> <article class="postbox post-text"> <div class=h-entry itemscope=itemscope itemtype=http://schema.org/Article> <h1 class=p-name itemprop="headline name">Java 7 : Add "public defender methods" to Java interfaces</h1> <hr> <small> Posted: <time class="published dt-published" datetime=2010-05-31T06:29:54+02:00 itemprop=datePublished>2010-05-31 06:29</time>   |   More posts about <span itemprop=keywords> <a class="tag p-category" href=../../../categories/closures.html><span class="badge badge-info">Closures</span></a> <a class="tag p-category" href=../../../categories/java.html><span class="badge badge-info">Java</span></a> <a class="tag p-category" href=../../../categories/java-7.html><span class="badge badge-info">Java 7</span></a> </span> </small> <hr> <div class=e-content itemprop="articleBody text"> <div><p>At this time, we aren't sure that the closures will be included in the Java 7 release. But these doubts have generated a new project : <a href=http://cr.openjdk.java.net/~darcy/DefenderMethods.pdf target=_blank>The "public defender methods" proposal</a>.</p><p>This new proposal for Java 7 wants to improve the interfaces allowing to add new methods to existing interfaces. The classes implementing the interfaces doesn't need implements these methods. The implementation of these methods are provided using static methods. This could be called virtual extension method.</p><p>To illustrate the problem the proposal want to solve, let's take the example of reversing a List. When you have a List and you want to reverse it, you have to use the Collections.reverse() method :</p><div class=code><pre><span class=n>List</span> <span class=n>strings</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>();</span>
<span class=c1>//...</span>
<span class=n>Collections</span><span class=o>.</span><span class=na>reverse</span><span class=o>(</span><span class=n>strings</span><span class=o>);</span>
</pre></div><p>But there is some problems with that code. Because it's a static method, there is no way to override it. We could imagine data structures where the reverse must be made using special algorithms to be efficient. An other problem is that the reverse() method is not in the List interface, so must learn two classes to make a simple thing as reversing a list.</p><p>The "public defender methods" give an other way to do that extending the List interface :</p><div class=code><pre><span class=kd>public</span> <span class=kd>interface</span> <span class=nc>List</span> <span class=kd>extends</span> <span class=n>Collection</span> <span class=o>{</span>
  <span class=o>...</span>
  <span class=n>extension</span> <span class=kt>void</span> <span class=nf>reverse</span><span class=o>()</span> <span class=k>default</span> <span class=n>Collections</span><span class=o>.</span><span class=na>reverse</span><span class=o>;</span>
<span class=o>}</span>
</pre></div><p>This add a new method to the List with a default implement that use the Collections.reverse(List list) static method. The list will be passed as the first argument of the static method. So, now that you have a method reverse on the List, you can do that :</p><div class=code><pre><span class=n>List</span> <span class=n>strings</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>();</span>
<span class=c1>//...</span>
<span class=n>strings</span><span class=o>.</span><span class=na>reverse</span><span class=o>();</span>
</pre></div><p>This code is a lot better than the other, isn't it ?</p><p>You can now override the reverse method providing an implementation specific to your class. But the implementation is now optional. That solve all the problems we see earlier.</p><p>To solve multiple inheritance issue a class implementing two interfaces providing a default implementation for the same method name and signature must provide an implementation of the method.</p><p>An other objective of this proposal is to "closur-ize" the Java 7 librairies. By example, we could think of a filter() method to the List interface :</p><div class=code><pre><span class=kd>public</span> <span class=kd>interface</span> <span class=nc>List</span> <span class=kd>extends</span> <span class=n>Collection</span> <span class=o>{</span>
  <span class=o>...</span>

  <span class=n>extension</span> <span class=kt>void</span> <span class=nf>filter</span><span class=o>(</span><span class=n>Predicate</span> <span class=n>predicate</span><span class=o>)</span> <span class=k>default</span> <span class=n>Collections</span><span class=o>.</span><span class=na>filter</span><span class=o>;</span>
<span class=o>}</span>
</pre></div><p>And a predicate like that :</p><div class=code><pre><span class=kd>public</span> <span class=kd>interface</span> <span class=nc>Predicate</span> <span class=o>{</span>
   <span class=kt>boolean</span> <span class=nf>accept</span><span class=o>(</span><span class=n>E</span> <span class=n>object</span><span class=o>);</span>
<span class=o>}</span>
</pre></div><p>That type of method can take advantage of closures. We can also imagine reduce, forEach, expand, ....</p><p>At this time, this is only a proposal, so we aren't sure it'll be included in Java 7 and the syntax is not definitive.</p><p>Personally, i think this is a great improvement and that will make the closures (if we have them a day) more interesting for the Java language.</p><p>If you want more information on the implementation, you could <a href=http://cr.openjdk.java.net/~darcy/DefenderMethods.pdf target=_blank>read the proposal in PDF</a>.</p></div> </div> </div> <ul class=pager> <li class=previous> <a href=oracle-pushes-a-first-version-of-closures.html rel=prev>← Previous post</a> </li> <li class=next> <a href=../06/java-7-translucency-shaped-windows.html rel=next>Next post →</a> </li> </ul> <div id=disqus_thread></div> <script>
        var disqus_shortname ="blogwichtounet",
            disqus_url="http://wichtounet.github.io/posts/2010/05/java-7-add-public-defender-methods-to-java-interfaces.html",
        disqus_title="Java 7 : Add \"public defender methods\" to Java interfaces",
        disqus_identifier="cache/posts/2010/05/java-7-add-public-defender-methods-to-java-interfaces.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script> <noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript rel=nofollow>comments powered by Disqus.</a></noscript> <a href=http://disqus.com class=dsq-brlink rel=nofollow>Comments powered by <span class=logo-disqus>Disqus</span></a> </article> </div> </div> </div></div><footer> Contents © 2014 <a href=mailto:baptistewicht@gmail.com>Baptiste Wicht</a> - Powered by <a href=http://getnikola.com rel=nofollow>Nikola</a><a rel=license href=http://creativecommons.org/licenses/by/4.0/><img alt="Creative Commons License" style=padding-left:5px;border-width:0 src=../../../assets/img/cc.png></a> <ul class=footer_inline_ul> <li> <a href=java-7-add-public-defender-methods-to-java-interfaces.wp id=sourcelink>Source</a> </li> </ul></footer> <script src=../../../assets/js/all-nocdn.js type=text/javascript></script><script type=text/javascript src=https://apis.google.com/js/platform.js></script></body></html>