<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>JTheque : Problems when migrating to OSGi  | Blog blog("Baptiste Wicht");</title>
<link href="../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../../rss.xml">
<link rel="canonical" href="https://baptiste-wicht.com/posts/2010/04/jtheque-problems-migrating-osgi.html">
<!--[if lt IE 9]><script src="../../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Baptiste Wicht">
<link rel="prev" href="10-most-useful-google-tools.html" title="10 most useful Google Tools " type="text/html">
<link rel="next" href="java-7-updates-project-coin.html" title="Java 7 : Languages updates from Project Coin" type="text/html">
<meta property="og:site_name" content='Blog blog("Baptiste Wicht");'>
<meta property="og:title" content="JTheque : Problems when migrating to OSGi ">
<meta property="og:url" content="https://baptiste-wicht.com/posts/2010/04/jtheque-problems-migrating-osgi.html">
<meta property="og:description" content="Like you perhaps know, i'm currently migrating JTheque to OSGi. During this migration i found several problems in the JTheque architecture that made the migration impossible without changing some conc">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2010-04-18T10:57:50+02:00">
<meta property="article:tag" content="Conception">
<meta property="article:tag" content="JTheque">
<meta property="article:tag" content="OSGi">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://baptiste-wicht.com/">

                <span id="blog-title">Blog blog("Baptiste Wicht");</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../../stories/about.html">About</a>
                </li>
<li>
<a href="../../../stories/publications.html">Publications</a>
                </li>
<li>
<a href="../../../stories/projects.html">Projects</a>
                </li>
<li>
<a href="../../../categories/index.html">Tags</a>
                </li>
<li>
<a href="../../../archive.html">Archives</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<li>
    <a href="jtheque-problems-migrating-osgi.wp" id="sourcelink">Source</a>
    </li>

                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">JTheque : Problems when migrating to OSGi </a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    Baptiste Wicht
            </span></p>
            <p class="dateline">
            <a href="#" rel="bookmark">
            <time class="published dt-published" datetime="2010-04-18T10:57:50+02:00" itemprop="datePublished" title="2010-04-18 10:57">2010-04-18 10:57</time></a>
            </p>
                <p class="commentline">
    
    <a href="jtheque-problems-migrating-osgi.html#disqus_thread" data-disqus-identifier="cache/posts/2010/04/jtheque-problems-migrating-osgi.html">Comments</a>


            
        </p>
<p class="sourceline"><a href="jtheque-problems-migrating-osgi.wp" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>Like you perhaps know, i'm currently <a title="JTheque is going to OSGi" href="http://www.baptiste-wicht.com/2010/03/jtheque-is-going-to-osgi/" target="_self">migrating JTheque to OSGi</a>. During this migration i found several problems in the JTheque architecture that made the migration impossible without changing some concepts. In this post I'll detail all the problems I found.</p>
<h5>Resources</h5>

<p>First of all, i had to completely change the way to cache resources. Before, i used a ResourceManager to cache images/icons. To get an image/icon, i gave to it the path to the resource and the manager made the rest. I used Spring to load the resources (using the Resource class). That worked well because all the modules and the core were in the same application context.</p>
<p>But now, there is an application context for each OSGi bundle, so that doesn't work at all. So i had to find an other way. The manager cannot load the resources because they're accessible from the other bundles. So I changes the way the manager works :</p>
<ol>
<li>The modules must register all the resources they need in the resource manager. They can always use Spring to load the resource or direct use the Resource class to load it.</li>
    <li>When the module need an image/icon, it ask the resource manager. The manager watch on the cache (the cache associates the Resource to the loaded image/icon) if the image is already cached. If it's cached, it directly return the image else, it load the image from the resource and return the loaded image</li>
</ol>
<p>In that way, the resource manager doesn't have to access directly to resources on other bundles and everything works well.</p>
<h4>States</h4>

<p>The states are a way to store configuration for the modules. Before, the states must implements an interface and when they we're saved, the class were saved in a file and at startup created by reflection. But that's was not possible anymore, because the class was not accessible from the state bundle.</p>
<p>So I changed the way the data were saved using directly methods of the interface to get the stored data and to restore them at startup. Moreover, I also replaced the interface by annotations.</p>
<h4>Miscellaneous</h4>

<p>More than these other major changes, i've also some others problems :</p>
<ul>
<li>The JDBC driver class was not accessible. I add the package import to the manifest headers and get the driver version from SpringSource Repository to works with OSGi</li>
    <li>Substance doesn't work anymore. At this time, i don't know i that comes from OSGi or from other changes i made in the application, but i've not solved this problem.</li>
</ul>
<h3>Related articles</h3>
    

    <li><a href="../03/jtheque-is-going-to-osgi.html">JTheque is going to OSGi</a></li>
<li><a href="../10/jtheque-core-2-1-0-released.html">JTheque Core 2.1.0 released !</a></li>
<li><a href="../03/osgi-enterprise-4-2-available.html">OSGi 4.2 Entreprise Release is available !</a></li>
<li><a href="../07/osgi-hello-world-services.html">OSGi - Simple Hello World with services</a></li>
<li><a href="../07/modular-java-book-review.html">Modular Java â€“ Book Review</a></li>
<li><a href="../09/jtheque-utils-1-1-5.html">JTheque Utils 1.1.5</a></li>


    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../../categories/conception.html" rel="tag">Conception</a></li>
            <li><a class="tag p-category" href="../../../categories/jtheque.html" rel="tag">JTheque</a></li>
            <li><a class="tag p-category" href="../../../categories/osgi.html" rel="tag">OSGi</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="10-most-useful-google-tools.html" rel="prev" title="10 most useful Google Tools ">Previous post</a>
            </li>
            <li class="next">
                <a href="java-7-updates-project-coin.html" rel="next" title="Java 7 : Languages updates from Project Coin">Next post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
        
    
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="blogwichtounet",
            disqus_url="https://baptiste-wicht.com/posts/2010/04/jtheque-problems-migrating-osgi.html",
        disqus_title="JTheque : Problems when migrating to OSGi ",
        disqus_identifier="cache/posts/2010/04/jtheque-problems-migrating-osgi.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section></article><script>var disqus_shortname="blogwichtounet";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents Â© 2025         <a href="mailto:baptistewicht@gmail.com">Baptiste Wicht</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         - License: 
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="padding-left:5px;border-width:0" src="../../../assets/img/cc.png"></a>
            
        </footer>
</div>
</div>


            <script src="../../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script>
</body>
</html>
