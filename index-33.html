<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Tutorials and short posts about programming, C++, Java, Assembly, Operating Systems Development, Compilers, ...">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Blog blog("Baptiste Wicht"); (old posts, page 33) | Blog blog("Baptiste Wicht");</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="rss.xml">
<link rel="canonical" href="https://baptiste-wicht.com/index-33.html">
<link rel="prev" href="index-34.html" type="text/html">
<link rel="next" href="index-32.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://baptiste-wicht.com/">

                <span id="blog-title">Blog blog("Baptiste Wicht");</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="stories/about.html">About</a>
                </li>
<li>
<a href="stories/publications.html">Publications</a>
                </li>
<li>
<a href="stories/projects.html">Projects</a>
                </li>
<li>
<a href="categories/index.html">Tags</a>
                </li>
<li>
<a href="archive.html">Archives</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/2018/01/expression-templates-library-121-faster-gpu-and-new-features.html" class="u-url">Expression Templates Library 1.2.1: Faster GPU and new features</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Baptiste Wicht
            </span></p>
            <p class="dateline">
            <a href="posts/2018/01/expression-templates-library-121-faster-gpu-and-new-features.html" rel="bookmark">
            <time class="published dt-published" datetime="2018-01-09T11:06:15+01:00" itemprop="datePublished" title="2018-01-09 11:06">2018-01-09 11:06</time></a>
            </p>
                <p class="commentline">
    
    <a href="posts/2018/01/expression-templates-library-121-faster-gpu-and-new-features.html#disqus_thread" data-disqus-identifier="cache/posts/2018/01/expression-templates-library-121-faster-gpu-and-new-features.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <p>Happy new year to all my dear readers!</p>
<p>It has been a while since I've posted on this blog. I've had to serve three
weeks in the army and then I had two weeks vacation. I've been actively working
on budgetwarrior with a brand new web interface! More on that later ;)</p>
<p>Today, I'm happy to release the version 1.2.1 of my Expression Templates Library
(ETL) project. This is a minor version but with significantly better GPU support
and a few new features and bug fixes so I decided to release it now.</p>
<section id="faster-gpu-support"><h2>Faster GPU support</h2>
<p>Last year, I <a class="reference external" href="https://baptiste-wicht.com/posts/2017/11/advanced-gpu-patterns-optimization-in-etl.html">implemented the support for the detection of advanced GPU patterns in ETL</a>.</p>
<p>This will significantly reduce the number of CUDA kernel calls that are being
launched. For instance, each of the following expressions will be evaluated
using a single GPU kernel:</p>
<div class="code"><pre class="code C++"><a id="rest_code_fbf9207808d44aa3bca55572c8bc3530-1" name="rest_code_fbf9207808d44aa3bca55572c8bc3530-1" href="posts/2018/01/expression-templates-library-121-faster-gpu-and-new-features.html#rest_code_fbf9207808d44aa3bca55572c8bc3530-1"></a><span class="n">yy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span>
<a id="rest_code_fbf9207808d44aa3bca55572c8bc3530-2" name="rest_code_fbf9207808d44aa3bca55572c8bc3530-2" href="posts/2018/01/expression-templates-library-121-faster-gpu-and-new-features.html#rest_code_fbf9207808d44aa3bca55572c8bc3530-2"></a><span class="n">yy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1.1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span>
<a id="rest_code_fbf9207808d44aa3bca55572c8bc3530-3" name="rest_code_fbf9207808d44aa3bca55572c8bc3530-3" href="posts/2018/01/expression-templates-library-121-faster-gpu-and-new-features.html#rest_code_fbf9207808d44aa3bca55572c8bc3530-3"></a><span class="n">yy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1.2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span>
<a id="rest_code_fbf9207808d44aa3bca55572c8bc3530-4" name="rest_code_fbf9207808d44aa3bca55572c8bc3530-4" href="posts/2018/01/expression-templates-library-121-faster-gpu-and-new-features.html#rest_code_fbf9207808d44aa3bca55572c8bc3530-4"></a><span class="n">yy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span>
<a id="rest_code_fbf9207808d44aa3bca55572c8bc3530-5" name="rest_code_fbf9207808d44aa3bca55572c8bc3530-5" href="posts/2018/01/expression-templates-library-121-faster-gpu-and-new-features.html#rest_code_fbf9207808d44aa3bca55572c8bc3530-5"></a><span class="n">yy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">1.1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span>
</pre></div>
<p>This makes some operation significantly faster.</p>
<p>Moreover, I've reduced a lot the numbers of device synchronization in the
library. Especially, I've removed almost all synchronization from the
etl-gpu-blas sub library. This means that synchronization is mostly only done
when data needs to go back to the CPU. For machine learning, this means at the
end of the epoch to compute the final error. This makes a HUGE difference in
time, I didn't realize before that I was doing way too much synchronization.</p>
<p>With these two changes, I've been able to attain <em>state of the art training performance on GPU</em> with my Deep Learning Library (DLL) project!</p>
<p>Moreover, I've now added for random number generations on the GPU and for
shuffle operations as well.</p>
</section><section id="new-features"><h2>New Features</h2>
<p>I've also added a few new features recently. They were especially added to
support new features in DLL.</p>
<p>Matrices and vectors can now be normalized in order to have zero-mean and
unit-variance distribution. You can also merge matrices together. For now, there
is no GPU support, so this will use CPU anyway. I plan to fix that later.</p>
<p>In addition to bias_batch_mean that I added before, I also added bias_batch_var
now with the variance in place of the mean. This is mainly used for Batch
Normalization in machine learning, but it may have some other usages. The GPU
support has been added as well directly.</p>
<p>And the last feature is the support for embedding and the gradients of
embedding. Again this is totally related to machine learning, but can be very
useful as well. I haven't add the time to develop the GPU version so far, but
this will come as well.</p>
</section><section id="performance"><h2>Performance</h2>
<p>Nothing fancy on the CPU performance side, I only added vectorization for
hyperbolic versions. This makes <em>tanh much faster on CPU</em>.</p>
</section><section id="bug-fixes"><h2>Bug Fixes</h2>
<p>I fixed quite a few bugs in this version, which is one of the main reason
I released it:</p>
<p>1. When using large fast_matrix and aliasing was detected, there was a big chance of stack overflow occurring. This is now fixed by using a dynamic temporary.
1. Some assignables such sub_view did not perform any detection for aliasing. This is now fixed and aliasing is detected everywhere.
1. fast_dyn_matrix can now be correctly used with <em>bool</em>
1. The use of iterators was not always ensuring correct CPU/GPU consistency. This is now correctly handled.
1. The 4D convolution in GPU were not using the correct flipping
1. Fix small compilation bug with sub_matrix and GPU</p>
</section><section id="what-s-next"><h2>What's next ?</h2>
<p>I don't really know what will be in the next release. This should be the release
1.3. One possible idea would be to improve and review the support for sparse
matrix which is more than  poor as of now. But I'm not really motivated to
work on that :P Moreover, I'm now <em>actively</em> working on the next release of
budgetwarrior which will probably still come this month.</p>
<p>I'm also still hesitating in switching to C++17 for the library to make it
faster to compile. And also to clean some parts of the code. I would be able to
remove quite some SFINAE with the new <em>if constexpr</em>, but I'm afraid this will
make the library to difficult to use since it would need at least GCC 7 or clang
3.9.</p>
<section id="download-etl"><h3>Download ETL</h3>
<p>You can download ETL <a class="reference external" href="https://github.com/wichtounet/etl">on Github</a>. If you
only interested in the 1.2.1 version, you can look at the
<a class="reference external" href="https://github.com/wichtounet/etl/releases">Releases pages</a> or clone the tag
1.2.1. There are several branches:</p>
<ul class="simple">
<li><p><em>master</em> Is the eternal development branch, may not always be stable</p></li>
<li><p><em>stable</em> Is a branch always pointing to the last tag, no development here</p></li>
</ul>
<p>For the future release, there always will tags pointing to the corresponding
commits. You can also have access to previous releases on Github or via the
release tags.</p>
<p>The documentation is still a bit sparse. There are a few examples and the Wiki,
but there still is work to be done. If you have questions on how to use or
configure the library, please don't hesitate.</p>
<p>Don't hesitate to comment this post if you have any comment on this library or
any question. You can also open an Issue on Github if you have a problem using
this library or propose a Pull Request if you have any contribution you'd like
to make to the library.</p>
<p>Hope this may be useful to some of you :)</p>
</section></section>
</div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/2017/11/advanced-gpu-patterns-optimization-in-etl.html" class="u-url">Advanced GPU Patterns Optimization in ETL</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Baptiste Wicht
            </span></p>
            <p class="dateline">
            <a href="posts/2017/11/advanced-gpu-patterns-optimization-in-etl.html" rel="bookmark">
            <time class="published dt-published" datetime="2017-11-26T15:44:29+01:00" itemprop="datePublished" title="2017-11-26 15:44">2017-11-26 15:44</time></a>
            </p>
                <p class="commentline">
    
    <a href="posts/2017/11/advanced-gpu-patterns-optimization-in-etl.html#disqus_thread" data-disqus-identifier="cache/posts/2017/11/advanced-gpu-patterns-optimization-in-etl.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <p>The GPU performance of my Expression Templates Library (ETL) is pretty good when
most of the time is spent inside expensive operations such as Matrix-Matrix
Multiplication or convolutions. However, when most of the time is spent in
linear kernels, performance is not great because this will invoke a lot of CUDA
kernels. Indeed, the way it is done is that each sub expressions compute its
result in a temporary GPU vector (or matrix) and these temporaries are passed
through the expressions. For instance, this expression:</p>
<div class="code"><pre class="code C++"><a id="rest_code_89a35fae37a1458ca27bb51a0549999b-1" name="rest_code_89a35fae37a1458ca27bb51a0549999b-1" href="posts/2017/11/advanced-gpu-patterns-optimization-in-etl.html#rest_code_89a35fae37a1458ca27bb51a0549999b-1"></a><span class="n">yy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1.2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span>
</pre></div>
<p>will be executed on the GPU as something like this:</p>
<div class="code"><pre class="code C++"><a id="rest_code_fc6ab25392a74c1cb5a7bfc6adfc5b7a-1" name="rest_code_fc6ab25392a74c1cb5a7bfc6adfc5b7a-1" href="posts/2017/11/advanced-gpu-patterns-optimization-in-etl.html#rest_code_fc6ab25392a74c1cb5a7bfc6adfc5b7a-1"></a><span class="n">t1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span>
<a id="rest_code_fc6ab25392a74c1cb5a7bfc6adfc5b7a-2" name="rest_code_fc6ab25392a74c1cb5a7bfc6adfc5b7a-2" href="posts/2017/11/advanced-gpu-patterns-optimization-in-etl.html#rest_code_fc6ab25392a74c1cb5a7bfc6adfc5b7a-2"></a><span class="n">t2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span>
<a id="rest_code_fc6ab25392a74c1cb5a7bfc6adfc5b7a-3" name="rest_code_fc6ab25392a74c1cb5a7bfc6adfc5b7a-3" href="posts/2017/11/advanced-gpu-patterns-optimization-in-etl.html#rest_code_fc6ab25392a74c1cb5a7bfc6adfc5b7a-3"></a><span class="n">yy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t2</span>
</pre></div>
<p>that will results in three GPU kernels being invoked. In the CPU case, the
complete expression will be executed as one CPU kernel, that is constructed with
Expression Templates. Unfortunately, a CUDA kernel cannot be constructed in the
same way since the CUDA compiler does not support general template
metaprogramming. That's why I've implemented by using small kernels for each
expression.</p>
<p>Fortunately, we can do better with a bit more meta-programming. Indeed, there
are some patterns that are repeated a lot and that easily be implemented in CUDA
kernels. I've started detecting a few of these patterns and for each of them
a single CUDA kernel is executed. For instance, each of the following
expressions can be executed with a single kernel:</p>
<div class="code"><pre class="code C++"><a id="rest_code_493876c154b440e38a37e7cacfd913ea-1" name="rest_code_493876c154b440e38a37e7cacfd913ea-1" href="posts/2017/11/advanced-gpu-patterns-optimization-in-etl.html#rest_code_493876c154b440e38a37e7cacfd913ea-1"></a><span class="n">yy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span>
<a id="rest_code_493876c154b440e38a37e7cacfd913ea-2" name="rest_code_493876c154b440e38a37e7cacfd913ea-2" href="posts/2017/11/advanced-gpu-patterns-optimization-in-etl.html#rest_code_493876c154b440e38a37e7cacfd913ea-2"></a><span class="n">yy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1.1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span>
<a id="rest_code_493876c154b440e38a37e7cacfd913ea-3" name="rest_code_493876c154b440e38a37e7cacfd913ea-3" href="posts/2017/11/advanced-gpu-patterns-optimization-in-etl.html#rest_code_493876c154b440e38a37e7cacfd913ea-3"></a><span class="n">yy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1.2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span>
<a id="rest_code_493876c154b440e38a37e7cacfd913ea-4" name="rest_code_493876c154b440e38a37e7cacfd913ea-4" href="posts/2017/11/advanced-gpu-patterns-optimization-in-etl.html#rest_code_493876c154b440e38a37e7cacfd913ea-4"></a><span class="n">yy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span>
<a id="rest_code_493876c154b440e38a37e7cacfd913ea-5" name="rest_code_493876c154b440e38a37e7cacfd913ea-5" href="posts/2017/11/advanced-gpu-patterns-optimization-in-etl.html#rest_code_493876c154b440e38a37e7cacfd913ea-5"></a><span class="n">yy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">1.1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span>
</pre></div>
<p>This results in significantly performance improvement for these expressions!</p>
<p>I have tested these new improvements in my Deep Learning Library (DLL) project
(not yet merged) and it resulted in <strong>25% faster momentum computation</strong> and
<strong>17% faster Nesterov Adam (NADAM)</strong>.</p>
<p>I'm going to continue to investigate which kernels need to be made faster for
DLL and try to improve the overall performance. Currently, the GPU performance
of DLL is very good for large convolutional networks, but could be improved for
small fully-connected networks. Indeed, in that case, quite some time is spent
outside the matrix-matrix multiplication and inside serial expressions for which
GPU could be improved. Once I'm done with my optimizations, I'll probably post
again on the blog with the latest results.</p>
<p>All these new optimizations are now in the <strong>master</strong> branch of the ETL
project if you want to check it out. You can access the project
<a class="reference external" href="https://github.com/wichtounet/etl">on Github</a>.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html" class="u-url">Initial support for Long Short Term Memory (LSTM) in DLL</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Baptiste Wicht
            </span></p>
            <p class="dateline">
            <a href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html" rel="bookmark">
            <time class="published dt-published" datetime="2017-11-24T15:16:37+01:00" itemprop="datePublished" title="2017-11-24 15:16">2017-11-24 15:16</time></a>
            </p>
                <p class="commentline">
    
    <a href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#disqus_thread" data-disqus-identifier="cache/posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <p>I'm really happy to announce that I just merged support for</p>
<p>Long Short Term Memory
(LSTM) cells into my Deep Learning Library (DLL) machine learning framework. Two
weeks ago, <a class="reference external" href="https://baptiste-wicht.com/posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html">I already merged suport for Recurrent Neural network (RNN)</a>.</p>
<p>It's nothing fancy yet, but forward propagation of LSTM and basic
Backpropagation Through Time (BPTT) are now supported. It was not really
complicated to implemenet the forward pass but the backward pass is much
complicated for an LSTM than for a RNN. It took me quite a long time to figure
out all the gradients formulas and the documentation on that is quite scarce.</p>
<p>For now, still only existing classification loss is supported for RNN and LSTM.
As I said last time, I still plan to add support for sequence-to-sequence loss
in order to be able to train models able to generate characters. However, I don't
know when I'll be able to work on that. Now that I've got the code for LSTM,
I should be able to implement a GRU cell and NAS cell quite easily I believe.</p>
<p>For example, here is a simple LSTM used on MNIST for classification:</p>
<div class="code"><pre class="code cpp"><a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-1" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-1" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">"dll/neural/dense_layer.hpp"</span>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-2" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-2" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-2"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">"dll/neural/lstm_layer.hpp"</span>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-3" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-3" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-3"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">"dll/neural/recurrent_last_layer.hpp"</span>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-4" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-4" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-4"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">"dll/network.hpp"</span>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-5" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-5" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-5"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">"dll/datasets.hpp"</span>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-6" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-6" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-6"></a>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-7" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-7" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-7"></a><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="cm">/*argc*/</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="cm">/*argv*/</span><span class="w"> </span><span class="p">[])</span><span class="w"> </span><span class="p">{</span>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-8" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-8" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-8"></a><span class="w">    </span><span class="c1">// Load the dataset</span>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-9" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-9" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-9"></a><span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">dataset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dll</span><span class="o">::</span><span class="n">make_mnist_dataset_nc</span><span class="p">(</span><span class="n">dll</span><span class="o">::</span><span class="n">batch_size</span><span class="o">&lt;</span><span class="mi">100</span><span class="o">&gt;</span><span class="p">{},</span><span class="w"> </span><span class="n">dll</span><span class="o">::</span><span class="n">scale_pre</span><span class="o">&lt;</span><span class="mi">255</span><span class="o">&gt;</span><span class="p">{});</span>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-10" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-10" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-10"></a>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-11" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-11" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-11"></a><span class="w">    </span><span class="k">constexpr</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">time_steps</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="mi">28</span><span class="p">;</span>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-12" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-12" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-12"></a><span class="w">    </span><span class="k">constexpr</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">sequence_length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">28</span><span class="p">;</span>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-13" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-13" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-13"></a><span class="w">    </span><span class="k">constexpr</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">hidden_units</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-14" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-14" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-14"></a>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-15" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-15" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-15"></a><span class="w">    </span><span class="c1">// Build the network</span>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-16" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-16" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-16"></a>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-17" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-17" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-17"></a><span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">network_t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dll</span><span class="o">::</span><span class="n">dyn_network_desc</span><span class="o">&lt;</span>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-18" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-18" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-18"></a><span class="w">        </span><span class="n">dll</span><span class="o">::</span><span class="n">network_layers</span><span class="o">&lt;</span>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-19" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-19" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-19"></a><span class="w">            </span><span class="n">dll</span><span class="o">::</span><span class="n">lstm_layer</span><span class="o">&lt;</span><span class="n">time_steps</span><span class="p">,</span><span class="w"> </span><span class="n">sequence_length</span><span class="p">,</span><span class="w"> </span><span class="n">hidden_units</span><span class="p">,</span><span class="w"> </span><span class="n">dll</span><span class="o">::</span><span class="n">last_only</span><span class="o">&gt;</span><span class="p">,</span>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-20" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-20" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-20"></a><span class="w">            </span><span class="n">dll</span><span class="o">::</span><span class="n">recurrent_last_layer</span><span class="o">&lt;</span><span class="n">time_steps</span><span class="p">,</span><span class="w"> </span><span class="n">hidden_units</span><span class="o">&gt;</span><span class="p">,</span>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-21" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-21" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-21"></a><span class="w">            </span><span class="n">dll</span><span class="o">::</span><span class="n">dense_layer</span><span class="o">&lt;</span><span class="n">hidden_units</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">dll</span><span class="o">::</span><span class="n">softmax</span><span class="o">&gt;</span>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-22" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-22" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-22"></a><span class="w">        </span><span class="o">&gt;</span>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-23" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-23" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-23"></a><span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="n">dll</span><span class="o">::</span><span class="n">updater</span><span class="o">&lt;</span><span class="n">dll</span><span class="o">::</span><span class="n">updater_type</span><span class="o">::</span><span class="n">ADAM</span><span class="o">&gt;</span><span class="w">      </span><span class="c1">// Adam</span>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-24" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-24" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-24"></a><span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="n">dll</span><span class="o">::</span><span class="n">batch_size</span><span class="o">&lt;</span><span class="mi">100</span><span class="o">&gt;</span><span class="w">                       </span><span class="c1">// The mini-batch size</span>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-25" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-25" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-25"></a><span class="w">    </span><span class="o">&gt;::</span><span class="n">network_t</span><span class="p">;</span>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-26" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-26" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-26"></a>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-27" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-27" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-27"></a><span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">net</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">network_t</span><span class="o">&gt;</span><span class="p">();</span>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-28" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-28" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-28"></a>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-29" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-29" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-29"></a><span class="w">    </span><span class="c1">// Display the network and dataset</span>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-30" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-30" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-30"></a><span class="w">    </span><span class="n">net</span><span class="o">-&gt;</span><span class="n">display</span><span class="p">();</span>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-31" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-31" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-31"></a><span class="w">    </span><span class="n">dataset</span><span class="p">.</span><span class="n">display</span><span class="p">();</span>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-32" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-32" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-32"></a>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-33" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-33" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-33"></a><span class="w">    </span><span class="c1">// Train the network for performance sake</span>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-34" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-34" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-34"></a><span class="w">    </span><span class="n">net</span><span class="o">-&gt;</span><span class="n">fine_tune</span><span class="p">(</span><span class="n">dataset</span><span class="p">.</span><span class="n">train</span><span class="p">(),</span><span class="w"> </span><span class="mi">50</span><span class="p">);</span>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-35" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-35" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-35"></a>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-36" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-36" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-36"></a><span class="w">    </span><span class="c1">// Test the network on test set</span>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-37" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-37" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-37"></a><span class="w">    </span><span class="n">net</span><span class="o">-&gt;</span><span class="n">evaluate</span><span class="p">(</span><span class="n">dataset</span><span class="p">.</span><span class="n">test</span><span class="p">());</span>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-38" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-38" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-38"></a>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-39" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-39" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-39"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-40" name="rest_code_2b96c28509cf4a1fb10dc13999fea6b1-40" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_2b96c28509cf4a1fb10dc13999fea6b1-40"></a><span class="p">}</span>
</pre></div>
<p>The network is quite similar to the one used previously with an RNN, just
replace rnn with lstm and that's it. It starts with LSTM layer, followed by
a layer extracting the last time step and finally a dense layer with a softmax
function. The network is trained with Adam for 50 epochs. You can change the
activation function , the initializer for the weights and the biases and number
of steps for BPTT truncation.</p>
<p>Here is the result I got on my last run:</p>
<div class="code"><pre class="code text"><a id="rest_code_b6c8cef5fd614934a77ea378007b1348-1" name="rest_code_b6c8cef5fd614934a77ea378007b1348-1" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-1"></a>------------------------------------------------------------
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-2" name="rest_code_b6c8cef5fd614934a77ea378007b1348-2" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-2"></a>| Index | Layer                | Parameters | Output Shape |
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-3" name="rest_code_b6c8cef5fd614934a77ea378007b1348-3" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-3"></a>------------------------------------------------------------
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-4" name="rest_code_b6c8cef5fd614934a77ea378007b1348-4" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-4"></a>| 0     | LSTM (TANH) (dyn)    |      51200 | [Bx28x100]   |
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-5" name="rest_code_b6c8cef5fd614934a77ea378007b1348-5" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-5"></a>| 1     | RNN(last)            |          0 | [Bx100]      |
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-6" name="rest_code_b6c8cef5fd614934a77ea378007b1348-6" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-6"></a>| 2     | Dense(SOFTMAX) (dyn) |       1000 | [Bx10]       |
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-7" name="rest_code_b6c8cef5fd614934a77ea378007b1348-7" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-7"></a>------------------------------------------------------------
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-8" name="rest_code_b6c8cef5fd614934a77ea378007b1348-8" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-8"></a>              Total Parameters:      52200
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-9" name="rest_code_b6c8cef5fd614934a77ea378007b1348-9" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-9"></a>
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-10" name="rest_code_b6c8cef5fd614934a77ea378007b1348-10" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-10"></a>--------------------------------------------
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-11" name="rest_code_b6c8cef5fd614934a77ea378007b1348-11" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-11"></a>| mnist | Size  | Batches | Augmented Size |
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-12" name="rest_code_b6c8cef5fd614934a77ea378007b1348-12" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-12"></a>--------------------------------------------
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-13" name="rest_code_b6c8cef5fd614934a77ea378007b1348-13" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-13"></a>| train | 60000 | 600     | 60000          |
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-14" name="rest_code_b6c8cef5fd614934a77ea378007b1348-14" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-14"></a>| test  | 10000 | 100     | 10000          |
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-15" name="rest_code_b6c8cef5fd614934a77ea378007b1348-15" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-15"></a>--------------------------------------------
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-16" name="rest_code_b6c8cef5fd614934a77ea378007b1348-16" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-16"></a>
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-17" name="rest_code_b6c8cef5fd614934a77ea378007b1348-17" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-17"></a>Network with 3 layers
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-18" name="rest_code_b6c8cef5fd614934a77ea378007b1348-18" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-18"></a>    LSTM(dyn): 28x28 -&gt; TANH -&gt; 28x100
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-19" name="rest_code_b6c8cef5fd614934a77ea378007b1348-19" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-19"></a>    RNN(last): 28x100 -&gt; 100
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-20" name="rest_code_b6c8cef5fd614934a77ea378007b1348-20" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-20"></a>    Dense(dyn): 100 -&gt; SOFTMAX -&gt; 10
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-21" name="rest_code_b6c8cef5fd614934a77ea378007b1348-21" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-21"></a>Total parameters: 52200
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-22" name="rest_code_b6c8cef5fd614934a77ea378007b1348-22" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-22"></a>Dataset
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-23" name="rest_code_b6c8cef5fd614934a77ea378007b1348-23" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-23"></a>Training: In-Memory Data Generator
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-24" name="rest_code_b6c8cef5fd614934a77ea378007b1348-24" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-24"></a>              Size: 60000
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-25" name="rest_code_b6c8cef5fd614934a77ea378007b1348-25" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-25"></a>           Batches: 600
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-26" name="rest_code_b6c8cef5fd614934a77ea378007b1348-26" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-26"></a>Testing: In-Memory Data Generator
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-27" name="rest_code_b6c8cef5fd614934a77ea378007b1348-27" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-27"></a>              Size: 10000
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-28" name="rest_code_b6c8cef5fd614934a77ea378007b1348-28" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-28"></a>           Batches: 100
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-29" name="rest_code_b6c8cef5fd614934a77ea378007b1348-29" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-29"></a>
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-30" name="rest_code_b6c8cef5fd614934a77ea378007b1348-30" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-30"></a>Train the network with "Stochastic Gradient Descent"
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-31" name="rest_code_b6c8cef5fd614934a77ea378007b1348-31" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-31"></a>    Updater: ADAM
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-32" name="rest_code_b6c8cef5fd614934a77ea378007b1348-32" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-32"></a>       Loss: CATEGORICAL_CROSS_ENTROPY
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-33" name="rest_code_b6c8cef5fd614934a77ea378007b1348-33" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-33"></a> Early Stop: Goal(error)
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-34" name="rest_code_b6c8cef5fd614934a77ea378007b1348-34" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-34"></a>
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-35" name="rest_code_b6c8cef5fd614934a77ea378007b1348-35" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-35"></a>With parameters:
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-36" name="rest_code_b6c8cef5fd614934a77ea378007b1348-36" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-36"></a>          epochs=50
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-37" name="rest_code_b6c8cef5fd614934a77ea378007b1348-37" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-37"></a>      batch_size=100
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-38" name="rest_code_b6c8cef5fd614934a77ea378007b1348-38" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-38"></a>   learning_rate=0.001
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-39" name="rest_code_b6c8cef5fd614934a77ea378007b1348-39" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-39"></a>           beta1=0.9
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-40" name="rest_code_b6c8cef5fd614934a77ea378007b1348-40" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-40"></a>           beta2=0.999
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-41" name="rest_code_b6c8cef5fd614934a77ea378007b1348-41" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-41"></a>
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-42" name="rest_code_b6c8cef5fd614934a77ea378007b1348-42" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-42"></a>epoch   0/50 batch  600/ 600 - error: 0.07943 loss: 0.28504 time 20910ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-43" name="rest_code_b6c8cef5fd614934a77ea378007b1348-43" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-43"></a>epoch   1/50 batch  600/ 600 - error: 0.06683 loss: 0.24021 time 20889ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-44" name="rest_code_b6c8cef5fd614934a77ea378007b1348-44" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-44"></a>epoch   2/50 batch  600/ 600 - error: 0.04828 loss: 0.18233 time 21061ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-45" name="rest_code_b6c8cef5fd614934a77ea378007b1348-45" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-45"></a>epoch   3/50 batch  600/ 600 - error: 0.04407 loss: 0.16665 time 20839ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-46" name="rest_code_b6c8cef5fd614934a77ea378007b1348-46" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-46"></a>epoch   4/50 batch  600/ 600 - error: 0.03515 loss: 0.13290 time 22108ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-47" name="rest_code_b6c8cef5fd614934a77ea378007b1348-47" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-47"></a>epoch   5/50 batch  600/ 600 - error: 0.03207 loss: 0.12019 time 21393ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-48" name="rest_code_b6c8cef5fd614934a77ea378007b1348-48" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-48"></a>epoch   6/50 batch  600/ 600 - error: 0.02973 loss: 0.11239 time 28199ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-49" name="rest_code_b6c8cef5fd614934a77ea378007b1348-49" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-49"></a>epoch   7/50 batch  600/ 600 - error: 0.02653 loss: 0.10455 time 37039ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-50" name="rest_code_b6c8cef5fd614934a77ea378007b1348-50" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-50"></a>epoch   8/50 batch  600/ 600 - error: 0.02482 loss: 0.09657 time 23127ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-51" name="rest_code_b6c8cef5fd614934a77ea378007b1348-51" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-51"></a>epoch   9/50 batch  600/ 600 - error: 0.02177 loss: 0.08422 time 41766ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-52" name="rest_code_b6c8cef5fd614934a77ea378007b1348-52" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-52"></a>epoch  10/50 batch  600/ 600 - error: 0.02453 loss: 0.09382 time 29765ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-53" name="rest_code_b6c8cef5fd614934a77ea378007b1348-53" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-53"></a>epoch  11/50 batch  600/ 600 - error: 0.02575 loss: 0.09796 time 21449ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-54" name="rest_code_b6c8cef5fd614934a77ea378007b1348-54" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-54"></a>epoch  12/50 batch  600/ 600 - error: 0.02107 loss: 0.07833 time 42056ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-55" name="rest_code_b6c8cef5fd614934a77ea378007b1348-55" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-55"></a>epoch  13/50 batch  600/ 600 - error: 0.01877 loss: 0.07171 time 24673ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-56" name="rest_code_b6c8cef5fd614934a77ea378007b1348-56" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-56"></a>epoch  14/50 batch  600/ 600 - error: 0.02095 loss: 0.08481 time 20878ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-57" name="rest_code_b6c8cef5fd614934a77ea378007b1348-57" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-57"></a>epoch  15/50 batch  600/ 600 - error: 0.02040 loss: 0.07578 time 41515ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-58" name="rest_code_b6c8cef5fd614934a77ea378007b1348-58" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-58"></a>epoch  16/50 batch  600/ 600 - error: 0.01580 loss: 0.06083 time 25705ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-59" name="rest_code_b6c8cef5fd614934a77ea378007b1348-59" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-59"></a>epoch  17/50 batch  600/ 600 - error: 0.01945 loss: 0.07046 time 20903ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-60" name="rest_code_b6c8cef5fd614934a77ea378007b1348-60" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-60"></a>epoch  18/50 batch  600/ 600 - error: 0.01728 loss: 0.06683 time 41828ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-61" name="rest_code_b6c8cef5fd614934a77ea378007b1348-61" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-61"></a>epoch  19/50 batch  600/ 600 - error: 0.01577 loss: 0.05947 time 27810ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-62" name="rest_code_b6c8cef5fd614934a77ea378007b1348-62" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-62"></a>epoch  20/50 batch  600/ 600 - error: 0.01528 loss: 0.05883 time 21477ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-63" name="rest_code_b6c8cef5fd614934a77ea378007b1348-63" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-63"></a>epoch  21/50 batch  600/ 600 - error: 0.01345 loss: 0.05127 time 44718ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-64" name="rest_code_b6c8cef5fd614934a77ea378007b1348-64" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-64"></a>epoch  22/50 batch  600/ 600 - error: 0.01410 loss: 0.05357 time 25174ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-65" name="rest_code_b6c8cef5fd614934a77ea378007b1348-65" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-65"></a>epoch  23/50 batch  600/ 600 - error: 0.01268 loss: 0.04765 time 23827ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-66" name="rest_code_b6c8cef5fd614934a77ea378007b1348-66" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-66"></a>epoch  24/50 batch  600/ 600 - error: 0.01342 loss: 0.05004 time 47232ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-67" name="rest_code_b6c8cef5fd614934a77ea378007b1348-67" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-67"></a>epoch  25/50 batch  600/ 600 - error: 0.01730 loss: 0.06872 time 22532ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-68" name="rest_code_b6c8cef5fd614934a77ea378007b1348-68" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-68"></a>epoch  26/50 batch  600/ 600 - error: 0.01337 loss: 0.05016 time 30114ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-69" name="rest_code_b6c8cef5fd614934a77ea378007b1348-69" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-69"></a>epoch  27/50 batch  600/ 600 - error: 0.01842 loss: 0.07049 time 40136ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-70" name="rest_code_b6c8cef5fd614934a77ea378007b1348-70" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-70"></a>epoch  28/50 batch  600/ 600 - error: 0.01262 loss: 0.04639 time 21793ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-71" name="rest_code_b6c8cef5fd614934a77ea378007b1348-71" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-71"></a>epoch  29/50 batch  600/ 600 - error: 0.01403 loss: 0.05292 time 34096ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-72" name="rest_code_b6c8cef5fd614934a77ea378007b1348-72" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-72"></a>epoch  30/50 batch  600/ 600 - error: 0.01185 loss: 0.04456 time 35420ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-73" name="rest_code_b6c8cef5fd614934a77ea378007b1348-73" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-73"></a>epoch  31/50 batch  600/ 600 - error: 0.01098 loss: 0.04180 time 20909ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-74" name="rest_code_b6c8cef5fd614934a77ea378007b1348-74" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-74"></a>epoch  32/50 batch  600/ 600 - error: 0.01337 loss: 0.04687 time 30113ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-75" name="rest_code_b6c8cef5fd614934a77ea378007b1348-75" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-75"></a>epoch  33/50 batch  600/ 600 - error: 0.01415 loss: 0.05292 time 37393ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-76" name="rest_code_b6c8cef5fd614934a77ea378007b1348-76" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-76"></a>epoch  34/50 batch  600/ 600 - error: 0.00982 loss: 0.03615 time 20962ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-77" name="rest_code_b6c8cef5fd614934a77ea378007b1348-77" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-77"></a>epoch  35/50 batch  600/ 600 - error: 0.01178 loss: 0.04830 time 29305ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-78" name="rest_code_b6c8cef5fd614934a77ea378007b1348-78" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-78"></a>epoch  36/50 batch  600/ 600 - error: 0.00882 loss: 0.03408 time 38293ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-79" name="rest_code_b6c8cef5fd614934a77ea378007b1348-79" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-79"></a>epoch  37/50 batch  600/ 600 - error: 0.01148 loss: 0.04341 time 20841ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-80" name="rest_code_b6c8cef5fd614934a77ea378007b1348-80" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-80"></a>epoch  38/50 batch  600/ 600 - error: 0.00960 loss: 0.03701 time 29204ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-81" name="rest_code_b6c8cef5fd614934a77ea378007b1348-81" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-81"></a>epoch  39/50 batch  600/ 600 - error: 0.00850 loss: 0.03094 time 39802ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-82" name="rest_code_b6c8cef5fd614934a77ea378007b1348-82" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-82"></a>epoch  40/50 batch  600/ 600 - error: 0.01473 loss: 0.05136 time 20831ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-83" name="rest_code_b6c8cef5fd614934a77ea378007b1348-83" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-83"></a>epoch  41/50 batch  600/ 600 - error: 0.01007 loss: 0.03579 time 29856ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-84" name="rest_code_b6c8cef5fd614934a77ea378007b1348-84" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-84"></a>epoch  42/50 batch  600/ 600 - error: 0.00943 loss: 0.03370 time 38200ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-85" name="rest_code_b6c8cef5fd614934a77ea378007b1348-85" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-85"></a>epoch  43/50 batch  600/ 600 - error: 0.01205 loss: 0.04409 time 21162ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-86" name="rest_code_b6c8cef5fd614934a77ea378007b1348-86" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-86"></a>epoch  44/50 batch  600/ 600 - error: 0.00980 loss: 0.03674 time 32279ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-87" name="rest_code_b6c8cef5fd614934a77ea378007b1348-87" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-87"></a>epoch  45/50 batch  600/ 600 - error: 0.01068 loss: 0.04133 time 38448ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-88" name="rest_code_b6c8cef5fd614934a77ea378007b1348-88" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-88"></a>epoch  46/50 batch  600/ 600 - error: 0.00913 loss: 0.03478 time 20797ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-89" name="rest_code_b6c8cef5fd614934a77ea378007b1348-89" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-89"></a>epoch  47/50 batch  600/ 600 - error: 0.00985 loss: 0.03759 time 28885ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-90" name="rest_code_b6c8cef5fd614934a77ea378007b1348-90" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-90"></a>epoch  48/50 batch  600/ 600 - error: 0.00912 loss: 0.03295 time 41120ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-91" name="rest_code_b6c8cef5fd614934a77ea378007b1348-91" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-91"></a>epoch  49/50 batch  600/ 600 - error: 0.00930 loss: 0.03438 time 21282ms
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-92" name="rest_code_b6c8cef5fd614934a77ea378007b1348-92" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-92"></a>Restore the best (error) weights from epoch 39
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-93" name="rest_code_b6c8cef5fd614934a77ea378007b1348-93" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-93"></a>Training took 1460s
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-94" name="rest_code_b6c8cef5fd614934a77ea378007b1348-94" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-94"></a>
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-95" name="rest_code_b6c8cef5fd614934a77ea378007b1348-95" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-95"></a>Evaluation Results
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-96" name="rest_code_b6c8cef5fd614934a77ea378007b1348-96" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-96"></a>   error: 0.02440
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-97" name="rest_code_b6c8cef5fd614934a77ea378007b1348-97" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-97"></a>    loss: 0.11315
<a id="rest_code_b6c8cef5fd614934a77ea378007b1348-98" name="rest_code_b6c8cef5fd614934a77ea378007b1348-98" href="posts/2017/11/initial-support-for-long-short-term-memory-lstm-in-dll.html#rest_code_b6c8cef5fd614934a77ea378007b1348-98"></a>evaluation took 1000ms
</pre></div>
<p>Again, nothing fancy yet, but this example has not been optimized for
performance nor for accuracy.</p>
<p>I also made a few changes to the RNN layer. I added support for biases and
improved the code as well for performance and readability.</p>
<p>All this support is now in the <strong>master</strong> branch of the DLL project if you want
to check it out. You can also check out the example online:
<a class="reference external" href="https://github.com/wichtounet/dll/blob/master/examples/src/mnist_lstm.cpp">mnist_lstm.cpp</a></p>
<p>You can access the project <a class="reference external" href="https://github.com/wichtounet/dll">on Github</a>.</p>
<p>Currently I'm working on the GPU performance again. The performance of some is
still not as good as I want it to be, especially complex operation like used in
Adam and Nadam. Currently, there are many calls to GPU BLAS libraries and
I want to try to extract some more optimized patterns. Once it's done, I'll post
more on that later on the blog.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/2017/11/dll-pretty-printing-and-live-output.html" class="u-url">DLL: Pretty printing and live output</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Baptiste Wicht
            </span></p>
            <p class="dateline">
            <a href="posts/2017/11/dll-pretty-printing-and-live-output.html" rel="bookmark">
            <time class="published dt-published" datetime="2017-11-19T15:15:57+01:00" itemprop="datePublished" title="2017-11-19 15:15">2017-11-19 15:15</time></a>
            </p>
                <p class="commentline">
    
    <a href="posts/2017/11/dll-pretty-printing-and-live-output.html#disqus_thread" data-disqus-identifier="cache/posts/2017/11/dll-pretty-printing-and-live-output.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <p>I've improved a lot the display of my Deep Learning Library (DLL). I know this
is generally not the most important point in a machine learning framework, but
the first impression being important. Therefore, I decided it was time to get
a nicer output in the console for training networks.</p>
<p>A network or a dataset can be displayed using the <cite>display()</cite> function.
I've added a <cite>display_pretty()</cite> function to them to display it more
nicely. I've also added the <cite>dll::dump_timers_nice()</cite> function to do the
same for <cite>dll::dump_timers()</cite>.</p>
<p>I've also improved the display for the results of the batches during training.
Now, the display is updated every 100ms and it also displays the current
estimated time until the end of the epoch. With that, the user should have
a much better idea on what's going on during training, especially when training
networks when the epochs are taking a long time to complete.</p>
<p>Here is a full output of the training of fully-connected network on MNIST
(<cite>mnist_mlp.cpp &lt;https://github.com/wichtounet/dll/blob/master/examples/src/mnist_mlp.cpp&gt;</cite>):</p>
<div class="code"><pre class="code bash"><a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-1" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-1" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-1"></a><span class="w"> </span>------------------------------------------------------------
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-2" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-2" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-2"></a><span class="w"> </span><span class="p">|</span><span class="w"> </span>Index<span class="w"> </span><span class="p">|</span><span class="w"> </span>Layer<span class="w">                </span><span class="p">|</span><span class="w"> </span>Parameters<span class="w"> </span><span class="p">|</span><span class="w"> </span>Output<span class="w"> </span>Shape<span class="w"> </span><span class="p">|</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-3" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-3" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-3"></a><span class="w"> </span>------------------------------------------------------------
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-4" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-4" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-4"></a><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">0</span><span class="w">     </span><span class="p">|</span><span class="w"> </span>Dense<span class="o">(</span>SIGMOID<span class="o">)</span><span class="w"> </span><span class="o">(</span>dyn<span class="o">)</span><span class="w"> </span><span class="p">|</span><span class="w">     </span><span class="m">392000</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="o">[</span>Bx500<span class="o">]</span><span class="w">      </span><span class="p">|</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-5" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-5" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-5"></a><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">1</span><span class="w">     </span><span class="p">|</span><span class="w"> </span>Dropout<span class="o">(</span><span class="m">0</span>.50<span class="o">)(</span>dyn<span class="o">)</span><span class="w">   </span><span class="p">|</span><span class="w">          </span><span class="m">0</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="o">[</span>Bx500<span class="o">]</span><span class="w">      </span><span class="p">|</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-6" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-6" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-6"></a><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">2</span><span class="w">     </span><span class="p">|</span><span class="w"> </span>Dense<span class="o">(</span>SIGMOID<span class="o">)</span><span class="w"> </span><span class="o">(</span>dyn<span class="o">)</span><span class="w"> </span><span class="p">|</span><span class="w">     </span><span class="m">125000</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="o">[</span>Bx250<span class="o">]</span><span class="w">      </span><span class="p">|</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-7" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-7" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-7"></a><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">3</span><span class="w">     </span><span class="p">|</span><span class="w"> </span>Dropout<span class="o">(</span><span class="m">0</span>.50<span class="o">)(</span>dyn<span class="o">)</span><span class="w">   </span><span class="p">|</span><span class="w">          </span><span class="m">0</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="o">[</span>Bx250<span class="o">]</span><span class="w">      </span><span class="p">|</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-8" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-8" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-8"></a><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">4</span><span class="w">     </span><span class="p">|</span><span class="w"> </span>Dense<span class="o">(</span>SOFTMAX<span class="o">)</span><span class="w"> </span><span class="o">(</span>dyn<span class="o">)</span><span class="w"> </span><span class="p">|</span><span class="w">       </span><span class="m">2500</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="o">[</span>Bx10<span class="o">]</span><span class="w">       </span><span class="p">|</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-9" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-9" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-9"></a><span class="w"> </span>------------------------------------------------------------
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-10" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-10" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-10"></a><span class="w">                </span>Total<span class="w"> </span>Parameters:<span class="w">     </span><span class="m">519500</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-11" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-11" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-11"></a>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-12" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-12" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-12"></a><span class="w"> </span>--------------------------------------------
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-13" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-13" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-13"></a><span class="w"> </span><span class="p">|</span><span class="w"> </span>mnist<span class="w"> </span><span class="p">|</span><span class="w"> </span>Size<span class="w">  </span><span class="p">|</span><span class="w"> </span>Batches<span class="w"> </span><span class="p">|</span><span class="w"> </span>Augmented<span class="w"> </span>Size<span class="w"> </span><span class="p">|</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-14" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-14" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-14"></a><span class="w"> </span>--------------------------------------------
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-15" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-15" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-15"></a><span class="w"> </span><span class="p">|</span><span class="w"> </span>train<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">60000</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">600</span><span class="w">     </span><span class="p">|</span><span class="w"> </span><span class="m">60000</span><span class="w">          </span><span class="p">|</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-16" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-16" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-16"></a><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="nb">test</span><span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">10000</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">100</span><span class="w">     </span><span class="p">|</span><span class="w"> </span><span class="m">10000</span><span class="w">          </span><span class="p">|</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-17" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-17" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-17"></a><span class="w"> </span>--------------------------------------------
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-18" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-18" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-18"></a>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-19" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-19" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-19"></a>Train<span class="w"> </span>the<span class="w"> </span>network<span class="w"> </span>with<span class="w"> </span><span class="s2">"Stochastic Gradient Descent"</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-20" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-20" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-20"></a><span class="w">    </span>Updater:<span class="w"> </span>NADAM
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-21" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-21" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-21"></a><span class="w">       </span>Loss:<span class="w"> </span>CATEGORICAL_CROSS_ENTROPY
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-22" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-22" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-22"></a><span class="w"> </span>Early<span class="w"> </span>Stop:<span class="w"> </span>Goal<span class="o">(</span>error<span class="o">)</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-23" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-23" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-23"></a>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-24" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-24" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-24"></a>With<span class="w"> </span>parameters:
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-25" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-25" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-25"></a><span class="w">          </span><span class="nv">epochs</span><span class="o">=</span><span class="m">50</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-26" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-26" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-26"></a><span class="w">      </span><span class="nv">batch_size</span><span class="o">=</span><span class="m">100</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-27" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-27" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-27"></a><span class="w">   </span><span class="nv">learning_rate</span><span class="o">=</span><span class="m">0</span>.002
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-28" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-28" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-28"></a><span class="w">           </span><span class="nv">beta1</span><span class="o">=</span><span class="m">0</span>.9
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-29" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-29" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-29"></a><span class="w">           </span><span class="nv">beta2</span><span class="o">=</span><span class="m">0</span>.999
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-30" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-30" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-30"></a>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-31" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-31" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-31"></a>epoch<span class="w">   </span><span class="m">0</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.04623<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.15097<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3230ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-32" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-32" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-32"></a>epoch<span class="w">   </span><span class="m">1</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.03013<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.09947<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3188ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-33" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-33" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-33"></a>epoch<span class="w">   </span><span class="m">2</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.02048<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.06565<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3102ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-34" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-34" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-34"></a>epoch<span class="w">   </span><span class="m">3</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.01593<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.05258<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3189ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-35" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-35" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-35"></a>epoch<span class="w">   </span><span class="m">4</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.01422<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.04623<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3160ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-36" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-36" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-36"></a>epoch<span class="w">   </span><span class="m">5</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.01112<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.03660<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3131ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-37" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-37" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-37"></a>epoch<span class="w">   </span><span class="m">6</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.01078<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.03546<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3200ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-38" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-38" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-38"></a>epoch<span class="w">   </span><span class="m">7</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.01003<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.03184<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3246ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-39" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-39" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-39"></a>epoch<span class="w">   </span><span class="m">8</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00778<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.02550<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3222ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-40" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-40" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-40"></a>epoch<span class="w">   </span><span class="m">9</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00782<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.02505<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3119ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-41" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-41" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-41"></a>epoch<span class="w">  </span><span class="m">10</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00578<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.02056<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3284ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-42" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-42" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-42"></a>epoch<span class="w">  </span><span class="m">11</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00618<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.02045<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3220ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-43" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-43" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-43"></a>epoch<span class="w">  </span><span class="m">12</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00538<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.01775<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3444ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-44" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-44" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-44"></a>epoch<span class="w">  </span><span class="m">13</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00563<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.01803<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3304ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-45" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-45" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-45"></a>epoch<span class="w">  </span><span class="m">14</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00458<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.01598<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3577ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-46" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-46" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-46"></a>epoch<span class="w">  </span><span class="m">15</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00437<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.01436<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3228ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-47" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-47" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-47"></a>epoch<span class="w">  </span><span class="m">16</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00360<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.01214<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3180ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-48" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-48" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-48"></a>epoch<span class="w">  </span><span class="m">17</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00405<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.01309<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3090ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-49" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-49" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-49"></a>epoch<span class="w">  </span><span class="m">18</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00408<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.01346<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3045ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-50" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-50" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-50"></a>epoch<span class="w">  </span><span class="m">19</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00337<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.01153<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3071ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-51" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-51" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-51"></a>epoch<span class="w">  </span><span class="m">20</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00297<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.01021<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3131ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-52" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-52" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-52"></a>epoch<span class="w">  </span><span class="m">21</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00318<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.01103<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3076ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-53" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-53" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-53"></a>epoch<span class="w">  </span><span class="m">22</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00277<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.00909<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3090ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-54" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-54" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-54"></a>epoch<span class="w">  </span><span class="m">23</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00242<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.00818<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3163ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-55" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-55" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-55"></a>epoch<span class="w">  </span><span class="m">24</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00267<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.00913<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3229ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-56" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-56" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-56"></a>epoch<span class="w">  </span><span class="m">25</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00295<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.00947<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3156ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-57" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-57" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-57"></a>epoch<span class="w">  </span><span class="m">26</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00252<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.00809<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3066ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-58" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-58" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-58"></a>epoch<span class="w">  </span><span class="m">27</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00227<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.00773<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3156ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-59" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-59" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-59"></a>epoch<span class="w">  </span><span class="m">28</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00203<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.00728<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3158ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-60" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-60" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-60"></a>epoch<span class="w">  </span><span class="m">29</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00240<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.00753<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3114ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-61" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-61" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-61"></a>epoch<span class="w">  </span><span class="m">30</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00263<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.00864<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3099ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-62" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-62" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-62"></a>epoch<span class="w">  </span><span class="m">31</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00210<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.00675<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3096ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-63" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-63" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-63"></a>epoch<span class="w">  </span><span class="m">32</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00163<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.00628<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3120ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-64" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-64" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-64"></a>epoch<span class="w">  </span><span class="m">33</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00182<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.00611<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3045ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-65" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-65" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-65"></a>epoch<span class="w">  </span><span class="m">34</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00125<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.00468<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3140ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-66" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-66" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-66"></a>epoch<span class="w">  </span><span class="m">35</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00183<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.00598<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3093ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-67" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-67" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-67"></a>epoch<span class="w">  </span><span class="m">36</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00232<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.00711<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3068ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-68" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-68" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-68"></a>epoch<span class="w">  </span><span class="m">37</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00170<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.00571<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3057ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-69" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-69" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-69"></a>epoch<span class="w">  </span><span class="m">38</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00162<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.00530<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3115ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-70" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-70" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-70"></a>epoch<span class="w">  </span><span class="m">39</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00155<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.00513<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3226ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-71" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-71" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-71"></a>epoch<span class="w">  </span><span class="m">40</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00150<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.00501<span class="w"> </span><span class="nb">time</span><span class="w"> </span>2987ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-72" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-72" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-72"></a>epoch<span class="w">  </span><span class="m">41</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00122<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.00425<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3117ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-73" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-73" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-73"></a>epoch<span class="w">  </span><span class="m">42</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00108<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.00383<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3102ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-74" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-74" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-74"></a>epoch<span class="w">  </span><span class="m">43</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00165<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.00533<span class="w"> </span><span class="nb">time</span><span class="w"> </span>2977ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-75" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-75" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-75"></a>epoch<span class="w">  </span><span class="m">44</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00142<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.00469<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3009ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-76" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-76" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-76"></a>epoch<span class="w">  </span><span class="m">45</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00098<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.00356<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3055ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-77" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-77" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-77"></a>epoch<span class="w">  </span><span class="m">46</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00127<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.00409<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3076ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-78" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-78" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-78"></a>epoch<span class="w">  </span><span class="m">47</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00132<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.00438<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3068ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-79" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-79" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-79"></a>epoch<span class="w">  </span><span class="m">48</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00130<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.00459<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3045ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-80" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-80" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-80"></a>epoch<span class="w">  </span><span class="m">49</span>/50<span class="w"> </span>batch<span class="w">  </span><span class="m">600</span>/<span class="w"> </span><span class="m">600</span><span class="w"> </span>-<span class="w"> </span>error:<span class="w"> </span><span class="m">0</span>.00107<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.00365<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3103ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-81" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-81" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-81"></a>Restore<span class="w"> </span>the<span class="w"> </span>best<span class="w"> </span><span class="o">(</span>error<span class="o">)</span><span class="w"> </span>weights<span class="w"> </span>from<span class="w"> </span>epoch<span class="w"> </span><span class="m">45</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-82" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-82" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-82"></a>Training<span class="w"> </span>took<span class="w"> </span>160s
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-83" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-83" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-83"></a>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-84" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-84" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-84"></a>Evaluation<span class="w"> </span>Results
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-85" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-85" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-85"></a><span class="w">   </span>error:<span class="w"> </span><span class="m">0</span>.01740
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-86" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-86" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-86"></a><span class="w">    </span>loss:<span class="w"> </span><span class="m">0</span>.07861
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-87" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-87" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-87"></a>evaluation<span class="w"> </span>took<span class="w"> </span>67ms
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-88" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-88" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-88"></a>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-89" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-89" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-89"></a><span class="w"> </span>-----------------------------------------------------------------------------
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-90" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-90" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-90"></a><span class="w"> </span><span class="p">|</span><span class="w"> </span>%<span class="w">        </span><span class="p">|</span><span class="w"> </span>Timer<span class="w">                         </span><span class="p">|</span><span class="w"> </span>Count<span class="w">  </span><span class="p">|</span><span class="w"> </span>Total<span class="w">     </span><span class="p">|</span><span class="w"> </span>Average<span class="w">   </span><span class="p">|</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-91" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-91" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-91"></a><span class="w"> </span>-----------------------------------------------------------------------------
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-92" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-92" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-92"></a><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">100</span>.000%<span class="w"> </span><span class="p">|</span><span class="w"> </span>net:train:ft<span class="w">                  </span><span class="p">|</span><span class="w"> </span><span class="m">1</span><span class="w">      </span><span class="p">|</span><span class="w"> </span><span class="m">160</span>.183s<span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">160</span>.183s<span class="w">  </span><span class="p">|</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-93" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-93" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-93"></a><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">100</span>.000%<span class="w"> </span><span class="p">|</span><span class="w"> </span>net:trainer:train<span class="w">             </span><span class="p">|</span><span class="w"> </span><span class="m">1</span><span class="w">      </span><span class="p">|</span><span class="w"> </span><span class="m">160</span>.183s<span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">160</span>.183s<span class="w">  </span><span class="p">|</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-94" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-94" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-94"></a><span class="w"> </span><span class="p">|</span><span class="w">  </span><span class="m">99</span>.997%<span class="w"> </span><span class="p">|</span><span class="w"> </span>net:trainer:train:epoch<span class="w">       </span><span class="p">|</span><span class="w"> </span><span class="m">50</span><span class="w">     </span><span class="p">|</span><span class="w"> </span><span class="m">160</span>.178s<span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">3</span>.20356s<span class="w">  </span><span class="p">|</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-95" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-95" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-95"></a><span class="w"> </span><span class="p">|</span><span class="w">  </span><span class="m">84</span>.422%<span class="w"> </span><span class="p">|</span><span class="w"> </span>net:trainer:train:epoch:batch<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">30000</span><span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">135</span>.229s<span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">4</span>.50764ms<span class="w"> </span><span class="p">|</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-96" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-96" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-96"></a><span class="w"> </span><span class="p">|</span><span class="w">  </span><span class="m">84</span>.261%<span class="w"> </span><span class="p">|</span><span class="w"> </span>sgd::train_batch<span class="w">              </span><span class="p">|</span><span class="w"> </span><span class="m">30000</span><span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">134</span>.971s<span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">4</span>.49904ms<span class="w"> </span><span class="p">|</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-97" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-97" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-97"></a><span class="w"> </span><span class="p">|</span><span class="w">  </span><span class="m">44</span>.404%<span class="w"> </span><span class="p">|</span><span class="w"> </span>sgd::grad<span class="w">                     </span><span class="p">|</span><span class="w"> </span><span class="m">30000</span><span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">71</span>.1271s<span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">2</span>.3709ms<span class="w">  </span><span class="p">|</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-98" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-98" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-98"></a><span class="w"> </span><span class="p">|</span><span class="w">  </span><span class="m">35</span>.453%<span class="w"> </span><span class="p">|</span><span class="w"> </span>sgd::forward<span class="w">                  </span><span class="p">|</span><span class="w"> </span><span class="m">30000</span><span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">56</span>.7893s<span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">1</span>.89298ms<span class="w"> </span><span class="p">|</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-99" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-99" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-99"></a><span class="w"> </span><span class="p">|</span><span class="w">  </span><span class="m">32</span>.245%<span class="w"> </span><span class="p">|</span><span class="w"> </span>sgd::update_weights<span class="w">           </span><span class="p">|</span><span class="w"> </span><span class="m">90000</span><span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">51</span>.6505s<span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">573</span>.894us<span class="w"> </span><span class="p">|</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-100" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-100" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-100"></a><span class="w"> </span><span class="p">|</span><span class="w">  </span><span class="m">32</span>.226%<span class="w"> </span><span class="p">|</span><span class="w"> </span>sgd::apply_grad:nadam<span class="w">         </span><span class="p">|</span><span class="w"> </span><span class="m">180000</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">51</span>.6211s<span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">286</span>.783us<span class="w"> </span><span class="p">|</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-101" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-101" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-101"></a><span class="w"> </span><span class="p">|</span><span class="w">  </span><span class="m">28</span>.399%<span class="w"> </span><span class="p">|</span><span class="w"> </span>dense:dyn:forward<span class="w">             </span><span class="p">|</span><span class="w"> </span><span class="m">180300</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">45</span>.4903s<span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">252</span>.303us<span class="w"> </span><span class="p">|</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-102" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-102" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-102"></a><span class="w"> </span><span class="p">|</span><span class="w">  </span><span class="m">17</span>.642%<span class="w"> </span><span class="p">|</span><span class="w"> </span>dropout:train:forward<span class="w">         </span><span class="p">|</span><span class="w"> </span><span class="m">60000</span><span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">28</span>.2595s<span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">470</span>.99us<span class="w">  </span><span class="p">|</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-103" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-103" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-103"></a><span class="w"> </span><span class="p">|</span><span class="w">  </span><span class="m">13</span>.707%<span class="w"> </span><span class="p">|</span><span class="w"> </span>net:trainer:train:epoch:error<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">50</span><span class="w">     </span><span class="p">|</span><span class="w"> </span><span class="m">21</span>.957s<span class="w">   </span><span class="p">|</span><span class="w"> </span><span class="m">439</span>.14ms<span class="w">  </span><span class="p">|</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-104" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-104" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-104"></a><span class="w"> </span><span class="p">|</span><span class="w">  </span><span class="m">12</span>.148%<span class="w"> </span><span class="p">|</span><span class="w"> </span>dense:dyn:gradients<span class="w">           </span><span class="p">|</span><span class="w"> </span><span class="m">90000</span><span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">19</span>.4587s<span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">216</span>.207us<span class="w"> </span><span class="p">|</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-105" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-105" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-105"></a><span class="w"> </span><span class="p">|</span><span class="w">   </span><span class="m">4</span>.299%<span class="w"> </span><span class="p">|</span><span class="w"> </span>sgd::backward<span class="w">                 </span><span class="p">|</span><span class="w"> </span><span class="m">30000</span><span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">6</span>.88546s<span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">229</span>.515us<span class="w"> </span><span class="p">|</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-106" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-106" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-106"></a><span class="w"> </span><span class="p">|</span><span class="w">   </span><span class="m">3</span>.301%<span class="w"> </span><span class="p">|</span><span class="w"> </span>dense:dyn:backward<span class="w">            </span><span class="p">|</span><span class="w"> </span><span class="m">60000</span><span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">5</span>.28729s<span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">88</span>.121us<span class="w">  </span><span class="p">|</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-107" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-107" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-107"></a><span class="w"> </span><span class="p">|</span><span class="w">   </span><span class="m">0</span>.560%<span class="w"> </span><span class="p">|</span><span class="w"> </span>dense:dyn:errors<span class="w">              </span><span class="p">|</span><span class="w"> </span><span class="m">60000</span><span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">896</span>.471ms<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">14</span>.941us<span class="w">  </span><span class="p">|</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-108" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-108" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-108"></a><span class="w"> </span><span class="p">|</span><span class="w">   </span><span class="m">0</span>.407%<span class="w"> </span><span class="p">|</span><span class="w"> </span>dropout:backward<span class="w">              </span><span class="p">|</span><span class="w"> </span><span class="m">60000</span><span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">651</span>.523ms<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">10</span>.858us<span class="w">  </span><span class="p">|</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-109" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-109" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-109"></a><span class="w"> </span><span class="p">|</span><span class="w">   </span><span class="m">0</span>.339%<span class="w"> </span><span class="p">|</span><span class="w"> </span>dropout:test:forward<span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">60000</span><span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">542</span>.799ms<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">9</span>.046us<span class="w">   </span><span class="p">|</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-110" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-110" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-110"></a><span class="w"> </span><span class="p">|</span><span class="w">   </span><span class="m">0</span>.161%<span class="w"> </span><span class="p">|</span><span class="w"> </span>net:compute_loss:CCE<span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">60100</span><span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">257</span>.915ms<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">4</span>.291us<span class="w">   </span><span class="p">|</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-111" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-111" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-111"></a><span class="w"> </span><span class="p">|</span><span class="w">   </span><span class="m">0</span>.099%<span class="w"> </span><span class="p">|</span><span class="w"> </span>sgd::error<span class="w">                    </span><span class="p">|</span><span class="w"> </span><span class="m">30000</span><span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">158</span>.33ms<span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">5</span>.277us<span class="w">   </span><span class="p">|</span>
<a id="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-112" name="rest_code_a4eb5363ffd84e2ca7c494dde292f59b-112" href="posts/2017/11/dll-pretty-printing-and-live-output.html#rest_code_a4eb5363ffd84e2ca7c494dde292f59b-112"></a><span class="w"> </span>-----------------------------------------------------------------------------
</pre></div>
<p>I hope this will make the output of the machine learning framework more useful.</p>
<p>All this support is now in the <strong>master</strong> branch of the DLL project if you want
to check it out. You can also check out the example online:
<a class="reference external" href="https://github.com/wichtounet/dll/blob/master/examples/src/mnist_mlp.cpp">mnist_mlp.cpp</a></p>
<p>You can access the project <a class="reference external" href="https://github.com/wichtounet/dll">on Github</a>.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/2017/11/inventor-on-four-new-research-patents.html" class="u-url">Inventor on four new research patents</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Baptiste Wicht
            </span></p>
            <p class="dateline">
            <a href="posts/2017/11/inventor-on-four-new-research-patents.html" rel="bookmark">
            <time class="published dt-published" datetime="2017-11-17T14:50:33+01:00" itemprop="datePublished" title="2017-11-17 14:50">2017-11-17 14:50</time></a>
            </p>
                <p class="commentline">
    
    <a href="posts/2017/11/inventor-on-four-new-research-patents.html#disqus_thread" data-disqus-identifier="cache/posts/2017/11/inventor-on-four-new-research-patents.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <p>During the first years of my thesis I worked on CTI research project with the
American company Verisign, which has also an office near my school. A CTI
research project is a project that is partially funded by the Commission on
Innovation and Technology (CTI) where a school and a company work together.
I was quite lucky to work on this project with the awesome people at Verisign
Fribourg. After the success of the project, Verisign filled several patents
regarding various points of the projects.</p>
<p>I'm quite happy now that these four patents are now approved and published. They
They have been approved by both the United States Patent and Trademark Office
(USPTO) and European Patent Office (EPO). The parents have been cl= aimed by
Verisign, I'm only one of the inventor, I got no claim on the patent. But it's
still a great thing.</p>
<p>Here are the names of the four patents:</p>
<ul class="simple">
<li><p>Systems and methods for automatic phonetization of domain names</p></li>
<li><p>Construction of phonetic representation of a string of characters</p></li>
<li><p>Method for writing a foreign language in a pseudo language phonetically resembling native language of the speaker</p></li>
<li><p>Construction of a phonetic representation of a generated string of characters</p></li>
</ul>
<p>You can take a look at them on USPTO or EPO or on Google Patents, but the way
a patent is written make it relatively hard to follow, it's more on a lawyer
level or maybe I'm simply not used to patents anymore.</p>
<p>All these patents come from the research done during the CTI project with
Verisign. In this project, name suggestions were generated from the phonetic
sound of the name. The idea being to generate names that sounds the same as
another input (airmix could become rmix or rmics). We are using various
technologies to make this work: IG-Tree, Viterbi and HMM. And since we used
a model with an encoder and a decoder, we can also mix languages. For instance,
write something in French the way a English work would work (for instance school
could become scoule).</p>
<p>These patents concludes a very interesting and successful project. I'm now
working on yet another CTI research project with Verisign and it will surely be
as successful as the first one.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html" class="u-url">Initial support for Recurrent Neural Network (RNN) in DLL</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Baptiste Wicht
            </span></p>
            <p class="dateline">
            <a href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html" rel="bookmark">
            <time class="published dt-published" datetime="2017-11-12T15:22:44+01:00" itemprop="datePublished" title="2017-11-12 15:22">2017-11-12 15:22</time></a>
            </p>
                <p class="commentline">
    
    <a href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#disqus_thread" data-disqus-identifier="cache/posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <p>I'm happy to announce that I just merged support for Recurrent Neural Networks
(RNNs) into my Deep Learning Library (DLL) machine learning framework.</p>
<p>It's nothing fancy yet, but forward propagation of RNN and basic Backpropagation
Through Time (BPTT) are now supported. For now, only existing classification
loss is supported for RNN. I plan to add support for sequence-to-sequence loss
in order to be able to train models able to generate characters, but I don't
know when I'll be able to work on that. I also plan to add support for other
types of cells such as LSTM and GRU (maybe NAS) in the future.</p>
<p>For example, here is a simple RNN used on MNIST:</p>
<div class="code"><pre class="code cpp"><a id="rest_code_6e5027f012c44432b630980305b6b6ad-1" name="rest_code_6e5027f012c44432b630980305b6b6ad-1" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">"dll/neural/dense_layer.hpp"</span>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-2" name="rest_code_6e5027f012c44432b630980305b6b6ad-2" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-2"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">"dll/neural/recurrent_layer.hpp"</span>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-3" name="rest_code_6e5027f012c44432b630980305b6b6ad-3" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-3"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">"dll/neural/recurrent_last_layer.hpp"</span>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-4" name="rest_code_6e5027f012c44432b630980305b6b6ad-4" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-4"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">"dll/network.hpp"</span>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-5" name="rest_code_6e5027f012c44432b630980305b6b6ad-5" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-5"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">"dll/datasets.hpp"</span>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-6" name="rest_code_6e5027f012c44432b630980305b6b6ad-6" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-6"></a>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-7" name="rest_code_6e5027f012c44432b630980305b6b6ad-7" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-7"></a><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="cm">/*argc*/</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="cm">/*argv*/</span><span class="w"> </span><span class="p">[])</span><span class="w"> </span><span class="p">{</span>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-8" name="rest_code_6e5027f012c44432b630980305b6b6ad-8" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-8"></a><span class="w">    </span><span class="c1">// Load the dataset</span>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-9" name="rest_code_6e5027f012c44432b630980305b6b6ad-9" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-9"></a><span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">dataset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dll</span><span class="o">::</span><span class="n">make_mnist_dataset_nc</span><span class="p">(</span><span class="n">dll</span><span class="o">::</span><span class="n">batch_size</span><span class="o">&lt;</span><span class="mi">100</span><span class="o">&gt;</span><span class="p">{},</span><span class="w"> </span><span class="n">dll</span><span class="o">::</span><span class="n">scale_pre</span><span class="o">&lt;</span><span class="mi">255</span><span class="o">&gt;</span><span class="p">{});</span>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-10" name="rest_code_6e5027f012c44432b630980305b6b6ad-10" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-10"></a>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-11" name="rest_code_6e5027f012c44432b630980305b6b6ad-11" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-11"></a><span class="w">    </span><span class="k">constexpr</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">time_steps</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="mi">28</span><span class="p">;</span>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-12" name="rest_code_6e5027f012c44432b630980305b6b6ad-12" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-12"></a><span class="w">    </span><span class="k">constexpr</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">sequence_length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">28</span><span class="p">;</span>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-13" name="rest_code_6e5027f012c44432b630980305b6b6ad-13" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-13"></a><span class="w">    </span><span class="k">constexpr</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">hidden_units</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-14" name="rest_code_6e5027f012c44432b630980305b6b6ad-14" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-14"></a>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-15" name="rest_code_6e5027f012c44432b630980305b6b6ad-15" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-15"></a><span class="w">    </span><span class="c1">// Build the network</span>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-16" name="rest_code_6e5027f012c44432b630980305b6b6ad-16" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-16"></a>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-17" name="rest_code_6e5027f012c44432b630980305b6b6ad-17" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-17"></a><span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">network_t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dll</span><span class="o">::</span><span class="n">dyn_network_desc</span><span class="o">&lt;</span>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-18" name="rest_code_6e5027f012c44432b630980305b6b6ad-18" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-18"></a><span class="w">        </span><span class="n">dll</span><span class="o">::</span><span class="n">network_layers</span><span class="o">&lt;</span>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-19" name="rest_code_6e5027f012c44432b630980305b6b6ad-19" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-19"></a><span class="w">            </span><span class="n">dll</span><span class="o">::</span><span class="n">recurrent_layer</span><span class="o">&lt;</span><span class="n">time_steps</span><span class="p">,</span><span class="w"> </span><span class="n">sequence_length</span><span class="p">,</span><span class="w"> </span><span class="n">hidden_units</span><span class="p">,</span><span class="w"> </span><span class="n">dll</span><span class="o">::</span><span class="n">last_only</span><span class="o">&gt;</span><span class="p">,</span>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-20" name="rest_code_6e5027f012c44432b630980305b6b6ad-20" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-20"></a><span class="w">            </span><span class="n">dll</span><span class="o">::</span><span class="n">recurrent_last_layer</span><span class="o">&lt;</span><span class="n">time_steps</span><span class="p">,</span><span class="w"> </span><span class="n">hidden_units</span><span class="o">&gt;</span><span class="p">,</span>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-21" name="rest_code_6e5027f012c44432b630980305b6b6ad-21" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-21"></a><span class="w">            </span><span class="n">dll</span><span class="o">::</span><span class="n">dense_layer</span><span class="o">&lt;</span><span class="n">hidden_units</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">dll</span><span class="o">::</span><span class="n">softmax</span><span class="o">&gt;</span>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-22" name="rest_code_6e5027f012c44432b630980305b6b6ad-22" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-22"></a><span class="w">        </span><span class="o">&gt;</span>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-23" name="rest_code_6e5027f012c44432b630980305b6b6ad-23" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-23"></a><span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="n">dll</span><span class="o">::</span><span class="n">updater</span><span class="o">&lt;</span><span class="n">dll</span><span class="o">::</span><span class="n">updater_type</span><span class="o">::</span><span class="n">ADAM</span><span class="o">&gt;</span><span class="w">      </span><span class="c1">// Adam</span>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-24" name="rest_code_6e5027f012c44432b630980305b6b6ad-24" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-24"></a><span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="n">dll</span><span class="o">::</span><span class="n">batch_size</span><span class="o">&lt;</span><span class="mi">100</span><span class="o">&gt;</span><span class="w">                       </span><span class="c1">// The mini-batch size</span>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-25" name="rest_code_6e5027f012c44432b630980305b6b6ad-25" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-25"></a><span class="w">    </span><span class="o">&gt;::</span><span class="n">network_t</span><span class="p">;</span>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-26" name="rest_code_6e5027f012c44432b630980305b6b6ad-26" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-26"></a>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-27" name="rest_code_6e5027f012c44432b630980305b6b6ad-27" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-27"></a><span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">net</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">network_t</span><span class="o">&gt;</span><span class="p">();</span>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-28" name="rest_code_6e5027f012c44432b630980305b6b6ad-28" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-28"></a>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-29" name="rest_code_6e5027f012c44432b630980305b6b6ad-29" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-29"></a><span class="w">    </span><span class="c1">// Display the network and dataset</span>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-30" name="rest_code_6e5027f012c44432b630980305b6b6ad-30" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-30"></a><span class="w">    </span><span class="n">net</span><span class="o">-&gt;</span><span class="n">display</span><span class="p">();</span>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-31" name="rest_code_6e5027f012c44432b630980305b6b6ad-31" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-31"></a>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-32" name="rest_code_6e5027f012c44432b630980305b6b6ad-32" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-32"></a><span class="w">    </span><span class="c1">// Train the network for performance sake</span>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-33" name="rest_code_6e5027f012c44432b630980305b6b6ad-33" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-33"></a><span class="w">    </span><span class="n">net</span><span class="o">-&gt;</span><span class="n">fine_tune</span><span class="p">(</span><span class="n">dataset</span><span class="p">.</span><span class="n">train</span><span class="p">(),</span><span class="w"> </span><span class="mi">50</span><span class="p">);</span>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-34" name="rest_code_6e5027f012c44432b630980305b6b6ad-34" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-34"></a>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-35" name="rest_code_6e5027f012c44432b630980305b6b6ad-35" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-35"></a><span class="w">    </span><span class="c1">// Test the network on test set</span>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-36" name="rest_code_6e5027f012c44432b630980305b6b6ad-36" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-36"></a><span class="w">    </span><span class="n">net</span><span class="o">-&gt;</span><span class="n">evaluate</span><span class="p">(</span><span class="n">dataset</span><span class="p">.</span><span class="n">test</span><span class="p">());</span>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-37" name="rest_code_6e5027f012c44432b630980305b6b6ad-37" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-37"></a>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-38" name="rest_code_6e5027f012c44432b630980305b6b6ad-38" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-38"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="rest_code_6e5027f012c44432b630980305b6b6ad-39" name="rest_code_6e5027f012c44432b630980305b6b6ad-39" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_6e5027f012c44432b630980305b6b6ad-39"></a><span class="p">}</span>
</pre></div>
<p>The network starts with recurrent layer, followed by a layer that extracts only
the last layer and finally a dense layer with a softmax function. The recurrent
layer has support to change the activation function, change the initializer for
the two weights matrices of the RNN and the number of steps for BPTT truncation.</p>
<p>Here is a possible result:</p>
<div class="code"><pre class="code text"><a id="rest_code_4d50bad669254d0099b32c54af9467fd-1" name="rest_code_4d50bad669254d0099b32c54af9467fd-1" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-1"></a>Network with 3 layers
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-2" name="rest_code_4d50bad669254d0099b32c54af9467fd-2" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-2"></a>    RNN(dyn): 28x28 -&gt; TANH -&gt; 28x100
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-3" name="rest_code_4d50bad669254d0099b32c54af9467fd-3" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-3"></a>    RNN(last): 28x100 -&gt; 100
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-4" name="rest_code_4d50bad669254d0099b32c54af9467fd-4" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-4"></a>    Dense(dyn): 100 -&gt; SOFTMAX -&gt; 10
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-5" name="rest_code_4d50bad669254d0099b32c54af9467fd-5" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-5"></a>Total parameters: 13800
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-6" name="rest_code_4d50bad669254d0099b32c54af9467fd-6" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-6"></a>Train the network with "Stochastic Gradient Descent"
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-7" name="rest_code_4d50bad669254d0099b32c54af9467fd-7" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-7"></a>    Updater: ADAM
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-8" name="rest_code_4d50bad669254d0099b32c54af9467fd-8" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-8"></a>       Loss: CATEGORICAL_CROSS_ENTROPY
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-9" name="rest_code_4d50bad669254d0099b32c54af9467fd-9" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-9"></a> Early Stop: Goal(error)
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-10" name="rest_code_4d50bad669254d0099b32c54af9467fd-10" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-10"></a>
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-11" name="rest_code_4d50bad669254d0099b32c54af9467fd-11" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-11"></a>With parameters:
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-12" name="rest_code_4d50bad669254d0099b32c54af9467fd-12" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-12"></a>          epochs=50
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-13" name="rest_code_4d50bad669254d0099b32c54af9467fd-13" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-13"></a>      batch_size=100
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-14" name="rest_code_4d50bad669254d0099b32c54af9467fd-14" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-14"></a>   learning_rate=0.001
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-15" name="rest_code_4d50bad669254d0099b32c54af9467fd-15" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-15"></a>           beta1=0.9
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-16" name="rest_code_4d50bad669254d0099b32c54af9467fd-16" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-16"></a>           beta2=0.999
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-17" name="rest_code_4d50bad669254d0099b32c54af9467fd-17" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-17"></a>
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-18" name="rest_code_4d50bad669254d0099b32c54af9467fd-18" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-18"></a>Epoch   0/50 - Classification error: 0.11635 Loss: 0.39999 Time 4717ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-19" name="rest_code_4d50bad669254d0099b32c54af9467fd-19" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-19"></a>Epoch   1/50 - Classification error: 0.11303 Loss: 0.36994 Time 4702ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-20" name="rest_code_4d50bad669254d0099b32c54af9467fd-20" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-20"></a>Epoch   2/50 - Classification error: 0.06732 Loss: 0.23469 Time 4702ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-21" name="rest_code_4d50bad669254d0099b32c54af9467fd-21" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-21"></a>Epoch   3/50 - Classification error: 0.04865 Loss: 0.17091 Time 4696ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-22" name="rest_code_4d50bad669254d0099b32c54af9467fd-22" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-22"></a>Epoch   4/50 - Classification error: 0.05957 Loss: 0.20437 Time 4706ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-23" name="rest_code_4d50bad669254d0099b32c54af9467fd-23" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-23"></a>Epoch   5/50 - Classification error: 0.05022 Loss: 0.16888 Time 4696ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-24" name="rest_code_4d50bad669254d0099b32c54af9467fd-24" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-24"></a>Epoch   6/50 - Classification error: 0.03912 Loss: 0.13743 Time 4698ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-25" name="rest_code_4d50bad669254d0099b32c54af9467fd-25" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-25"></a>Epoch   7/50 - Classification error: 0.04097 Loss: 0.14509 Time 4706ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-26" name="rest_code_4d50bad669254d0099b32c54af9467fd-26" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-26"></a>Epoch   8/50 - Classification error: 0.03938 Loss: 0.13397 Time 4694ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-27" name="rest_code_4d50bad669254d0099b32c54af9467fd-27" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-27"></a>Epoch   9/50 - Classification error: 0.03525 Loss: 0.12284 Time 4706ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-28" name="rest_code_4d50bad669254d0099b32c54af9467fd-28" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-28"></a>Epoch  10/50 - Classification error: 0.03927 Loss: 0.13770 Time 4694ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-29" name="rest_code_4d50bad669254d0099b32c54af9467fd-29" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-29"></a>Epoch  11/50 - Classification error: 0.03315 Loss: 0.11315 Time 4711ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-30" name="rest_code_4d50bad669254d0099b32c54af9467fd-30" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-30"></a>Epoch  12/50 - Classification error: 0.05037 Loss: 0.17123 Time 4711ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-31" name="rest_code_4d50bad669254d0099b32c54af9467fd-31" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-31"></a>Epoch  13/50 - Classification error: 0.02927 Loss: 0.10042 Time 4780ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-32" name="rest_code_4d50bad669254d0099b32c54af9467fd-32" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-32"></a>Epoch  14/50 - Classification error: 0.03322 Loss: 0.11027 Time 4746ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-33" name="rest_code_4d50bad669254d0099b32c54af9467fd-33" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-33"></a>Epoch  15/50 - Classification error: 0.03397 Loss: 0.11585 Time 4684ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-34" name="rest_code_4d50bad669254d0099b32c54af9467fd-34" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-34"></a>Epoch  16/50 - Classification error: 0.02938 Loss: 0.09984 Time 4708ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-35" name="rest_code_4d50bad669254d0099b32c54af9467fd-35" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-35"></a>Epoch  17/50 - Classification error: 0.03262 Loss: 0.11152 Time 4690ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-36" name="rest_code_4d50bad669254d0099b32c54af9467fd-36" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-36"></a>Epoch  18/50 - Classification error: 0.02872 Loss: 0.09753 Time 4672ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-37" name="rest_code_4d50bad669254d0099b32c54af9467fd-37" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-37"></a>Epoch  19/50 - Classification error: 0.02548 Loss: 0.08605 Time 4691ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-38" name="rest_code_4d50bad669254d0099b32c54af9467fd-38" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-38"></a>Epoch  20/50 - Classification error: 0.02245 Loss: 0.07797 Time 4693ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-39" name="rest_code_4d50bad669254d0099b32c54af9467fd-39" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-39"></a>Epoch  21/50 - Classification error: 0.02705 Loss: 0.08984 Time 4684ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-40" name="rest_code_4d50bad669254d0099b32c54af9467fd-40" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-40"></a>Epoch  22/50 - Classification error: 0.02422 Loss: 0.08164 Time 4688ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-41" name="rest_code_4d50bad669254d0099b32c54af9467fd-41" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-41"></a>Epoch  23/50 - Classification error: 0.02645 Loss: 0.08804 Time 4690ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-42" name="rest_code_4d50bad669254d0099b32c54af9467fd-42" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-42"></a>Epoch  24/50 - Classification error: 0.02927 Loss: 0.09739 Time 4715ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-43" name="rest_code_4d50bad669254d0099b32c54af9467fd-43" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-43"></a>Epoch  25/50 - Classification error: 0.02578 Loss: 0.08669 Time 4702ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-44" name="rest_code_4d50bad669254d0099b32c54af9467fd-44" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-44"></a>Epoch  26/50 - Classification error: 0.02785 Loss: 0.09368 Time 4700ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-45" name="rest_code_4d50bad669254d0099b32c54af9467fd-45" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-45"></a>Epoch  27/50 - Classification error: 0.02472 Loss: 0.08237 Time 4695ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-46" name="rest_code_4d50bad669254d0099b32c54af9467fd-46" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-46"></a>Epoch  28/50 - Classification error: 0.02125 Loss: 0.07324 Time 4690ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-47" name="rest_code_4d50bad669254d0099b32c54af9467fd-47" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-47"></a>Epoch  29/50 - Classification error: 0.01977 Loss: 0.06635 Time 4688ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-48" name="rest_code_4d50bad669254d0099b32c54af9467fd-48" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-48"></a>Epoch  30/50 - Classification error: 0.03635 Loss: 0.12140 Time 4689ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-49" name="rest_code_4d50bad669254d0099b32c54af9467fd-49" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-49"></a>Epoch  31/50 - Classification error: 0.02862 Loss: 0.09704 Time 4698ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-50" name="rest_code_4d50bad669254d0099b32c54af9467fd-50" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-50"></a>Epoch  32/50 - Classification error: 0.02463 Loss: 0.08158 Time 4686ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-51" name="rest_code_4d50bad669254d0099b32c54af9467fd-51" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-51"></a>Epoch  33/50 - Classification error: 0.02565 Loss: 0.08771 Time 4697ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-52" name="rest_code_4d50bad669254d0099b32c54af9467fd-52" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-52"></a>Epoch  34/50 - Classification error: 0.02278 Loss: 0.07634 Time 4718ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-53" name="rest_code_4d50bad669254d0099b32c54af9467fd-53" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-53"></a>Epoch  35/50 - Classification error: 0.02105 Loss: 0.07075 Time 4697ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-54" name="rest_code_4d50bad669254d0099b32c54af9467fd-54" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-54"></a>Epoch  36/50 - Classification error: 0.02770 Loss: 0.09358 Time 4711ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-55" name="rest_code_4d50bad669254d0099b32c54af9467fd-55" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-55"></a>Epoch  37/50 - Classification error: 0.02627 Loss: 0.08805 Time 4742ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-56" name="rest_code_4d50bad669254d0099b32c54af9467fd-56" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-56"></a>Epoch  38/50 - Classification error: 0.02282 Loss: 0.07712 Time 4708ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-57" name="rest_code_4d50bad669254d0099b32c54af9467fd-57" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-57"></a>Epoch  39/50 - Classification error: 0.02305 Loss: 0.07661 Time 4697ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-58" name="rest_code_4d50bad669254d0099b32c54af9467fd-58" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-58"></a>Epoch  40/50 - Classification error: 0.02243 Loss: 0.07773 Time 4700ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-59" name="rest_code_4d50bad669254d0099b32c54af9467fd-59" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-59"></a>Epoch  41/50 - Classification error: 0.02467 Loss: 0.08234 Time 4712ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-60" name="rest_code_4d50bad669254d0099b32c54af9467fd-60" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-60"></a>Epoch  42/50 - Classification error: 0.01808 Loss: 0.06186 Time 4691ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-61" name="rest_code_4d50bad669254d0099b32c54af9467fd-61" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-61"></a>Epoch  43/50 - Classification error: 0.02388 Loss: 0.07917 Time 4681ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-62" name="rest_code_4d50bad669254d0099b32c54af9467fd-62" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-62"></a>Epoch  44/50 - Classification error: 0.02162 Loss: 0.07508 Time 4699ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-63" name="rest_code_4d50bad669254d0099b32c54af9467fd-63" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-63"></a>Epoch  45/50 - Classification error: 0.01877 Loss: 0.06289 Time 4735ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-64" name="rest_code_4d50bad669254d0099b32c54af9467fd-64" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-64"></a>Epoch  46/50 - Classification error: 0.02263 Loss: 0.07969 Time 4764ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-65" name="rest_code_4d50bad669254d0099b32c54af9467fd-65" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-65"></a>Epoch  47/50 - Classification error: 0.02100 Loss: 0.07207 Time 4684ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-66" name="rest_code_4d50bad669254d0099b32c54af9467fd-66" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-66"></a>Epoch  48/50 - Classification error: 0.02425 Loss: 0.08076 Time 4752ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-67" name="rest_code_4d50bad669254d0099b32c54af9467fd-67" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-67"></a>Epoch  49/50 - Classification error: 0.02328 Loss: 0.07803 Time 4718ms
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-68" name="rest_code_4d50bad669254d0099b32c54af9467fd-68" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-68"></a>Restore the best (error) weights from epoch 42
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-69" name="rest_code_4d50bad669254d0099b32c54af9467fd-69" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-69"></a>Training took 235s
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-70" name="rest_code_4d50bad669254d0099b32c54af9467fd-70" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-70"></a>Evaluation Results
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-71" name="rest_code_4d50bad669254d0099b32c54af9467fd-71" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-71"></a>   error: 0.03000
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-72" name="rest_code_4d50bad669254d0099b32c54af9467fd-72" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-72"></a>    loss: 0.12260
<a id="rest_code_4d50bad669254d0099b32c54af9467fd-73" name="rest_code_4d50bad669254d0099b32c54af9467fd-73" href="posts/2017/11/initial-support-for-recurrent-neural-network-rnn-in-dll.html#rest_code_4d50bad669254d0099b32c54af9467fd-73"></a>evaluation took 245ms
</pre></div>
<p>Nothing fancy, but this example is not necessarily optimized.</p>
<p>All this support is now in the <strong>master</strong> branch of the DLL project if you want
to check it out. You can also check out the example online:
<a class="reference external" href="https://github.com/wichtounet/dll/blob/master/examples/src/mnist_rnn.cpp">mnist_rnn.cpp</a></p>
<p>You can access the project <a class="reference external" href="https://github.com/wichtounet/dll">on Github</a>.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html" class="u-url">DLL New Features: Embeddings and Merge layers</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Baptiste Wicht
            </span></p>
            <p class="dateline">
            <a href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html" rel="bookmark">
            <time class="published dt-published" datetime="2017-10-17T19:50:40+02:00" itemprop="datePublished" title="2017-10-17 19:50">2017-10-17 19:50</time></a>
            </p>
                <p class="commentline">
    
    <a href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#disqus_thread" data-disqus-identifier="cache/posts/2017/10/dll-new-features-embeddings-and-merge-layers.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <p>I've just finished integrating new features into DLL, my deep learning library.
I've added support for an embeddings layer, a group layer and a merge layer.
This is not yet released, but available in the master branch.</p>
<p>Embeddings are used more and more these days to learn dense representation of
characters or word. An embedding layer in a neural network transform labels into
a vector. It's generally used as the first layer of the network. The embedding
are learned as part of the network.</p>
<p>The merge layer allows to create branches in the network. The input is passed to
each sub layer and then the output of each layer is concatenated to form the
output of the merged layers. This can be very useful to use different
convolutional filter sizes.</p>
<p>The group layer is a simple utility to group layers together. This is mostly to
use with merge layers to form several branches.</p>
<p>I've put together a new example to use these features on text classification.
The dataset is totally synthetic for now, but this can easily be reproduced with
a normal text classification dataset. This kind of model is called a Character
Convolutional Neural Network.</p>
<p>Here is the code for example:</p>
<div class="code"><pre class="code cpp"><a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-1" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-1" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-1"></a><span class="k">constexpr</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">embedding</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">16</span><span class="p">;</span><span class="w"> </span><span class="c1">// The length of the embedding vector</span>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-2" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-2" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-2"></a><span class="k">constexpr</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">15</span><span class="p">;</span><span class="w">    </span><span class="c1">// The word (or sequence) length</span>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-3" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-3" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-3"></a>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-4" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-4" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-4"></a><span class="k">using</span><span class="w"> </span><span class="n">embedding_network_t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dll</span><span class="o">::</span><span class="n">dyn_network_desc</span><span class="o">&lt;</span>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-5" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-5" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-5"></a><span class="w">    </span><span class="n">dll</span><span class="o">::</span><span class="n">network_layers</span><span class="o">&lt;</span>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-6" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-6" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-6"></a><span class="w">        </span><span class="c1">// The embedding layer</span>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-7" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-7" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-7"></a><span class="w">        </span><span class="n">dll</span><span class="o">::</span><span class="n">embedding_layer</span><span class="o">&lt;</span><span class="mi">26</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"> </span><span class="n">embedding</span><span class="o">&gt;</span>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-8" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-8" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-8"></a>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-9" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-9" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-9"></a><span class="w">        </span><span class="c1">// The convolutional layers</span>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-10" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-10" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-10"></a><span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="n">dll</span><span class="o">::</span><span class="n">merge_layer</span><span class="o">&lt;</span>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-11" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-11" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-11"></a><span class="w">            </span><span class="mi">0</span>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-12" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-12" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-12"></a><span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="n">dll</span><span class="o">::</span><span class="n">group_layer</span><span class="o">&lt;</span>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-13" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-13" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-13"></a><span class="w">                  </span><span class="n">dll</span><span class="o">::</span><span class="n">conv_layer</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"> </span><span class="n">embedding</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">embedding</span><span class="o">&gt;</span>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-14" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-14" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-14"></a><span class="w">                </span><span class="p">,</span><span class="w"> </span><span class="n">dll</span><span class="o">::</span><span class="n">mp_2d_layer</span><span class="o">&lt;</span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="o">&gt;</span>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-15" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-15" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-15"></a><span class="w">            </span><span class="o">&gt;</span>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-16" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-16" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-16"></a><span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="n">dll</span><span class="o">::</span><span class="n">group_layer</span><span class="o">&lt;</span>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-17" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-17" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-17"></a><span class="w">                  </span><span class="n">dll</span><span class="o">::</span><span class="n">conv_layer</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"> </span><span class="n">embedding</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">embedding</span><span class="o">&gt;</span>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-18" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-18" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-18"></a><span class="w">                </span><span class="p">,</span><span class="w"> </span><span class="n">dll</span><span class="o">::</span><span class="n">mp_2d_layer</span><span class="o">&lt;</span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="o">&gt;</span>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-19" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-19" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-19"></a><span class="w">            </span><span class="o">&gt;</span>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-20" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-20" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-20"></a><span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="n">dll</span><span class="o">::</span><span class="n">group_layer</span><span class="o">&lt;</span>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-21" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-21" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-21"></a><span class="w">                  </span><span class="n">dll</span><span class="o">::</span><span class="n">conv_layer</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"> </span><span class="n">embedding</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="n">embedding</span><span class="o">&gt;</span>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-22" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-22" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-22"></a><span class="w">                </span><span class="p">,</span><span class="w"> </span><span class="n">dll</span><span class="o">::</span><span class="n">mp_2d_layer</span><span class="o">&lt;</span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="o">&gt;</span>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-23" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-23" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-23"></a><span class="w">            </span><span class="o">&gt;</span>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-24" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-24" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-24"></a><span class="w">        </span><span class="o">&gt;</span>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-25" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-25" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-25"></a>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-26" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-26" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-26"></a><span class="w">        </span><span class="c1">// The final softmax layer</span>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-27" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-27" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-27"></a><span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="n">dll</span><span class="o">::</span><span class="n">dense_layer</span><span class="o">&lt;</span><span class="mi">48</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">dll</span><span class="o">::</span><span class="n">softmax</span><span class="o">&gt;</span>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-28" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-28" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-28"></a><span class="w">    </span><span class="o">&gt;</span>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-29" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-29" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-29"></a><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">dll</span><span class="o">::</span><span class="n">updater</span><span class="o">&lt;</span><span class="n">dll</span><span class="o">::</span><span class="n">updater_type</span><span class="o">::</span><span class="n">NADAM</span><span class="o">&gt;</span><span class="w">     </span><span class="c1">// Nesterov Adam (NADAM)</span>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-30" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-30" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-30"></a><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">dll</span><span class="o">::</span><span class="n">batch_size</span><span class="o">&lt;</span><span class="mi">50</span><span class="o">&gt;</span><span class="w">                        </span><span class="c1">// The mini-batch size</span>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-31" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-31" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-31"></a><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">dll</span><span class="o">::</span><span class="n">shuffle</span><span class="w">                               </span><span class="c1">// Shuffle before each epoch</span>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-32" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-32" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-32"></a><span class="o">&gt;::</span><span class="n">network_t</span><span class="p">;</span>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-33" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-33" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-33"></a>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-34" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-34" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-34"></a><span class="k">auto</span><span class="w"> </span><span class="n">net</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">embedding_network_t</span><span class="o">&gt;</span><span class="p">();</span>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-35" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-35" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-35"></a>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-36" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-36" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-36"></a><span class="c1">// Display the network and dataset</span>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-37" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-37" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-37"></a><span class="n">net</span><span class="o">-&gt;</span><span class="n">display</span><span class="p">();</span>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-38" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-38" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-38"></a>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-39" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-39" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-39"></a><span class="c1">// Train the network for performance sake</span>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-40" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-40" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-40"></a><span class="n">net</span><span class="o">-&gt;</span><span class="n">fine_tune</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">);</span>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-41" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-41" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-41"></a>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-42" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-42" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-42"></a><span class="c1">// Test the network on train set</span>
<a id="rest_code_fdf62a81a8bd41869210c261c9e05c4e-43" name="rest_code_fdf62a81a8bd41869210c261c9e05c4e-43" href="posts/2017/10/dll-new-features-embeddings-and-merge-layers.html#rest_code_fdf62a81a8bd41869210c261c9e05c4e-43"></a><span class="n">net</span><span class="o">-&gt;</span><span class="n">evaluate</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="p">);</span>
</pre></div>
<p>The network starts with an embedding layer. The embedding is then passed to
three convolutional layers with different filter sizes, each followed by
a pooling layer. The outputs of the three layers are merged at the end of the
merge layer. Finally, a softmax layer is used for classification.</p>
<p>This kind of model can be very powerful and is used regularly. These new
features make for a much larger variety of models that can be build with the DLL
library.</p>
<p>The full code with the dataset generation can be found online:
<a class="reference external" href="https://github.com/wichtounet/dll/blob/master/examples/src/char_cnn.cpp">char_cnn.cpp</a></p>
<p>The next feature I want to focus on is recurrent neural networks. I'll probably
try a single RNN layer first and then upgrade to multi-layers and LSTM and maybe
GRU.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/2017/10/i-successfully-defended-my-phd.html" class="u-url">I successfully defended my Ph.D.</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Baptiste Wicht
            </span></p>
            <p class="dateline">
            <a href="posts/2017/10/i-successfully-defended-my-phd.html" rel="bookmark">
            <time class="published dt-published" datetime="2017-10-15T17:16:29+02:00" itemprop="datePublished" title="2017-10-15 17:16">2017-10-15 17:16</time></a>
            </p>
                <p class="commentline">
    
    <a href="posts/2017/10/i-successfully-defended-my-phd.html#disqus_thread" data-disqus-identifier="cache/posts/2017/10/i-successfully-defended-my-phd.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <p>I'm happy to announce that I've successfully defended my thesis "Deep Learning
Features for Image Processing". After four years, I've defended it officially in
front of the thesis committed last Friday and then again two days ago I've
successfully publicly defended in front of my friends, family and colleagues.</p>
<p>I'm now a "Doctor of Philosophy in Computer Science :)</p>
<p>I will update my thesis with the last comments in November and send the final
version to the university. At which point, I'll publish it on this website as
well.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/2017/10/budgetwarrior-track-assets-portfolio-savings-rates-auto-completion.html" class="u-url">Budgetwarrior: Track assets and portfolio, savings rates and auto-completion</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Baptiste Wicht
            </span></p>
            <p class="dateline">
            <a href="posts/2017/10/budgetwarrior-track-assets-portfolio-savings-rates-auto-completion.html" rel="bookmark">
            <time class="published dt-published" datetime="2017-10-12T19:40:14+02:00" itemprop="datePublished" title="2017-10-12 19:40">2017-10-12 19:40</time></a>
            </p>
                <p class="commentline">
    
    <a href="posts/2017/10/budgetwarrior-track-assets-portfolio-savings-rates-auto-completion.html#disqus_thread" data-disqus-identifier="cache/posts/2017/10/budgetwarrior-track-assets-portfolio-savings-rates-auto-completion.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <p>This last month, I've been reading quite a few blogs about personal finance and
I've decided to integrate more features into budgetwarrior. This post is about
three new features that I've integrated. It's not yet a new release, so if you
want to test this version, you'll have to compile it from the <em>master</em> branch on
Git.</p>
<p>As it was last time, the values on my screenshots have all been randomized.</p>
<p>If you have several assets with different distributions, I believe it is a great
value to have them all shown at the same time. Especially if you want to change
the distribution of your portfolio or if you plan big changes in it.</p>
<section id="track-assets"><h2>Track assets</h2>
<p>The first feature I've added is a feature to precisely track each of your assets
independently. And you can also track the allocation of your portfolio in terms
of stocks, bonds and cash. The tool also lets you set the desired distribution
of your assets and will compute the difference that you should make in order to
comply to your desired distribution.</p>
<p>First, you need to define all your asset classes (your accounts, funds, and
stocks, ...) and their distribution with <cite>budget asset add</cite>. It also
supports to set a currency. The default currency is now CHF, but you can set it
in the configuration file, for instance <cite>default_currency=USD</cite>. You can
see your assets using <cite>budget asset</cite>:</p>
<img alt="View of your assets" src="images/budgetwarrior_assets.png"><p>You can then set the value of your assets using <cite>budget asset value add</cite>.
The system will save all the values of your assets. For now, only the last value
is used in the application to display. In the future, I plan to add new reports
for evolution of the portfolio over time. You can see your current net worth
with the <cite>budget asset value</cite>:</p>
<img alt="View of your portfolio" src="images/budgetwarrior_asset_values.png"><p>The different currencies will all be converted to the default currency.</p>
</section><section id="savings-rate"><h2>Savings rate</h2>
<p>The second change I did is to compute the savings rate of each month and year.
The savings rate is simply the portion of your income that you are able to save
each month. The savings rate for a year is simple the average of the savings
rate of each month.</p>
<p>The savings rate of the month can be seen with <cite>budget overview month</cite>:</p>
<img alt="Savings rate of the month" src="images/budgetwarrior_savings_rate.png"><p>The saving rates of each month can also be seen in the overview of the year with
<cite>budget overview year</cite>:</p>
<img alt="Savings rate of the year" src="images/budgetwarrior_savings_rate_year.png"><p>This shows the savings rate of each month, the average of the year and the
average of the current year up to the current month.</p>
<p>The savings rate is a very important metric of your budget. In my case, it's
currently way too low and made me realize I really need to save more. Any
savings rate below 10% is too low. There are no rule as too much it should be,
but I'd like to augment mine to at least 20% next year.</p>
</section><section id="auto-completion"><h2>Auto-completion</h2>
<p>The last feature is mostly some quality-of-life improvement. Some of the inputs
in the console can now be completed. It's not really auto-completion per se, but
you can cycle through the list of possible values using the UP and DOWN.</p>
<p>This makes it much easier to set some values such as asset names (in
<cite>budget asset value add</cite> for instance), account names and objective types
and sources. I'm trying to make the input of values easier.</p>
</section><section id="conclusion"><h2>Conclusion</h2>
<p>I don't know exactly what else will be integrated in this feature, but I may
already improve some visualization for asset values. If I learn something new
about personal finance that I may integrate in the tool, I'll do it as well.</p>
<p>If you are interested by the sources or want to install this version,
you can download them on Github:
<a class="reference external" href="https://github.com/wichtounet/budgetwarrior">budgetwarrior</a>.</p>
<p>The new features are in the <em>master</em> branch.</p>
<p>If you have a suggestion for a new features or you found a bug, please post an
issue on Github, I'd be glad to help you.</p>
<p>If you have any comment, don't hesitate to contact me, either by letting a
comment on this post or by email.</p>
</section>
</div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/2017/10/deep-learning-library-10-fast-neural-network-library.html" class="u-url">Deep Learning Library 1.0 - Fast Neural Network Library</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Baptiste Wicht
            </span></p>
            <p class="dateline">
            <a href="posts/2017/10/deep-learning-library-10-fast-neural-network-library.html" rel="bookmark">
            <time class="published dt-published" datetime="2017-10-07T15:42:16+02:00" itemprop="datePublished" title="2017-10-07 15:42">2017-10-07 15:42</time></a>
            </p>
                <p class="commentline">
    
    <a href="posts/2017/10/deep-learning-library-10-fast-neural-network-library.html#disqus_thread" data-disqus-identifier="cache/posts/2017/10/deep-learning-library-10-fast-neural-network-library.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <div>
<img alt="DLL Logo" class="align-center" src="images/dll_logo.png"><p>I'm very happy to announce the release of the first version of Deep Learning
Library (DLL) 1.0. DLL is a neural network library with a focus on speed and
ease of use.</p>
<p>I started working on this library about 4 years ago for my Ph.D. thesis.
I needed a good library to train and use Restricted Boltzmann Machines (RBMs)
and at this time there was no good support for it. Therefore, I decided to write
my own. It now has very complete support for the RBM and the Convolutional RBM
(CRBM) models. Stacks of RBMs (or Deep Belief Networks (DBNs)) can be pretrained
using Contrastive Divergence and then either fine-tuned with mini-batch gradient
descent or Conjugate Gradient or used as a feature extractor. Over the years,
the library has been extended to handle Artificial Neural Networks (ANNs) and
Convolutional Neural Networks (CNNs). The network is also able to train regular
auto-encoders. Several advanced layers such as Dropout or Batch Normalization
are also available as well as adaptive learning rates techniques such as
Adadelta and Adam. The library also has integrated support for a few datasets:
MNIST, CIFAR-10 and ImageNet.</p>
<p>This library can be used using a C++ interface. The library is fully
header-only. It requires a C++14 compiler, which means a minimum of clang 3.9 or
GCC 6.3.</p>
<p>In this post, I'm going to present a few examples on using the library and give
some information about the performance of the library and the roadmap for the
project.</p>
<p class="more"><a href="posts/2017/10/deep-learning-library-10-fast-neural-network-library.html">Read more</a></p>
</div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-34.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-32.html" rel="next">Older posts</a>
            </li>
        </ul></nav><script>var disqus_shortname="blogwichtounet";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents  2025         <a href="mailto:baptistewicht@gmail.com">Baptiste Wicht</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         - License: 
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="padding-left:5px;border-width:0" src="assets/img/cc.png"></a>
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script>
</body>
</html>
