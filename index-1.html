<!DOCTYPE html><html lang="en">
<head>
    <link href="favicon.ico" rel="icon" type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Website about vtechnologies Java, Spring, OSGi, Hardware,...">
    <meta name="author" content="Baptiste Wicht">
    <title>@Blog("Baptiste Wicht") (old posts, page 1) | @Blog("Baptiste Wicht")</title>
    
            <link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
      <link rel="canonical" href="http://wichtounet.github.io/index-1.html">
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js" type="text/javascript"></script>
    <![endif]-->
            <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">

    
    
    <link rel="stylesheet" type="text/css" href="assets/css/tipuesearch.css">
    
</head>
<body>

<div class="social_container">
    <div class="social_container_gplus">
        <a target="_blank" title="Share on Google+" href="https://plusone.google.com/_/+1/confirm?hl=en&amp;url=http://wichtounet.github.io/index-1.html"><img src="assets/img/google_plus.png"></a>
    </div>
    <div class="social_container_facebook">
        <a target="_blank" title="Share on Facebook" href="http://www.facebook.com/sharer/sharer.php?u=#url"><img src="assets/img/facebook.png"></a>
    </div>
    <div class="social_container_twitter">
        <a target="_blank" title="Tweet on Twitter" href="http://twitter.com/home?status=#url"><img src="assets/img/twitter.svg"></a>
    </div>
</div>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container-fluid"><!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://wichtounet.github.io/">@Blog("Baptiste Wicht")</a>
        </div><!-- /.navbar-header -->
        
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                
                <li><a href="stories/about.html">About</a>
                </li><li><a href="stories/publications.html">Publications</a>
                </li><li><a href="stories/donate.html">Donate</a>
                </li><li><a href="stories/contact.html">Contact</a>
                </li><li><a href="stories/faq.html">FAQ</a>
                </li><li><a href="stories/legal.html">Legal</a>
                </li><li><a href="archive.html">Archives</a>
                </li><li><a href="categories/index.html">Tags</a>
                </li><li><a href="rss.xml">RSS</a>

            </li></ul>

            <span class="navbar-form pull-left">
                <form action="stories/search.html">
                    <input type="text" name="q" id="tipue_search_input">
                </form>
            </span>
            
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a target="_blank" title="Follow @wichtounet on Twitter" href="https://twitter.com/wichtounewichtounet">
                        <img src="assets/img/twitter.svg" alt="Follow @wichtounet on Twitter">
                    </a>
                </li>
                <li>
                    <a target="_blank" title="Follow +BaptisteWicht on Google+" href="https://plus.google.com/+BaptisteWicht">
                        <img src="assets/img/google_plus.svg" alt="Follow +BaptisteWicht on Google+">
                    </a>
                </li>
            </ul>
        </div><!-- /.navbar-collapse -->
    </div><!-- /.container-fluid -->
</nav>

<!-- End of Menubar -->

<div class="body-container">

    <!-- Sidebar -->

    <div class="left-sidebar">
            <div class="left-sidebar-widget">
                <h3>Welcome to my blog</h3>
                <div class="left-sidebar-widget-content">
                    <div class="g-person" data-width="275" data-href="//plus.google.com/u/0/103113673902796202116" data-theme="dark" data-layout="landscape" data-rel="author"></div>
                </div>
            </div>

            <div class="left-sidebar-widget">
                <h3>Tags</h3>
                <div class="left-sidebar-widget-content">
                    <div id="tags_container">
                        <canvas width="275" height="250" id="tags_canvas">
                            <p>Anything in here will be replaced on browsers that support the canvas element</p>
                        </canvas>
                    </div>
                </div>
            </div>

        
        <div class="left-sidebar-widget">
            <h3>Recent comments</h3>
            <div class="left-sidebar-widget-content">
                <div id="recentcomments" class="dsq-widget">
                    <script type="text/javascript" src="http://blogwichtounet.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=0&amp;avatar_size=28&amp;excerpt_length=50"></script> 
                </div>
            </div>
        </div>

        <div class="left-sidebar-widget">
            <h3>Popular posts</h3>
            <div class="left-sidebar-widget-content">
                <div id="popularthreads" class="dsq-widget">
                    <script type="text/javascript" src="http://blogwichtounet.disqus.com/popular_threads_widget.js?num_items=5&amp;days_back=90"></script>
                </div>
            </div>
        </div>
        
        <div class="left-sidebar-widget">
            <h3>Blogroll</h3>
            <div class="left-sidebar-widget-content">
                <ul>
                    <li><a target="_blank" href="http://www.asjava.com/">AsJava.com : Java Tutorial</a></li>
                    <li><a target="_blank" href="http://www.mkyong.com/">Mkyong : Java Tutorials</a></li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Content -->

    <div class="container">
            <div class="body-content">

            <div class="row">
                
        <article class="postbox h-entry post-text">
        <h1 class="p-name"><a href="posts/2010/02/logging-with-slf4j.html" class="u-url">Logging with SLF4J</a>
        <br><small>  
             Posted: <time class="published dt-published" datetime="2010-02-02T11:21:10+01:00">2010-02-02 11:21</time>
        </small></h1>
        <hr>
        <div class="e-content">
        <div><h4>I. Introduction</h4>

<p>SLF4J is an abstract layer for logging APIs. The principle is roughly the same as Jakarta Commons Logging. The advantages of the use of such a layer enable to be completely independant of the logging implementation. So it's possible to easily change the logging implementation without modifying the existing code. You only have to change the configuration of the implementation. And finally in the case of the conception of a library, this leaves the user to choose the logging system.</p>
<p>You gonna tell me : if Commons Logging makes already that, why an other framework of logging abstraction ? Simply, because Commons Logging as his defaults. The first one concern the loading of the logging implementation. Indeed, the search is made dynamically at the execution through a classloader system. And this method can be problematic in several situations by example when the application use custom classloaders or when using OSGi. And finally the implementation of the Commons Logging can cause some memory leaks.</p>
<p>Furthermore, Commons Logging constrain the user to test if a loging level is enabled or not before making logging containing heavy concatenation.</p>
<p>We will see than SLF4J solve this problems in an efficient way.</p>
<p>You can download the official distribution on the SLFJ4J website.</p>
<!--more-->

<h4>2. Select the logging implementation</h4>

<p>Unlike of Commons Logging, SLF4J doesn't resolve the logging implementation at execution, but directly at the compilation with a bridging API. So more than the JAR of SLF4J you need the following JARs : the bridging JAR and the JAR of the implementation. Here is what you get with Log4J :</p>
<p><a href="wp-content/uploads/2010/03/SLF4J-Selection.png"><img src="wp-content/uploads/2010/03/SLF4J-Selection-100x300.png" alt="SLF4J Implementation Selection" title="SLF4J Implementation Selection" width="100" height="300" class="size-medium wp-image-238"></a></p>
<p>All that is made only by adding a JAR to the classpath. No need to configure nothing else than the implementation. You just have to be careful to call only the interface of SLF4J otherwise there is no more interest to use an abstract layer</p>
<h4>3. Redirect calls from others implementations</h4>

<p>More than offer a logging abstraction, SLF4J give the user the possibility to redirect calls for an implementation to SLF4J who will himself redirect them to the used implementation.</p>
<p>For that, you just have to replace the Jar of the xxx implementation by the xxx-to-slf4j.jar file who will intercept the calls and redirect them to the SLF4J implementation.</p>
<p>The following diagram show exactly how the calls are redirected :</p>
<p><a href="wp-content/uploads/2010/03/SLF4J-Redirection.png"><img src="wp-content/uploads/2010/03/SLF4J-Redirection-300x188.png" alt="SLF4J Calls redirection" title="SLF4J Calls redirection" width="300" height="188" class="size-medium wp-image-237"></a></p>
<p><strong>Warning</strong> : Of course, you mustn't add the implementation and the jar of redirection in the classpath at the same time. And more important, you must never use the jar of redirection of the used SLF4J implementation. This creates an infinite circle that will be make your application crashes.</p>
<!--nextpage-->

<h4>4. API use</h4>

<p>The API of SLF4J is not really hard to use and is very like the others implementations or abstractions like Log4J or Commons Logging. Here is how to get a logger :</p>
<div class="code"><pre><span class="n">org</span><span class="o">.</span><span class="na">slf4j</span><span class="o">.</span><span class="na">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="n">org</span><span class="o">.</span><span class="na">slf4j</span><span class="o">.</span><span class="na">LoggerFactory</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="n">HelloWorld</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</pre></div>


<p>Then, you can use it like any other implementation with the methods debug(), info(), warn(), trace() et error(). Par exemple :</p>
<div class="code"><pre><span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Hello World"</span><span class="o">);</span>
</pre></div>


<p>But this is not the strength of SLF4J. Let's take a simple logging example :</p>
<div class="code"><pre><span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">"Info : x = "</span> <span class="o">+</span> <span class="n">info</span><span class="o">.</span><span class="na">getX</span><span class="o">()</span> <span class="o">+</span> <span class="s">", y = "</span> <span class="o">+</span> <span class="n">info</span><span class="o">.</span><span class="na">getY</span><span class="o">()</span> <span class="o">+</span> <span class="s">", str = "</span> <span class="o">+</span> <span class="n">infos</span><span class="o">.</span><span class="na">getStr</span><span class="o">());</span>
</pre></div>


<p>That means than all times this line is executed, a concatenation is done. This can quickly be heavy for the performance if the code is executed regularly. It's because we must first test if the level is enabled :</p>
<div class="code"><pre><span class="k">if</span><span class="o">(</span><span class="n">logger</span><span class="o">.</span><span class="na">isDebugEnabled</span><span class="o">()){</span>
    <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">"Info : x = "</span> <span class="o">+</span> <span class="n">info</span><span class="o">.</span><span class="na">getX</span><span class="o">()</span> <span class="o">+</span> <span class="s">", y = "</span> <span class="o">+</span> <span class="n">info</span><span class="o">.</span><span class="na">getY</span><span class="o">()</span> <span class="o">+</span> <span class="s">", str = "</span> <span class="o">+</span> <span class="n">infos</span><span class="o">.</span><span class="na">getStr</span><span class="o">());</span>
<span class="o">}</span>
</pre></div>


<p>This times the performances are guaranteed, but this kind of code is not esthetical and is quickly heavy. Moreover the test is already done in the debug method who displays nothing if the debug level is not enabled. So why do the work twice ? SLF4J offer a new alternative really interesting :</p>
<div class="code"><pre><span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">"Info : x = {}, y = {}, str = {}"</span><span class="o">,</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[]{</span><span class="n">info</span><span class="o">.</span><span class="na">getX</span><span class="o">(),</span> <span class="n">info</span><span class="o">.</span><span class="na">getY</span><span class="o">(),</span> <span class="n">infos</span><span class="o">.</span><span class="na">getStr</span><span class="o">()});</span>
</pre></div>


<p>The {} will be replaced by the parameters. The, the concatenation is only done if the logging level is enabled. Furthermore, this code is really cleaner than the two previous.</p>
<p><strong>Warning</strong> : In the case when the recuperation of the informations is heavy, you must test use the first method and test the level of log before logging the informations. By example we could imagine a getDebugInfos() on an object who mades a lot of informations to get informations. This method must not be executed if the log level is not enabled.</p>
<h4>5. Marker API</h4>

<p>The Marker allow essentially to associate tags to logs. This tags enable the different appenders to take only some logs. Lets imagine an appender who write the log using encryption and that must only be used on logs marked as confidentials. The Marker enable us to implement that.</p>
<p>This functionaly is only available with the LogBack implementation : it's the only who implements the Marker. Nevertheless, you could use the Marker API with the other implementation, but that will have no effect.</p>
<p>Imagine by example an appender named CryptAppender who encode the log using some algorithm. We could configure it thus :</p>
<div class="code"><pre><span class="nt">&lt;appender</span> <span class="na">name=</span><span class="s">"CRYPTED"</span> <span class="na">class=</span><span class="s">"CryptAppender"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;layout</span> <span class="na">class=</span><span class="s">"ch.qos.logback.classic.html.HTMLLayout"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;pattern&gt;</span>%date%-5level%logger%msg<span class="nt">&lt;/pattern&gt;</span>
    <span class="nt">&lt;throwableRenderer</span> <span class="na">class=</span><span class="s">"ch.qos.logback.classic.html.DefaultThrowableRenderer"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/layout&gt;</span>
  <span class="nt">&lt;evaluator</span> <span class="na">class=</span><span class="s">"ch.qos.logback.classic.boolex.OnMarkerEvaluator"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;marker&gt;</span>CONFIDENTIAL<span class="nt">&lt;/marker&gt;</span>
  <span class="nt">&lt;/evaluator&gt;</span>
<span class="nt">&lt;/appender&gt;</span>
</pre></div>


<p>The OnMarkerEvaluator enable to select only logs than have been marked with some tag. In our case, we have to mark to confidential logs with CONFIDENTIAl. Here is how to do that :</p>
<div class="code"><pre><span class="n">Marker</span> <span class="n">confidentialMarker</span> <span class="o">=</span> <span class="n">MarkerFactory</span><span class="o">.</span><span class="na">getMarker</span><span class="o">(</span><span class="s">"CONFIDENTIAL"</span><span class="o">);</span>
<span class="n">logger</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">confidentialMarker</span><span class="o">,</span> <span class="s">"C'est confidentiel !"</span><span class="o">);</span>
</pre></div>


<p>That will not display the log directly but crypted.</p>
<p>An other use of this functionality could by example be the send by mail of some logs.</p>
<p>You could of course configure several appenders for the same tag. You could also create a Marker hierarchy :</p>
<div class="code"><pre><span class="n">Marker</span> <span class="n">parentMarker</span> <span class="o">=</span> <span class="n">MarkerFactory</span><span class="o">.</span><span class="na">getMarker</span><span class="o">(</span><span class="s">"parent"</span><span class="o">);</span>
<span class="n">Marker</span> <span class="n">childMarker</span> <span class="o">=</span> <span class="n">MarkerFactory</span><span class="o">.</span><span class="na">getMarker</span><span class="o">(</span><span class="s">"child"</span><span class="o">);</span>
<span class="n">parentMarker</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">childMarker</span><span class="o">);</span>
</pre></div>


<p>Doing that, all that is logged with parentMarker or childMarker will be treated in appenders configured for parent and the appenders configured for child will only see what is logged with child.</p>
<!--nextpage-->

<h4>6. Mapped Diagnostic Context (MDC)</h4>

<p>The "Mapped Diagnostic Context" (MDC) is, in summary, a simple map (key-value set) maintained by the logging framework. In that map, the application can put some key-value couple that could be used to add some informations in the logs.</p>
<p>Imagine that we treat informations on persons and that we display in logging. The name and the firstname of the person must be displayed in each lines of logging. We could can use MDC to automate the include of the name and the firstname in the logs.</p>
<p>It is possible to add values in MDC with the put method :</p>
<div class="code"><pre><span class="n">MDC</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"prenom"</span><span class="o">,</span> <span class="s">"Baptiste"</span><span class="o">);</span>
<span class="n">MDC</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"nom"</span><span class="o">,</span> <span class="s">"Wicht"</span><span class="o">);</span>
</pre></div>


<p>Then, we can use them in the layout of logging. This layout can be configured in the implementation. At this time only Log4J, JUL and Logback support MDC. Here is a layout using MDC :</p>
<pre>%X{prenom} %X{nom} - %m%n</pre>

<p>Then, to display informations, we just have to do :</p>
<div class="code"><pre><span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Age {}"</span><span class="o">,</span> <span class="n">age</span><span class="o">);</span>
<span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Localisation {}"</span><span class="o">,</span> <span class="n">localisation</span><span class="o">);</span> 
</pre></div>


<p>That will display :</p>
<pre>Baptiste Wicht - Age 22
Baptiste Wicht - Localisation Suisse</pre>

<p>And finally if the MDC is configured between to logging instructions, this will directly change the logging :</p>
<div class="code"><pre><span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Age {}"</span><span class="o">,</span> <span class="n">age</span><span class="o">);</span>
<span class="n">MDC</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"prenom"</span><span class="o">,</span> <span class="s">"Jacques"</span><span class="o">);</span>
<span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Localisation {}"</span><span class="o">,</span> <span class="n">localisation</span><span class="o">);</span>
</pre></div>


<p>will display :</p>
<pre>Baptiste Wicht - Age 22
Jacques Wicht - Localisation Suisse</pre>

<p>That can be very practical to stock and display global informations. For example a login, a session id or any other data.</p>
<h4>7. Conclusion</h4>

<p>In conclusion, SLF4J is really good abstraction layer. It's really powerful, but remains really simple to use and the style is the same as the other existing logging systems.</p>
<p>The author of SLF4J advises to use LogBack as implementation. This is the reference implementation.</p>
<p>If you any comment to do on this article, don't hesitate to put it on the above form.</p></div>
        </div>
            
        
    <p>
        <a href="posts/2010/02/logging-with-slf4j.html#disqus_thread" data-disqus-identifier="cache/posts/2010/02/logging-with-slf4j.html">Comments</a>


        </p></article>
        <article class="postbox h-entry post-text">
        <h1 class="p-name"><a href="posts/2010/01/jr-introduction.html" class="u-url">Introduction to JR programming language</a>
        <br><small>  
             Posted: <time class="published dt-published" datetime="2010-01-30T13:01:49+01:00">2010-01-30 13:01</time>
        </small></h1>
        <hr>
        <div class="e-content">
        <div><h4>1. Language overview</h4>

<p>JR is a programming language especially created to solve concurrent programming problems. This language is an overview of Java who add to this last the main paradigms of concurrent programming. Moreover JR make easier the concepts still implemented in Java like process or semaphores. There is also several extensions for JR to add more functionalities like monitors and Conditional Critical Region (CCR). JR is the implementation of the SR language for Java.</p>
<p>JR makes nothing else than add a layer over Java. Once we use the JR compiler, the JR source files are transformed in Java files and are executed by the virtual machine like any other Java class.</p>
<p>JR is often used as a school support to learn concurrent programming.</p>
<p>In this article, we will see the bases of the programmation with JR.</p>
<p>The presented version is the one of June 2009, the version 2.00602 who are based on Java 6.0.</p>
<p>This article need that you've installed the JR environment on your system. An article is available here for the installation under Windows.</p>
<p>In this article, we will especially focus on the apports of the JR language for the concurrent programming. We will not see the the integrality of the language. JR has other benefits than make easier concurrent programming, but we will not see that in this article. Moreover, all the aspects of concurrent programming in JR will not be treated here.</p>
<!--more-->

<h4>2. Hello World</h4>

<p>Like all other languages, we must start with a simple Hello World. Thus we'll create a file Hello.jr. Nothing special here, it's pure Java :</p>
<div class="code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Hello</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Hello World"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>Then we can compile it :</p>
<pre>jrc Hello.jr</pre>

<p>This will create a jrGen folder containing Java files. The result of a JR compilation is always a set of Java files corresponding to the translation of the JR files.</p>
<p>To launch your JR program, use the jr command followed by the name of the main class (class containing the main method) :</p>
<pre>jr Hello</pre>

<p>That will display :</p>
<pre>Hello World</pre>

<p>The jr command will also launch the compilation of Java files. This compilation will be done every time. If you want to make only the launch of compiled files, you can use the jrrun command.</p>
<p>Like said in introduction, the JR language extends the Java language. So, you can code in Java with JR. Thus an Hello World is only Java.</p>
<h4>3. Processes</h4>

<p>The first thing to see is the declaration of processes. This is done in an easier way than in Java. No need to instanciate some objects, this is done in a declarative way and JR make the rest.</p>
<p>For the declaration of process, JR introduce a new keyword process who enable to declare a process. Here is the simplest declaration of a process :</p>
<div class="code"><pre><span class="n">process</span> <span class="n">Hello</span> <span class="o">{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Processus"</span><span class="o">);</span>
</pre></div>


<p>Like you can see it, it's easier than in Java. And better, no need to launch it, you just have to instanciate the class. A process can also be declared static. This times, it will not be launched at the instanciation of the class but at the resolution of the class by the virtual machine. By example, we can rewrite an HelloWorld in that way :</p>
<div class="code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">HelloProcess</span> <span class="o">{</span>
    <span class="kd">static</span> <span class="n">process</span> <span class="n">Hello</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Hello World"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){}</span>
</pre></div>


<p>who display exactly the same thing as the first version of the Hello World. At the difference that our display is made from a thread.</p>
<p>Moreover, JR enable to declare a big set of threads in a declaration with the following syntax :</p>
<div class="code"><pre><span class="kd">static</span> <span class="n">process</span> <span class="nf">Hello</span><span class="o">((</span><span class="kt">int</span> <span class="n">id</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">id</span> <span class="o">&amp;</span><span class="n">amp</span><span class="o">;</span><span class="n">lt</span><span class="o">;</span> <span class="n">n</span><span class="o">;</span> <span class="n">id</span><span class="o">++)){}</span>
</pre></div>


<p>This will declare n threads. The syntax is the same as the for loop. Let's declare 25 threads Hello World :</p>
<div class="code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">HelloProcess</span> <span class="o">{</span>
    <span class="kd">static</span> <span class="n">process</span> <span class="nf">Hello</span><span class="o">((</span><span class="kt">int</span> <span class="n">id</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">id</span> <span class="o">&amp;</span><span class="n">amp</span><span class="o">;</span><span class="n">lt</span><span class="o">;</span> <span class="mi">25</span><span class="o">;</span> <span class="n">id</span><span class="o">++)){</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Hello World from thread "</span> <span class="o">+</span> <span class="n">id</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){}</span>
</pre></div>


<p>When we launch that, we could have the following result :</p>
<pre>Hello World from thread 2
Hello World from thread 24
Hello World from thread 11
Hello World from thread 22
Hello World from thread 0
Hello World from thread 4
Hello World from thread 6
Hello World from thread 8
Hello World from thread 10
Hello World from thread 12
Hello World from thread 14
Hello World from thread 16
Hello World from thread 18
Hello World from thread 20
Hello World from thread 23
Hello World from thread 21
Hello World from thread 19
Hello World from thread 17
Hello World from thread 15
Hello World from thread 13
Hello World from thread 9
Hello World from thread 7
Hello World from thread 5
Hello World from thread 3
Hello World from thread 1</pre>

<p>Like you can see, if you launch several times the program, the display is not same and the message commes in an order completely different order at each launch. Nothing can guarantee the order of the threads launches and still less the order of the execution of the instructions and you must not count on it.</p>
<p>It's the basis of the concurrent programming. You cannot predict the order of the instructions in the different threads.</p>
<!--nextpage-->

<h4>4. Quiescence action</h4>

<p>JR introduce a new concept, really powerful, the quiescence action. It's an action who's executed when the system is quiescent. It seems that all the process are finished or remains in deadlocks.</p>
<p>Before that, we use to introduce the concept of operations. In our case, an operation is a simple method declared with the op keyword. But in JR an operation is more than a method and could be invoked in different ways and permit other things that methods, but this is beyond the scope of this article.</p>
<p>Here is a declaration of a simple operation.</p>
<div class="code"><pre><span class="kd">public</span> <span class="kd">static</span> <span class="n">op</span> <span class="kt">void</span> <span class="nf">end</span><span class="o">(){</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"End"</span><span class="o">)</span>
</pre></div>


<p>So, this is a simple method with the op prefix. You can invoke it like any other method. But you can also declare it like the action to execute when the system is in quiescence state. If we take our example of the 25 hello world and if we define the quiescence action here is what we get :</p>
<div class="code"><pre><span class="kn">import</span> <span class="nn">edu.ucdavis.jr.JR</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">QuiescenceProcess</span> <span class="o">{</span>
    <span class="kd">static</span> <span class="n">process</span> <span class="nf">Hello</span><span class="o">((</span><span class="kt">int</span> <span class="n">id</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">id</span> <span class="o">&amp;</span><span class="n">amp</span><span class="o">;</span><span class="n">lt</span><span class="o">;</span> <span class="mi">25</span><span class="o">;</span> <span class="n">id</span><span class="o">++)){</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Hello World from thread "</span> <span class="o">+</span> <span class="n">id</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">JR</span><span class="o">.</span><span class="na">registerQuiescenceAction</span><span class="o">(</span><span class="n">end</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">edu</span><span class="o">.</span><span class="na">ucdavis</span><span class="o">.</span><span class="na">jr</span><span class="o">.</span><span class="na">QuiescenceRegistrationException</span> <span class="n">e</span><span class="o">){</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">op</span> <span class="kt">void</span> <span class="nf">end</span><span class="o">(){</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"End"</span><span class="o">);</span>
</pre></div>


<p>We use the registerQuiescenceAction(op) method of the JR class. This class provide some utility methods for the JR programs</p>
<p>And a launch, we see something like that :</p>
<pre>Hello World from thread 0
Hello World from thread 22
Hello World from thread 23
Hello World from thread 21
Hello World from thread 24
Hello World from thread 20
Hello World from thread 19
Hello World from thread 18
Hello World from thread 17
Hello World from thread 16
Hello World from thread 15
Hello World from thread 14
Hello World from thread 13
Hello World from thread 12
Hello World from thread 11
Hello World from thread 10
Hello World from thread 9
Hello World from thread 8
Hello World from thread 7
Hello World from thread 6
Hello World from thread 5
Hello World from thread 4
Hello World from thread 3
Hello World from thread 2
Hello World from thread 1
End</pre>

<p>This is really useful to execute an action after the end of the system and verify something on the system. By example, display a message in the case of a deadlock or display debug informations on the executed operations.</p>
<!--nextpage-->

<h4>5. Semaphores</h4>

<p>We will now see how to use one of the basic concept of concurrent programming : the semaphores. The semaphores are a really simple concept but very powerful. A semaphore represent a certain integer valur representing the number of threads that can go in a certain portion of code, call it "s". A semaphore has two actions :</p>
<ul>
    <li><strong>P</strong> : make the thread wait while s equals 0 and then decrement s.</li>
    <li><strong>V</strong> : increment s.</li>
</ul>

<p>This two operations are atomic. We use the semaphores to protect a critical section who need to be executed in an atomic way. We can also use semaphores to restrain the number of threads that can execute some instructions in parralel.</p>
<p>The declaration and the use of semaphores is really easy. Here is how you can declare a semaphore with a initial value of 1 :</p>
<div class="code"><pre><span class="n">sem</span> <span class="n">mutex</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
</pre></div>


<p>Then, the operations P et V are extremely simple to use :</p>
<div class="code"><pre><span class="n">P</span><span class="o">(</span><span class="n">mutex</span><span class="o">);</span>
<span class="c1">//Critical section</span>
<span class="n">V</span><span class="o">(</span><span class="n">mutex</span><span class="o">);</span>
</pre></div>


<p>The semaphores are principally used to solve the critical section problem. Imagine a simple example, but who show exactly the problem that the semaphore can solve :</p>
<div class="code"><pre><span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

<span class="kd">static</span> <span class="n">process</span> <span class="nf">Calculator</span><span class="o">((</span><span class="kt">int</span> <span class="n">id</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">id</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span> <span class="mi">50</span><span class="o">;</span> <span class="n">id</span><span class="o">++)){</span>
    <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span> <span class="mi">5</span><span class="o">;</span> <span class="n">i</span><span class="o">++){</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="o">+</span> <span class="mi">2</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>Because this code launch 50 threads who add each one 5 times 2 to value, we could think that value must be 500 at the end of the execution, isnt'it ?</p>
<p>But nothing guarantee that result. This is known as the interleaving in concurrent programming. This is because the + 2 operation is in reality 3 operations :</p>
<ul>
    <li>read the value of value</li>
    <li>add 2 to the read value</li>
    <li>set the new value to value</li>
</ul>

<p>A thread can be put in wait just after 1 and do the incrementation on the old value but other threads have still made the incrementation, but it has the old value when it mades the +2 and write and false value to value. To prove that to you, execute the following code several times :</p>
<div class="code"><pre><span class="kn">import</span> <span class="nn">edu.ucdavis.jr.JR</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SemaphoreProcess</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

    <span class="kd">static</span> <span class="n">process</span> <span class="nf">Calculator</span><span class="o">((</span><span class="kt">int</span> <span class="n">id</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">id</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span> <span class="mi">50</span><span class="o">;</span> <span class="n">id</span><span class="o">++)){</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span> <span class="mi">5</span><span class="o">;</span> <span class="n">i</span><span class="o">++){</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="o">+</span> <span class="mi">2</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">JR</span><span class="o">.</span><span class="na">registerQuiescenceAction</span><span class="o">(</span><span class="n">end</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">edu</span><span class="o">.</span><span class="na">ucdavis</span><span class="o">.</span><span class="na">jr</span><span class="o">.</span><span class="na">QuiescenceRegistrationException</span> <span class="n">e</span><span class="o">){</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">op</span> <span class="kt">void</span> <span class="nf">end</span><span class="o">(){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">value</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>On my computer, i've the following results.</p>
<pre>498
500
500
500
496</pre>

<p>And if we use greater values, it's even worse. By example, with 100 threads and 100 iterations :</p>
<pre>20000
19560
19912
19758
20000</pre>

<p>But this problem can be solved with semaphores :</p>
<div class="code"><pre><span class="kd">private</span> <span class="kd">static</span> <span class="n">sem</span> <span class="n">mutex</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

<span class="kd">static</span> <span class="n">process</span> <span class="nf">Calculator</span><span class="o">((</span><span class="kt">int</span> <span class="n">id</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">id</span> <span class="o">&amp;</span><span class="n">amp</span><span class="o">;</span><span class="n">lt</span><span class="o">;</span> <span class="mi">50</span><span class="o">;</span> <span class="n">id</span><span class="o">++)){</span>
    <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&amp;</span><span class="n">amp</span><span class="o">;</span><span class="n">lt</span><span class="o">;</span> <span class="mi">5</span><span class="o">;</span> <span class="n">i</span><span class="o">++){</span>
        <span class="n">P</span><span class="o">(</span><span class="n">mutex</span><span class="o">);</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="o">+</span> <span class="mi">2</span><span class="o">;</span>
        <span class="n">V</span><span class="o">(</span><span class="n">mutex</span><span class="o">)</span>
        <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>With that, we have the guarantee that only one thread can do the incrementation at a time and make it atomic. Then all the executions will finish with a value of 500. But that of course impact the performances because instead of x threads who made operations in a parralel way, we've now only one thread at a time. The example with 100 threads and 100 iterations is really slow. We can improve performance using the mutex semaphore around the loop. But the performances are to be considered differently in each example. So we must use wisely the synchronization methods of threads.</p>
<!--nextpage-->

<h4>6. Conclusion</h4>

<p>So, we've now discover the main concepts of the JR programming language. Like you have see in this article, this programming language enable to make easier the use of concurrent programming concepts.</p>
<p>I hope that this article has been useful to you to discover the JR Programming Language, and why not, to learn and use this language.</p></div>
        </div>
            
        
    <p>
        <a href="posts/2010/01/jr-introduction.html#disqus_thread" data-disqus-identifier="cache/posts/2010/01/jr-introduction.html">Comments</a>


        </p></article>
        <article class="postbox h-entry post-text">
        <h1 class="p-name"><a href="posts/2010/01/install-jr-windows.html" class="u-url">Install the JR environment on Windows</a>
        <br><small>  
             Posted: <time class="published dt-published" datetime="2010-01-14T12:17:21+01:00">2010-01-14 12:17</time>
        </small></h1>
        <hr>
        <div class="e-content">
        <div><h4>1. JR Programming language</h4>

<p>This article will present you the installation of JR on Windows. It's not an article to learn the JR programming language, this article focus on the installation of JR on Windows.</p>
<p>JR is a programming language especially created to resolve concurrent programming problems. This language is an overlay of Java who add to this last the main paradigms of the concurrent programming. Moreover, JR make easier some concepts also implemented in Java like the process or the semaphores. There is also extensions to JR to implement other functionalities like monitors and Conditional Critical Region (CCR). JR is the implemenation of the SR language for Java.</p>
<p>JR is mainly used as a school support to learn concurrent programming.</p>
<p>In this article, we'll see how to install the JR environment under Windows.</p>
<p>The used version is the one of June 2009, the 2.00602 who is based on Java 6.0.</p>
<h4>2. Prerequisites</h4>

<p>The prerequisites of JR are not many, you need two things :</p>
<ul>
    <li>Java : in the case of the last version of JR, you need Java 6.0. An older version (1.00601) is still available for Java 1.4. To install it if it's not yet the cas, go to the <a title="Website of Sun" href="http://java.com/en/download/index.jsp" target="_blank">website of Sun</a> and follow the described procedure.</li>
    <li>Perl : go on <a title="Official Site of Perl" href="http://www.activestate.com/activeperl/" target="_blank">the official site</a> and download the last version of ActivePerl. Then, you just have to follow the installation procedure.</li>
</ul>

<p>Once this two programs installed, we can go to the installation of JR.</p>
<!--more-->

<h4>3. Installation</h4>

<p>The installation under Linux is quite simple, but under Windows, it's a little more complicated.</p>
<p>The first thing to do is to download JR :</p>
<ul>
    <li><a href="http://www.cs.ucdavis.edu/~olsson/research/jr/versions/2.00602/jr.tar">Tar format</a></li>
    <li><a href="http://www.cs.ucdavis.edu/~olsson/research/jr/versions/2.00602/jr.tar.gz">Tar.Gz format</a></li>
    <li><a href="http://www.cs.ucdavis.edu/~olsson/research/jr/versions/2.00602/jr.zip">Zip format</a></li>
</ul>

<p>Once the donwload finished, you have to decompress the file where you want to install the program. In the rest of the article, we will use C:\Program Files\JR\ for installation folder. If you doesn't install the program here, you just have to replace this with your installation folder.</p>
<p>Then, you have to configure several environment variables. First of all, you have to set the JR_HOME variable who must point to the installation folder : JR_HOME=C:\Program Files\JR.</p>
<p>After that, you have to add JR_HOME to the PATH : PATH=%PATH%;%JR_HOME%\bin\ to use the JR commands.</p>
<p>You have also to create the CLASSPATH to integrate the classes of JR : CLASSPATH=.;%JR_HOME%\classes\jrt.jar;%JR_HOME%\classes\jrx.jar. Be careful to not forget the dot at the beginning of the variable.</p>
<p>The, you have to configure two constants : JRSH=cmd et JRSHC=/C.</p>
<p>To resume, here are all the environments variables and their value.</p>
<pre>JR_HOME=C:\Program Files\JR\
PATH=%PATH%;%JR_HOME%\bin\
CLASSPATH=.;%JR_HOME%\classes\jrt.jar;%JR_HOME%\classes\jrx.jar
JRSH=cmd
JRSHC=/C</pre>

<p>Then, JR must works fine.</p>
<h4>4. Test the installation</h4>

<p>Now, we can test the installation. For that, open a command line (Start menu -&gt; Execute -&gt; cmd) et move to the JR folder with the cd command :</p>
<pre>cd %JR_HOME%</pre>

<p>And then launch this two commands :</p>
<pre>cd vsuite
..\jrv\jrv quick</pre>

<p>This should start serveral tests. It will just display some informations about your system. And if all works fine, you should see something like that :</p>
<pre>C:\Program Files\JR\vsuite&gt;..\jrv\jrv quick
Starting JRV
JR_HOME= C:\Program Files\JR\
JRC=     perl "C:\Program Files\JR\/bin/jrc"
JRRUN=   perl "C:\Program Files\JR\/bin/jrrun"
JAVAC=   "C:\Program Files\Java\jdk1.6.0_17/bin\javac.EXE"
JAVA=    "C:\Program Files\Java\jdk1.6.0_17/bin\java.EXE"
ccr2jr=  perl "C:\Program Files\JR\/bin/ccr2jr"
csp2jr=  perl "C:\Program Files\JR\/bin/csp2jr"
m2jr=    perl "C:\Program Files\JR\/bin/m2jr"
WHICH=   perl "C:\Program Files\JR\/bin/which.pl"
CMP=     perl "C:\Program Files\JR\/bin/cmp.pl"
GREP=    perl "C:\Program Files\JR\/bin/grep.pl"
SORT=    perl "C:\Program Files\JR\/bin/sort.pl"
TAIL=    perl "C:\Program Files\JR\/bin/tail.pl"
jr compiler version "2.00602 (Mon Jun 1 10:59:20 PDT 2009)"
jr rts      version "2.00602 (Mon Jun 1 10:59:25 PDT 2009)"
HOST= DESKTOP-PC
Start Directory= C:\Program Files\JR\/vsuite
JR.JRT = C:\Program Files\JR\/classes/jrt.jar
  -rw-rw-rw-   1 0        0          2090324 Jun  1  2009 C:\Program Files\JR\/classes/jrt.jar
JR.JRX = C:\Program Files\JR\/classes/jrx.jar
  -rw-rw-rw-   1 0        0           227198 Jun  1  2009 C:\Program Files\JR\/classes/jrx.jar
Operating System= Windows_NT
original CLASSPATH= .;C:\Program Files\JR\\classes\jrt.jar;C:\Program Files\JR\\classes\jrx.jar
jrv sets CLASSPATH= .;C:\Program Files\JR\/classes/jrt.jar;C:\Program Files\JR\/classes/jrx.jar
DATE= Thu Jan 14 19:01:35 2010
quick/baby:
quick/fact_2:
quick/misc_invocation_count_st_by_0:
DATE= Thu Jan 14 19:01:45 2010
Elapsed time (hh:mm:ss)= 00:00:10</pre>

<p>If you want to launch more tests, you can do it launching this command :</p>
<pre>..\jrv\jrv</pre>

<p>This time, the program will execute a lot of tests. This tests can take a long time, fast an hour on some system. Moreover, several tests needs RSH, but it's not useful in our case.</p>
<h4>5. Conclusion</h4>

<p>If we follow all this steps of the installation, JR is not as hard to install. You just have to configure the variables and to launch the installation test.</p>
<p>If you want more informations about the JR language, i'll invite you to consult the <a href="http://www.cs.ucdavis.edu/~olsson/research/jr/">official site</a> of one of his creators, Ronald A. Olsson.</p></div>
        </div>
            
        
    <p>
        <a href="posts/2010/01/install-jr-windows.html#disqus_thread" data-disqus-identifier="cache/posts/2010/01/install-jr-windows.html">Comments</a>


        </p></article>
        <article class="postbox h-entry post-text">
        <h1 class="p-name"><a href="posts/2010/01/dont-use-shorts-in-loop.html" class="u-url">Tip : Don’t use shorts for loop indexes !</a>
        <br><small>  
             Posted: <time class="published dt-published" datetime="2010-01-10T15:12:33+01:00">2010-01-10 15:12</time>
        </small></h1>
        <hr>
        <div class="e-content">
        <div><p>After a post I read on a french forum, i asked myself of the performances using shorts as loop indexes for loop with few iterations (less than 32768).</p>
<p>At first view, it can be tempting because we save 2 octets, so why use an int instead a short ?</p>
<p>But, when we think of that, we see that the int is more adapted. Indeed, it's more performant.</p>
<p>Why ?</p>
<p>In Java language, all the operations on integers are made in int. Thus, if we use a short as loop index, at each iterations, a typecasting will be made, that's really heavier than a simple affectation to int.</p>
<p>Here were my first results :</p>
<pre>Time for int : 1441 ms
Time for short : 3015 ms</pre>

<p>The short version is two times slower !</p>
<p>But like Jean have said, my first test was not correct at all because it doesn't consider some issues that could occurs with micro-benchmarks.</p>
<p>So I write a new test using a Java Benchmarking framework from Brent Boyer. Here is a little test with that framework :</p>
<div class="code"><pre><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">wicht</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">bb.util.Benchmark</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.Callable</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ShortIndexesLoop</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Callable</span> <span class="n">callableInt</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Callable</span><span class="o">(){</span>
            <span class="kd">public</span> <span class="n">Long</span> <span class="nf">call</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
                <span class="kt">long</span> <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

                <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">f</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">f</span> <span class="o">&amp;</span><span class="n">amp</span><span class="o">;</span><span class="n">lt</span><span class="o">;</span> <span class="mi">32760</span><span class="o">;</span> <span class="n">f</span><span class="o">++){</span>
                      <span class="n">result</span> <span class="o">+=</span> <span class="n">f</span><span class="o">;</span>
                  <span class="o">}</span>

                <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">};</span>

        <span class="n">Callable</span> <span class="n">callableShort</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Callable</span><span class="o">(){</span>
            <span class="kd">public</span> <span class="n">Long</span> <span class="nf">call</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
                <span class="kt">long</span> <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

                <span class="k">for</span> <span class="o">(</span><span class="kt">short</span> <span class="n">f</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">f</span> <span class="o">&amp;</span><span class="n">amp</span><span class="o">;</span><span class="n">lt</span><span class="o">;</span> <span class="mi">32760</span><span class="o">;</span> <span class="n">f</span><span class="o">++){</span>
                      <span class="n">result</span> <span class="o">+=</span> <span class="n">f</span><span class="o">;</span>
                  <span class="o">}</span>

                <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">};</span>

        <span class="k">try</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Result with int "</span> <span class="o">+</span> <span class="k">new</span> <span class="n">Benchmark</span><span class="o">(</span><span class="n">callableInt</span><span class="o">));</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Result with short "</span> <span class="o">+</span> <span class="k">new</span> <span class="n">Benchmark</span><span class="o">(</span><span class="n">callableShort</span><span class="o">));</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>And here are the results :</p>
<pre>Result with int first = 695.181 us, mean = 43.233 us (CI deltas: -49.358 ns, +74.073 ns), sd = 42.938 us (CI deltas: -11.634 us, +16.426 us)
Result with short first = 733.224 us, mean = 45.679 us (CI deltas: -62.975 ns, +63.932 ns), sd = 45.567 us (CI deltas: -5.877 us, +8.020 us)</pre>

<p>So the results are lower. This time, the short version is 5.657% slower than the int version. Note that this can vary a lot depending on your configuration.</p>
<p>I talk here of for loops, but the case is the same when you use while loops with indexes.</p>
<p>Here are also the results with long, double and float versions :</p>
<pre>Result with long first = 816.555 us, mean = 104.771 us (CI deltas: -236.563 ns, +344.219 ns), sd = 143.295 us (CI deltas: -39.149 us, +63.700 us)
Result with float first = 1.018 ms, mean = 58.055 us (CI deltas: -87.036 ns, +113.537 ns), sd = 70.757 us (CI deltas: -14.269 us, +19.962 us)
Result with double first = 912.115 us, mean = 57.918 us (CI deltas: -66.644 ns, +91.312 ns), sd = 55.185 us (CI deltas: -12.617 us, +25.160 us)</pre>

<p>We can see that the long version is the slowest one and that float and double are equivalent but slower than int and short.</p>
<p>To conclude, always use int as loop indexes add a very little improvements of performances, but not a great thing and do not use long for loops indexes.</p></div>
        </div>
            
        
    <p>
        <a href="posts/2010/01/dont-use-shorts-in-loop.html#disqus_thread" data-disqus-identifier="cache/posts/2010/01/dont-use-shorts-in-loop.html">Comments</a>


        </p></article>
        <article class="postbox h-entry post-text">
        <h1 class="p-name"><a href="posts/2010/01/new-design-jtheque-website.html" class="u-url">New design for JTheque Web site</a>
        <br><small>  
             Posted: <time class="published dt-published" datetime="2010-01-01T13:33:53+01:00">2010-01-01 13:33</time>
        </small></h1>
        <hr>
        <div class="e-content">
        <div><p>I've made a new design for the JTheque web site : <a title="New design for JTheque Web site" href="posts/2010/01/New%20design%20for%20JTheque%20Web%20site" target="_self">http://jtheque.developpez.com/en</a></p>
<p>I took the same design than for my personal web site. The web site is still generated with Maven 2, but i use a custom maven skin to generate the site.</p></div>
        </div>
            
        
    <p>
        <a href="posts/2010/01/new-design-jtheque-website.html#disqus_thread" data-disqus-identifier="cache/posts/2010/01/new-design-jtheque-website.html">Comments</a>


        </p></article>
        <article class="postbox h-entry post-text">
        <h1 class="p-name"><a href="posts/2009/12/swing-user-interface-jtable.html" class="u-url">Creation of Swing User Interface : Tables (JTable)</a>
        <br><small>  
             Posted: <time class="published dt-published" datetime="2009-12-24T08:23:49+01:00">2009-12-24 08:23</time>
        </small></h1>
        <hr>
        <div class="e-content">
        <div><h4>1. Introduction</h4>

<p>This article will introduce you to create tables in Swing. This composent often gives problems when we start with Swing. I will try to explain the different concepts linked to the use of tables in Swing.</p>
<p>In this document we will see the basic concepts of JTable, the definition of table's models, the dynamic modification of table, the way to edit the rendering of cells, the edition of the content of the table and finally the sort and the filter of the table.</p>
<!--more-->

<h4>2. Elementary concepts</h4>

<p>A JTable is a Swing component enabling the program to display a table formed of a certain number of lines and columns. More than the content lines, the JTable has also a header line displaying a title for each column.</p>
<p>A JTable has data and header. We can see the data like a two-dimensional array in which all data correspond to the data of a cell and we can see the header's data like a unidimentional array of String.</p>
<p>JTable use diffent concepts of Swing :</p>
<ul>
    <li>A model to keep the data. A JTable use a class implementing <strong>TableModel</strong>. We will see later how to specify a data model.</li>
    <li>A renderer for the rendering of cells. We can specify a <strong>TableCellRenderer</strong> for each column class. Once again we will see that later.</li>
    <li>An editor to edit the content of a cell. We can specify a TableCellEditor for each column class.</li>
</ul>

<p>During this article, we will develop a very simple program to manage a list of friends. Here are the infromations about a friend :</p>
<ul>
    <li>A name and firnstname (Class String)</li>
    <li>A favourite color (Class Color)</li>
    <li>A gender (boolean man/woman)</li>
    <li>A sport he like to do (Enum Sport)</li>
</ul>

<p>Here is the Sport enumeration :</p>
<div class="code"><pre><span class="kd">public</span> <span class="kd">enum</span> <span class="n">Sport</span> <span class="o">{</span>
    <span class="n">TENNIS</span><span class="o">,</span>
    <span class="n">FOOTBALL</span><span class="o">,</span>
    <span class="n">SWIMMING</span><span class="o">,</span>
    <span class="n">NOTHING</span>
<span class="o">}</span>
</pre></div>


<p>We will start with a basic first version of our application.</p>
<p>The easiest way, but not the best, is to use two arrays and to give them to the JTable constructor.</p>
<p>So, here is the most basic implementation of our program :</p>
<div class="code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">JTableBasicWithPanel</span> <span class="kd">extends</span> <span class="n">JFrame</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">JTableBasicWithPanel</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">();</span>

        <span class="n">setTitle</span><span class="o">(</span><span class="s">"Basic JTable in a JPanel"</span><span class="o">);</span>
        <span class="n">setDefaultCloseOperation</span><span class="o">(</span><span class="n">JFrame</span><span class="o">.</span><span class="na">EXIT_ON_CLOSE</span><span class="o">);</span>

        <span class="n">Object</span><span class="o">[][]</span> <span class="n">data</span> <span class="o">=</span> <span class="o">{</span>
                <span class="o">{</span><span class="s">"Johnathan"</span><span class="o">,</span> <span class="s">"Sykes"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">red</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">TENNIS</span><span class="o">},</span>
                <span class="o">{</span><span class="s">"Nicolas"</span><span class="o">,</span> <span class="s">"Van de Kampf"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">black</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">FOOTBALL</span><span class="o">},</span>
                <span class="o">{</span><span class="s">"Damien"</span><span class="o">,</span> <span class="s">"Cuthbert"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">cyan</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">NOTHING</span><span class="o">},</span>
                <span class="o">{</span><span class="s">"Corinne"</span><span class="o">,</span> <span class="s">"Valance"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">blue</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">SWIMMING</span><span class="o">},</span>
                <span class="o">{</span><span class="s">"Emilie"</span><span class="o">,</span> <span class="s">"Schrödinger"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">magenta</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">FOOTBALL</span><span class="o">},</span>
                <span class="o">{</span><span class="s">"Delphine"</span><span class="o">,</span> <span class="s">"Duke"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">yellow</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">TENNIS</span><span class="o">},</span>
                <span class="o">{</span><span class="s">"Eric"</span><span class="o">,</span> <span class="s">"Trump"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">pink</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">FOOTBALL</span><span class="o">},</span>
        <span class="o">};</span>

        <span class="n">String</span><span class="o">[]</span> <span class="n">headers</span> <span class="o">=</span> <span class="o">{</span><span class="s">"First name"</span><span class="o">,</span> <span class="s">"Name"</span><span class="o">,</span> <span class="s">"Favourite color"</span><span class="o">,</span> <span class="s">"Gender"</span><span class="o">,</span> <span class="s">"Sport"</span><span class="o">};</span>

        <span class="n">JTable</span> <span class="n">table</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JTable</span><span class="o">(</span><span class="n">data</span><span class="o">,</span> <span class="n">headers</span><span class="o">);</span>

        <span class="n">getContentPane</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">table</span><span class="o">.</span><span class="na">getTableHeader</span><span class="o">(),</span> <span class="n">BorderLayout</span><span class="o">.</span><span class="na">NORTH</span><span class="o">);</span>
        <span class="n">getContentPane</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">table</span><span class="o">,</span> <span class="n">BorderLayout</span><span class="o">.</span><span class="na">CENTER</span><span class="o">);</span>

        <span class="n">pack</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">new</span> <span class="nf">JTableBasicWithPanel</span><span class="o">().</span><span class="na">setVisible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
    <span class="o">}</span>
</pre></div>


<p>We use the constructor JTable(Object[][] data, Object[] entetes) to manage our data and headers. To add our table to a JPanel, we must add separately the header and the table itself.</p>
<p>That will give us this result :</p>
<p><a href="wp-content/uploads/2009/12/JTableBasicWithPanel.png"><img class="size-medium wp-image-46" title="JTable Basic With JPanel" src="wp-content/uploads/2009/12/JTableBasicWithPanel-300x127.png" alt="JTable Basic With JPanel" width="300" height="127"></a></p>
<p>With a few number of lines of code, we have a functional table. Nevertheless, this first implementation has some disadvantages :</p>
<ol>
    <li>We cannot display more lines than the lines that can ben displayed by the window.</li>
    <li>The data are totally static</li>
    <li>We cannot manage the way the data are rendered.</li>
    <li>There is no distinction between the view and the datas</li>
    <li>The column Color and Gender are not really esthetic</li>
</ol>

<p>The first point is easily solvable. The good way to add a JTable in container is to use a JScrollPane who enable to display more lines than the windows has space. For the rest of the article, we will always use a JScrollPane. So, here is a new version with a JScrollPane :</p>
<div class="code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">JTableBasicWithScrollPane</span> <span class="kd">extends</span> <span class="n">JFrame</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">JTableBasicWithScrollPane</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">();</span>

        <span class="n">setTitle</span><span class="o">(</span><span class="s">"Basic JTable in a JScrollPane"</span><span class="o">);</span>
        <span class="n">setDefaultCloseOperation</span><span class="o">(</span><span class="n">JFrame</span><span class="o">.</span><span class="na">EXIT_ON_CLOSE</span><span class="o">);</span>

        <span class="n">Object</span><span class="o">[][]</span> <span class="n">data</span> <span class="o">=</span> <span class="o">{</span>
                <span class="o">{</span><span class="s">"Johnathan"</span><span class="o">,</span> <span class="s">"Sykes"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">red</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">TENNIS</span><span class="o">},</span>
                <span class="o">{</span><span class="s">"Nicolas"</span><span class="o">,</span> <span class="s">"Van de Kampf"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">black</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">FOOTBALL</span><span class="o">},</span>
                <span class="o">{</span><span class="s">"Damien"</span><span class="o">,</span> <span class="s">"Cuthbert"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">cyan</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">NOTHING</span><span class="o">},</span>
                <span class="o">{</span><span class="s">"Corinne"</span><span class="o">,</span> <span class="s">"Valance"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">blue</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">SWIMMING</span><span class="o">},</span>
                <span class="o">{</span><span class="s">"Emilie"</span><span class="o">,</span> <span class="s">"Schrödinger"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">magenta</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">FOOTBALL</span><span class="o">},</span>
                <span class="o">{</span><span class="s">"Delphine"</span><span class="o">,</span> <span class="s">"Duke"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">yellow</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">TENNIS</span><span class="o">},</span>
                <span class="o">{</span><span class="s">"Eric"</span><span class="o">,</span> <span class="s">"Trump"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">pink</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">FOOTBALL</span><span class="o">},</span>
        <span class="o">};</span>

        <span class="n">String</span><span class="o">[]</span> <span class="n">headers</span> <span class="o">=</span> <span class="o">{</span><span class="s">"First name"</span><span class="o">,</span> <span class="s">"Name"</span><span class="o">,</span> <span class="s">"Favourite color"</span><span class="o">,</span> <span class="s">"Gender"</span><span class="o">,</span> <span class="s">"Sport"</span><span class="o">};</span>

        <span class="n">JTable</span> <span class="n">table</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JTable</span><span class="o">(</span><span class="n">data</span><span class="o">,</span> <span class="n">headers</span><span class="o">);</span>

        <span class="n">getContentPane</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">JScrollPane</span><span class="o">(</span><span class="n">table</span><span class="o">),</span> <span class="n">BorderLayout</span><span class="o">.</span><span class="na">CENTER</span><span class="o">);</span>

        <span class="n">pack</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">new</span> <span class="nf">JTableBasicWithScrollPane</span><span class="o">().</span><span class="na">setVisible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
    <span class="o">}</span>
</pre></div>


<p>Now, we add directly the entire JTable in the JScrollPane. Here is the result :</p>
<p><a href="wp-content/uploads/2009/12/JTableBasicWithScrollPane.png"><img class="size-medium wp-image-47" title="JTable Basic With ScrollPane" src="wp-content/uploads/2009/12/JTableBasicWithScrollPane-300x152.png" alt="JTable Basic With ScrollPane" width="300" height="152"></a></p>
<p>This version is already better than the previous, but this is not the best approach. We will improve it in the next chapters.</p>
<!--nextpage-->

<h4>3. The table's model</h4>

<p>An essential thing to do is to use a table's model to manage the data. So, we must create a class implementing TableModel. In practice, we rarely directly implement TableModel, we normally extends AbstractTableModel and we define the necessary methods only. To start, here are the methods we must override for our static model :</p>
<ul>
    <li>int getRowCount() : Return the number of lines of the table.</li>
    <li>int getColumnCount() : Return the number of columns of the table.</li>
    <li>Object getValueAt(int rowIndex, int columnIndex) : Return the the value a the specified cell.</li>
    <li>String getColumnName(int columnIndex) : Return the header for the specified column</li>
</ul>

<p>We will create our first model. To start, we will let the data in a two-dimensional array :</p>
<div class="code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ModelStatic</span> <span class="kd">extends</span> <span class="n">AbstractTableModel</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">Object</span><span class="o">[][]</span> <span class="n">data</span><span class="o">;</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span><span class="o">[]</span> <span class="n">headers</span> <span class="o">=</span> <span class="o">{</span><span class="s">"First name"</span><span class="o">,</span> <span class="s">"Name"</span><span class="o">,</span> <span class="s">"Favourite color"</span><span class="o">,</span> <span class="s">"Gender"</span><span class="o">,</span> <span class="s">"Sport"</span><span class="o">};</span>

    <span class="kd">public</span> <span class="nf">ModelStatic</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">();</span>

        <span class="n">data</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[][]{</span>
                <span class="o">{</span><span class="s">"Johnathan"</span><span class="o">,</span> <span class="s">"Sykes"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">red</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">TENNIS</span><span class="o">},</span>
                <span class="o">{</span><span class="s">"Nicolas"</span><span class="o">,</span> <span class="s">"Van de Kampf"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">black</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">FOOTBALL</span><span class="o">},</span>
                <span class="o">{</span><span class="s">"Damien"</span><span class="o">,</span> <span class="s">"Cuthbert"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">cyan</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">NOTHING</span><span class="o">},</span>
                <span class="o">{</span><span class="s">"Corinne"</span><span class="o">,</span> <span class="s">"Valance"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">blue</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">SWIMMING</span><span class="o">},</span>
                <span class="o">{</span><span class="s">"Emilie"</span><span class="o">,</span> <span class="s">"Schrödinger"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">magenta</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">FOOTBALL</span><span class="o">},</span>
                <span class="o">{</span><span class="s">"Delphine"</span><span class="o">,</span> <span class="s">"Duke"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">yellow</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">TENNIS</span><span class="o">},</span>
                <span class="o">{</span><span class="s">"Eric"</span><span class="o">,</span> <span class="s">"Trump"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">pink</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">FOOTBALL</span><span class="o">},</span>
        <span class="o">};</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getRowCount</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getColumnCount</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">headers</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getColumnName</span><span class="o">(</span><span class="kt">int</span> <span class="n">columnIndex</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">headers</span><span class="o">[</span><span class="n">columnIndex</span><span class="o">];</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">Object</span> <span class="nf">getValueAt</span><span class="o">(</span><span class="kt">int</span> <span class="n">rowIndex</span><span class="o">,</span> <span class="kt">int</span> <span class="n">columnIndex</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">data</span><span class="o">[</span><span class="n">rowIndex</span><span class="o">][</span><span class="n">columnIndex</span><span class="o">];</span>
    <span class="o">}</span>
</pre></div>


<p>And we modify the JTable to use this model :</p>
<div class="code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">JTableBasicWithStaticModel</span> <span class="kd">extends</span> <span class="n">JFrame</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">JTableBasicWithStaticModel</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">();</span>

        <span class="n">setTitle</span><span class="o">(</span><span class="s">"JTable with static model"</span><span class="o">);</span>
        <span class="n">setDefaultCloseOperation</span><span class="o">(</span><span class="n">JFrame</span><span class="o">.</span><span class="na">EXIT_ON_CLOSE</span><span class="o">);</span>

        <span class="n">JTable</span> <span class="n">table</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JTable</span><span class="o">(</span><span class="k">new</span> <span class="n">ModelStatic</span><span class="o">());</span>

        <span class="n">getContentPane</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">JScrollPane</span><span class="o">(</span><span class="n">table</span><span class="o">),</span> <span class="n">BorderLayout</span><span class="o">.</span><span class="na">CENTER</span><span class="o">);</span>

        <span class="n">pack</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">new</span> <span class="nf">JTableBasicWithStaticModel</span><span class="o">().</span><span class="na">setVisible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</pre></div>


<p>So, we've created a class extending AbstractTableModel and overriding the essential methods. The data are always stored the same way, but this solution is more flexible and cleaner. If we watch the JFrame, we can see that there is no more data in this class, that's really better, isn't it ? Moreover, we have now total access to the data and the way they are stored. Nothing changed for the view :</p>
<p><a href="wp-content/uploads/2009/12/JTableBasicWithPanel.png"><img class="size-medium wp-image-46" title="JTable Basic With JPanel" src="wp-content/uploads/2009/12/JTableBasicWithPanel-300x127.png" alt="JTable Basic With JPanel" width="300" height="127"></a></p>
<p>We've now a good base, but we will improve it. Normally, it's extremely rer to have data directly in arrays. Java is an Object Orienter language, so we will use objects. We will create a class Friend :</p>
<div class="code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Friend</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">firstName</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Color</span> <span class="n">color</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">gender</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Sport</span> <span class="n">sport</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Friend</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">,</span> <span class="n">String</span> <span class="n">firstName</span><span class="o">,</span> <span class="n">Color</span> <span class="n">color</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">gender</span><span class="o">,</span> <span class="n">Sport</span> <span class="n">sport</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">();</span>

        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">firstName</span> <span class="o">=</span> <span class="n">firstName</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">color</span> <span class="o">=</span> <span class="n">color</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">gender</span> <span class="o">=</span> <span class="n">gender</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">sport</span> <span class="o">=</span> <span class="n">sport</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setName</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getFirstName</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">firstName</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setFirstName</span><span class="o">(</span><span class="n">String</span> <span class="n">firstName</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">firstName</span> <span class="o">=</span> <span class="n">firstName</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">Color</span> <span class="nf">getColor</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">color</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setColor</span><span class="o">(</span><span class="n">Color</span> <span class="n">color</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">color</span> <span class="o">=</span> <span class="n">color</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isGender</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">gender</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setGender</span><span class="o">(</span><span class="kt">boolean</span> <span class="n">gender</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">gender</span> <span class="o">=</span> <span class="n">gender</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">Sport</span> <span class="nf">getSport</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">sport</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setSport</span><span class="o">(</span><span class="n">Sport</span> <span class="n">sport</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">sport</span> <span class="o">=</span> <span class="n">sport</span><span class="o">;</span>
</pre></div>


<p>So, a simple data class. And we will use it in our model :</p>
<div class="code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ModelStaticObject</span> <span class="kd">extends</span> <span class="n">AbstractTableModel</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">Friend</span><span class="o">[]</span> <span class="n">friends</span><span class="o">;</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span><span class="o">[]</span> <span class="n">headers</span> <span class="o">=</span> <span class="o">{</span><span class="s">"First name"</span><span class="o">,</span> <span class="s">"Name"</span><span class="o">,</span> <span class="s">"Favourite color"</span><span class="o">,</span> <span class="s">"Gender"</span><span class="o">,</span> <span class="s">"Sport"</span><span class="o">};</span>

    <span class="kd">public</span> <span class="nf">ModelStaticObject</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">();</span>

        <span class="n">friends</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Friend</span><span class="o">[]{</span>
                <span class="k">new</span> <span class="nf">Friend</span><span class="o">(</span><span class="s">"Johnathan"</span><span class="o">,</span> <span class="s">"Sykes"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">red</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">TENNIS</span><span class="o">),</span>
                <span class="k">new</span> <span class="nf">Friend</span><span class="o">(</span><span class="s">"Nicolas"</span><span class="o">,</span> <span class="s">"Van de Kampf"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">black</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">FOOTBALL</span><span class="o">),</span>
                <span class="k">new</span> <span class="nf">Friend</span><span class="o">(</span><span class="s">"Damien"</span><span class="o">,</span> <span class="s">"Cuthbert"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">cyan</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">NOTHING</span><span class="o">),</span>
                <span class="k">new</span> <span class="nf">Friend</span><span class="o">(</span><span class="s">"Corinne"</span><span class="o">,</span> <span class="s">"Valance"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">blue</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">SWIMMING</span><span class="o">),</span>
                <span class="k">new</span> <span class="nf">Friend</span><span class="o">(</span><span class="s">"Emilie"</span><span class="o">,</span> <span class="s">"Schrödinger"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">magenta</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">FOOTBALL</span><span class="o">),</span>
                <span class="k">new</span> <span class="nf">Friend</span><span class="o">(</span><span class="s">"Delphine"</span><span class="o">,</span> <span class="s">"Duke"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">yellow</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">TENNIS</span><span class="o">),</span>
                <span class="k">new</span> <span class="nf">Friend</span><span class="o">(</span><span class="s">"Eric"</span><span class="o">,</span> <span class="s">"Trump"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">pink</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">FOOTBALL</span><span class="o">)</span>
        <span class="o">};</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getRowCount</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">friends</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getColumnCount</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">headers</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getColumnName</span><span class="o">(</span><span class="kt">int</span> <span class="n">columnIndex</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">headers</span><span class="o">[</span><span class="n">columnIndex</span><span class="o">];</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">Object</span> <span class="nf">getValueAt</span><span class="o">(</span><span class="kt">int</span> <span class="n">rowIndex</span><span class="o">,</span> <span class="kt">int</span> <span class="n">columnIndex</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">switch</span><span class="o">(</span><span class="n">columnIndex</span><span class="o">){</span>
            <span class="k">case</span> <span class="mi">0</span><span class="o">:</span>
                <span class="k">return</span> <span class="n">friends</span><span class="o">[</span><span class="n">rowIndex</span><span class="o">].</span><span class="na">getFirstName</span><span class="o">();</span>
            <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
                <span class="k">return</span> <span class="n">friends</span><span class="o">[</span><span class="n">rowIndex</span><span class="o">].</span><span class="na">getName</span><span class="o">();</span>
            <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
                <span class="k">return</span> <span class="n">friends</span><span class="o">[</span><span class="n">rowIndex</span><span class="o">].</span><span class="na">getColor</span><span class="o">();</span>
            <span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
                <span class="k">return</span> <span class="n">friends</span><span class="o">[</span><span class="n">rowIndex</span><span class="o">].</span><span class="na">isGender</span><span class="o">();</span>
            <span class="k">case</span> <span class="mi">4</span><span class="o">:</span>
                <span class="k">return</span> <span class="n">friends</span><span class="o">[</span><span class="n">rowIndex</span><span class="o">].</span><span class="na">getSport</span><span class="o">();</span>
            <span class="k">default</span><span class="o">:</span>
                <span class="k">return</span> <span class="kc">null</span><span class="o">;</span> <span class="c1">//Must never happens</span>
        <span class="o">}</span>
</pre></div>


<p>Now, the code starts to be interesting. It's now that we start to understand the purpose of a model. Now, if we want change the order of two columns, we just have to invert them in the getValueAt() method, but this would not have been possible without a model.</p>
<p>For the rendering, we just have to use the new model instead of the old one :</p>
<div class="code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">JTableBasicWithStaticModelObject</span> <span class="kd">extends</span> <span class="n">JFrame</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">JTableBasicWithStaticModelObject</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">();</span>

        <span class="n">setTitle</span><span class="o">(</span><span class="s">"JTable with static model and objects"</span><span class="o">);</span>
        <span class="n">setDefaultCloseOperation</span><span class="o">(</span><span class="n">JFrame</span><span class="o">.</span><span class="na">EXIT_ON_CLOSE</span><span class="o">);</span>

        <span class="n">JTable</span> <span class="n">table</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JTable</span><span class="o">(</span><span class="k">new</span> <span class="n">ModelStaticObject</span><span class="o">());</span>

        <span class="n">getContentPane</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">JScrollPane</span><span class="o">(</span><span class="n">table</span><span class="o">),</span> <span class="n">BorderLayout</span><span class="o">.</span><span class="na">CENTER</span><span class="o">);</span>

        <span class="n">pack</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">new</span> <span class="nf">JTableBasicWithStaticModelObject</span><span class="o">().</span><span class="na">setVisible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>Once again, nothing change in rendering. In the next chapter, we will make our table dynamic enabling to add/remove friends of the table.</p>
<!--nextpage-->

<h4>4. Add/Remove lines</h4>

<p>We will now make our application a litlle more interesting and especially make our model essential. It seems give the user the possibility to add/remove lines of the table. We will see at chapter 6 how to edit the values of the cells.</p>
<p>The first thing to do is to make our model dynamic. For that, we will add the methods addFriend() and removeFriend. To inform the table that there is changes on the data, we just have to call the fireXXX methods who are already defined in AbstractTableModel. Moreover, we must of course use a data structure who is dynamic. The array is not really useful for that. So we will use an ArrayList. Here is our dynamic model :</p>
<div class="code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">DynamicModelObject</span> <span class="kd">extends</span> <span class="n">AbstractTableModel</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">List</span> <span class="n">friends</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">();</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span><span class="o">[]</span> <span class="n">headers</span> <span class="o">=</span> <span class="o">{</span><span class="s">"First name"</span><span class="o">,</span> <span class="s">"Name"</span><span class="o">,</span> <span class="s">"Favourite color"</span><span class="o">,</span> <span class="s">"Gender"</span><span class="o">,</span> <span class="s">"Sport"</span><span class="o">};</span>

    <span class="kd">public</span> <span class="nf">DynamicModelObject</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">();</span>

        <span class="n">friends</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Friend</span><span class="o">(</span><span class="s">"Johnathan"</span><span class="o">,</span> <span class="s">"Sykes"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">red</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">TENNIS</span><span class="o">));</span>
        <span class="n">friends</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Friend</span><span class="o">(</span><span class="s">"Nicolas"</span><span class="o">,</span> <span class="s">"Van de Kampf"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">black</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">FOOTBALL</span><span class="o">));</span>
        <span class="n">friends</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Friend</span><span class="o">(</span><span class="s">"Damien"</span><span class="o">,</span> <span class="s">"Cuthbert"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">cyan</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">NOTHING</span><span class="o">));</span>
        <span class="n">friends</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Friend</span><span class="o">(</span><span class="s">"Corinne"</span><span class="o">,</span> <span class="s">"Valance"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">blue</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">SWIMMING</span><span class="o">));</span>
        <span class="n">friends</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Friend</span><span class="o">(</span><span class="s">"Emilie"</span><span class="o">,</span> <span class="s">"Schrödinger"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">magenta</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">FOOTBALL</span><span class="o">));</span>
        <span class="n">friends</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Friend</span><span class="o">(</span><span class="s">"Delphine"</span><span class="o">,</span> <span class="s">"Duke"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">yellow</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">TENNIS</span><span class="o">));</span>
        <span class="n">friends</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Friend</span><span class="o">(</span><span class="s">"Eric"</span><span class="o">,</span> <span class="s">"Trump"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">pink</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">FOOTBALL</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getRowCount</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">friends</span><span class="o">.</span><span class="na">size</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getColumnCount</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">headers</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getColumnName</span><span class="o">(</span><span class="kt">int</span> <span class="n">columnIndex</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">headers</span><span class="o">[</span><span class="n">columnIndex</span><span class="o">];</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">Object</span> <span class="nf">getValueAt</span><span class="o">(</span><span class="kt">int</span> <span class="n">rowIndex</span><span class="o">,</span> <span class="kt">int</span> <span class="n">columnIndex</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">switch</span><span class="o">(</span><span class="n">columnIndex</span><span class="o">){</span>
            <span class="k">case</span> <span class="mi">0</span><span class="o">:</span>
                <span class="k">return</span> <span class="n">friends</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">rowIndex</span><span class="o">).</span><span class="na">getFirstName</span><span class="o">();</span>
            <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
                <span class="k">return</span> <span class="n">friends</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">rowIndex</span><span class="o">).</span><span class="na">getName</span><span class="o">();</span>
            <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
                <span class="k">return</span> <span class="n">friends</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">rowIndex</span><span class="o">).</span><span class="na">getColor</span><span class="o">();</span>
            <span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
                <span class="k">return</span> <span class="n">friends</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">rowIndex</span><span class="o">).</span><span class="na">isGender</span><span class="o">();</span>
            <span class="k">case</span> <span class="mi">4</span><span class="o">:</span>
                <span class="k">return</span> <span class="n">friends</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">rowIndex</span><span class="o">).</span><span class="na">getSport</span><span class="o">();</span>
            <span class="k">default</span><span class="o">:</span>
                <span class="k">return</span> <span class="kc">null</span><span class="o">;</span> <span class="c1">//Must never happens</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addFriend</span><span class="o">(</span><span class="n">Friend</span> <span class="n">friend</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">friends</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">friend</span><span class="o">);</span>

        <span class="n">fireTableRowsInserted</span><span class="o">(</span><span class="n">friends</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">-</span><span class="mi">1</span><span class="o">,</span> <span class="n">friends</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">-</span><span class="mi">1</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">removeFriend</span><span class="o">(</span><span class="kt">int</span> <span class="n">rowIndex</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">friends</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">rowIndex</span><span class="o">);</span>

        <span class="n">fireTableRowsDeleted</span><span class="o">(</span><span class="n">rowIndex</span><span class="o">,</span> <span class="n">rowIndex</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>Nothing to hard. For the addFriend() method, we add the new Friend in the list and we inform the JTable of a new insert. For the removeFriend() method, we use the same principle, we start deleting the element from the list and we inform the JTable of the deletion.</p>
<p>Now we will add 2 actions in our user interface. The first to add a new friend (to make easier, it will always add the same object) and the second one to remove the selected elements. Here is what we will do :</p>
<div class="code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">JTableBasicWithDynamicModelObject</span> <span class="kd">extends</span> <span class="n">JFrame</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">DynamicModelObject</span> <span class="n">model</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DynamicModelObject</span><span class="o">();</span>

    <span class="kd">private</span> <span class="n">JTable</span> <span class="n">table</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">JTableBasicWithDynamicModelObject</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">();</span>

        <span class="n">setTitle</span><span class="o">(</span><span class="s">"JTable with dynamic model"</span><span class="o">);</span>
        <span class="n">setDefaultCloseOperation</span><span class="o">(</span><span class="n">JFrame</span><span class="o">.</span><span class="na">EXIT_ON_CLOSE</span><span class="o">);</span>

        <span class="n">table</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JTable</span><span class="o">(</span><span class="n">model</span><span class="o">);</span>

        <span class="n">getContentPane</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">JScrollPane</span><span class="o">(</span><span class="n">table</span><span class="o">),</span> <span class="n">BorderLayout</span><span class="o">.</span><span class="na">CENTER</span><span class="o">);</span>

        <span class="n">JPanel</span> <span class="n">buttons</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JPanel</span><span class="o">();</span>

        <span class="n">buttons</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">JButton</span><span class="o">(</span><span class="k">new</span> <span class="n">AddAction</span><span class="o">()));</span>
        <span class="n">buttons</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">JButton</span><span class="o">(</span><span class="k">new</span> <span class="n">RemoveAction</span><span class="o">()));</span>

        <span class="n">getContentPane</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">buttons</span><span class="o">,</span> <span class="n">BorderLayout</span><span class="o">.</span><span class="na">SOUTH</span><span class="o">);</span>

        <span class="n">pack</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">new</span> <span class="nf">JTableBasicWithDynamicModelObject</span><span class="o">().</span><span class="na">setVisible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">class</span> <span class="nc">AddAction</span> <span class="kd">extends</span> <span class="n">AbstractAction</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="nf">AddAction</span><span class="o">()</span> <span class="o">{</span>
            <span class="kd">super</span><span class="o">(</span><span class="s">"Add"</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">actionPerformed</span><span class="o">(</span><span class="n">ActionEvent</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">model</span><span class="o">.</span><span class="na">addFriend</span><span class="o">(</span><span class="k">new</span> <span class="n">Friend</span><span class="o">(</span><span class="s">"Megan"</span><span class="o">,</span> <span class="s">"Sami"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">green</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">SWIMMING</span><span class="o">));</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">class</span> <span class="nc">RemoveAction</span> <span class="kd">extends</span> <span class="n">AbstractAction</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="nf">RemoveAction</span><span class="o">()</span> <span class="o">{</span>
            <span class="kd">super</span><span class="o">(</span><span class="s">"Remove"</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">actionPerformed</span><span class="o">(</span><span class="n">ActionEvent</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="kt">int</span><span class="o">[]</span> <span class="n">selection</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="na">getSelectedRows</span><span class="o">();</span>

            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">selection</span><span class="o">.</span><span class="na">length</span> <span class="o">-</span> <span class="mi">1</span><span class="o">;</span> <span class="n">i</span> <span class="o">&amp;</span><span class="n">amp</span><span class="o">;</span><span class="n">gt</span><span class="o">;=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">--){</span>
                <span class="n">model</span><span class="o">.</span><span class="na">removeFriend</span><span class="o">(</span><span class="n">selection</span><span class="o">[</span><span class="n">i</span><span class="o">]);</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>The action to add a friend doesn't make something special and is quite easy. On the other side, there is little things to say about the remove action. First of all, we must know that a JTable can use several selection modes. We can set the selection mode, using the setSelectionMode() method. We can use this values from ListSelectionModel for the parameter mode :</p>
<ul>
    <li>SINGLE_SELECTION : only one line</li>
    <li>SINGLE_INTERVAL_SELECTION : one interval of lines</li>
    <li>MULTIPLE_INTERVAL_SELECTION : several intervals of lines. This is the default value.</li>
</ul>

<p>We must understand than the array of lines returned by the getSelectedRows method can return several intervals. The results are returned in ascending order. We must delete them from the end to not change the line's number of the preceding elements.</p>
<p>That will give us this result :</p>
<p><a href="wp-content/uploads/2009/12/JTableBasicWithDynamicModel.png"><img class="size-medium wp-image-52" title="JTable Basic With Dynamic Model" src="wp-content/uploads/2009/12/JTableBasicWithDynamicModel-300x226.png" alt="JTable Basic With Dynamic Model" width="300" height="226"></a></p>
<p>Like you can see, we just build a dynamic table without big problems. In the next chapter, we will solve the issues of Color and Gender column who are not really useful for the moment.</p>
<!--nextpage-->

<h4>5. Cells rendering</h4>

<p>We'll now customize the rendering of the cells. Here are the changes we are going to apply to our interface :</p>
<ul>
    <li>Display the real color instead of the toString() of the Color object</li>
    <li>Display the image of the gender</li>
    <li>Display the name of the fried in bold</li>
</ul>

<p>For that, we must start with specifying in the model which class correspond to which column. We can only configure renderer by column. Then, we can configure a renderer for each column class in the JTable. So the first thing to do is the override the getColumnClass() method in our model :</p>
<div class="code"><pre><span class="nd">@Override</span>

<span class="kd">public</span> <span class="n">Class</span> <span class="nf">getColumnClass</span><span class="o">(</span><span class="kt">int</span> <span class="n">columnIndex</span><span class="o">){</span>
    <span class="k">switch</span><span class="o">(</span><span class="n">columnIndex</span><span class="o">){</span>
        <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
            <span class="k">return</span> <span class="n">Color</span><span class="o">.</span><span class="na">class</span><span class="o">;</span>
        <span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
            <span class="k">return</span> <span class="n">Boolean</span><span class="o">.</span><span class="na">class</span><span class="o">;</span>
        <span class="k">default</span><span class="o">:</span>
            <span class="k">return</span> <span class="n">Object</span><span class="o">.</span><span class="na">class</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>Actually, this not really essential, because this is automatically made by AbstractTableModel. But i think, it's clearer.</p>
<p>We will now create our renderers. A renderer is a class implementing TableCellRenderer who is an interface containing only one method returning a Swing component. In practice, we generally extends DefaultCellRenderer who use a JLabel as renderer.</p>
<p>When it's possible, we must not create new object in a renderer if we've a lot of elements in our JTable. This would mean that a new object is created each time the table render a cell and that could degrade performance. That's why, we try to keep a single object modified each time we render a cell.</p>
<p>We will create our first renderer for the Color :</p>
<div class="code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ColorCellRenderer</span> <span class="kd">extends</span> <span class="n">DefaultTableCellRenderer</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Component</span> <span class="nf">getTableCellRendererComponent</span><span class="o">(</span><span class="n">JTable</span> <span class="n">table</span><span class="o">,</span> <span class="n">Object</span> <span class="n">value</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">isSelected</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">hasFocus</span><span class="o">,</span> <span class="kt">int</span> <span class="n">row</span><span class="o">,</span> <span class="kt">int</span> <span class="n">column</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">getTableCellRendererComponent</span><span class="o">(</span><span class="n">table</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="n">isSelected</span><span class="o">,</span> <span class="n">hasFocus</span><span class="o">,</span> <span class="n">row</span><span class="o">,</span> <span class="n">column</span><span class="o">);</span>

        <span class="n">Color</span> <span class="n">color</span> <span class="o">=</span> <span class="o">(</span><span class="n">Color</span><span class="o">)</span> <span class="n">value</span><span class="o">;</span>

        <span class="n">setBackground</span><span class="o">(</span><span class="n">color</span><span class="o">);</span>

        <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>It's extremely easy to implement this render. We just have to get the color of the Friend and to set it as the background of our JLabel. We can do the next renderer. For the gender, we will display an image for the gender :</p>
<div class="code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">GenderCellRenderer</span> <span class="kd">extends</span> <span class="n">DefaultTableCellRenderer</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">Icon</span> <span class="n">manImage</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Icon</span> <span class="n">womanImage</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">GenderCellRenderer</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">();</span>

        <span class="n">manImage</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ImageIcon</span><span class="o">(</span><span class="s">"man.png"</span><span class="o">);</span>
        <span class="n">womanImage</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ImageIcon</span><span class="o">(</span><span class="s">"woman.png"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Component</span> <span class="nf">getTableCellRendererComponent</span><span class="o">(</span><span class="n">JTable</span> <span class="n">table</span><span class="o">,</span> <span class="n">Object</span> <span class="n">value</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">isSelected</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">hasFocus</span><span class="o">,</span> <span class="kt">int</span> <span class="n">row</span><span class="o">,</span> <span class="kt">int</span> <span class="n">column</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">getTableCellRendererComponent</span><span class="o">(</span><span class="n">table</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="n">isSelected</span><span class="o">,</span> <span class="n">hasFocus</span><span class="o">,</span> <span class="n">row</span><span class="o">,</span> <span class="n">column</span><span class="o">);</span>

        <span class="n">Boolean</span> <span class="n">man</span> <span class="o">=</span> <span class="o">(</span><span class="n">Boolean</span><span class="o">)</span><span class="n">value</span><span class="o">;</span>

        <span class="k">if</span><span class="o">(</span><span class="n">man</span><span class="o">){</span>
            <span class="n">setIcon</span><span class="o">(</span><span class="n">manImage</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">setIcon</span><span class="o">(</span><span class="n">womanImage</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>We start with loading the images in the constructor. Then in the render method, we display the image corresponding to the gender. So, we can go to the last renderer :</p>
<div class="code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">BoldCellRenderer</span> <span class="kd">extends</span> <span class="n">DefaultTableCellRenderer</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">Font</span> <span class="n">boldFont</span> <span class="o">=</span> <span class="n">getFont</span><span class="o">().</span><span class="na">deriveFont</span><span class="o">(</span><span class="n">Font</span><span class="o">.</span><span class="na">BOLD</span><span class="o">);</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Component</span> <span class="nf">getTableCellRendererComponent</span><span class="o">(</span><span class="n">JTable</span> <span class="n">table</span><span class="o">,</span> <span class="n">Object</span> <span class="n">value</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">isSelected</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">hasFocus</span><span class="o">,</span> <span class="kt">int</span> <span class="n">row</span><span class="o">,</span> <span class="kt">int</span> <span class="n">column</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">getTableCellRendererComponent</span><span class="o">(</span><span class="n">table</span><span class="o">,</span> <span class="n">value</span><span class="o">,</span> <span class="n">isSelected</span><span class="o">,</span> <span class="n">hasFocus</span><span class="o">,</span> <span class="n">row</span><span class="o">,</span> <span class="n">column</span><span class="o">);</span>

        <span class="n">setFont</span><span class="o">(</span><span class="n">boldFont</span><span class="o">);</span>

        <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
   <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>Nothing to say here, it's more than trivial. We can now configure the renderers in the JTable :</p>
<div class="code"><pre><span class="n">table</span><span class="o">.</span><span class="na">setDefaultRenderer</span><span class="o">(</span><span class="n">Boolean</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="k">new</span> <span class="n">GenderCellRenderer</span><span class="o">());</span>

<span class="n">table</span><span class="o">.</span><span class="na">setDefaultRenderer</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="k">new</span> <span class="n">ColorCellRenderer</span><span class="o">());</span>

<span class="n">table</span><span class="o">.</span><span class="na">getColumnModel</span><span class="o">().</span><span class="na">getColumn</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="na">setCellRenderer</span><span class="o">(</span><span class="k">new</span> <span class="n">BoldCellRenderer</span><span class="o">());</span>
</pre></div>


<p>For the two firsts, we can directly linked them to a column class, but for the bold renderer, we cannot linked it to String because, we want it only on the name and not for the firstname. This will give us this result :</p>
<p><a href="wp-content/uploads/2009/12/JTableWithRenderer.png"><img class="size-medium wp-image-56" title="JTable With Renderers" src="wp-content/uploads/2009/12/JTableWithRenderer-300x237.png" alt="JTable With Renderers" width="300" height="237"></a></p>
<p>This time, we have something a lot more interesting visually. You can also dorenderers more sophisticated with other components than JLabel like a JPanel of why not, a JTable.</p>
<p>In the next chapter, we will enable the edition of the values of the table.</p>
<!--nextpage-->

<h4>6. Enable to edit cells</h4>

<p>We will now make our table editable. For that, we must start to make our model editable. So, we have to override the isCellEditable(int row, int column), method who indicates which cells are editables. In our case, all the cells will be editables. Then, we must apply the modifications, so we have to override the setValueAt(Object value, int column, int row) method who's automatically called when the user validate the modification. Moreover, we must also edit our getColumnClass method to add the Sport class for the 4th column because we also want to edit it. So here is our modified model :</p>
<div class="code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ModelEditable</span> <span class="kd">extends</span> <span class="n">AbstractTableModel</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">List</span> <span class="n">friends</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">();</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span><span class="o">[]</span> <span class="n">headers</span> <span class="o">=</span> <span class="o">{</span><span class="s">"First name"</span><span class="o">,</span> <span class="s">"Name"</span><span class="o">,</span> <span class="s">"Favourite color"</span><span class="o">,</span> <span class="s">"Gender"</span><span class="o">,</span> <span class="s">"Sport"</span><span class="o">};</span>

    <span class="kd">public</span> <span class="nf">ModelEditable</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">();</span>

        <span class="n">friends</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Friend</span><span class="o">(</span><span class="s">"Johnathan"</span><span class="o">,</span> <span class="s">"Sykes"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">red</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">TENNIS</span><span class="o">));</span>
        <span class="n">friends</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Friend</span><span class="o">(</span><span class="s">"Nicolas"</span><span class="o">,</span> <span class="s">"Van de Kampf"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">black</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">FOOTBALL</span><span class="o">));</span>
        <span class="n">friends</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Friend</span><span class="o">(</span><span class="s">"Damien"</span><span class="o">,</span> <span class="s">"Cuthbert"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">cyan</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">NOTHING</span><span class="o">));</span>
        <span class="n">friends</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Friend</span><span class="o">(</span><span class="s">"Corinne"</span><span class="o">,</span> <span class="s">"Valance"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">blue</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">SWIMMING</span><span class="o">));</span>
        <span class="n">friends</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Friend</span><span class="o">(</span><span class="s">"Emilie"</span><span class="o">,</span> <span class="s">"Schrödinger"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">magenta</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">FOOTBALL</span><span class="o">));</span>
        <span class="n">friends</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Friend</span><span class="o">(</span><span class="s">"Delphine"</span><span class="o">,</span> <span class="s">"Duke"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">yellow</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">TENNIS</span><span class="o">));</span>
        <span class="n">friends</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Friend</span><span class="o">(</span><span class="s">"Eric"</span><span class="o">,</span> <span class="s">"Trump"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">pink</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="n">Sport</span><span class="o">.</span><span class="na">FOOTBALL</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getRowCount</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">friends</span><span class="o">.</span><span class="na">size</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getColumnCount</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">headers</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getColumnName</span><span class="o">(</span><span class="kt">int</span> <span class="n">columnIndex</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">headers</span><span class="o">[</span><span class="n">columnIndex</span><span class="o">];</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">Object</span> <span class="nf">getValueAt</span><span class="o">(</span><span class="kt">int</span> <span class="n">rowIndex</span><span class="o">,</span> <span class="kt">int</span> <span class="n">columnIndex</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">switch</span><span class="o">(</span><span class="n">columnIndex</span><span class="o">){</span>
            <span class="k">case</span> <span class="mi">0</span><span class="o">:</span>
                <span class="k">return</span> <span class="n">friends</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">rowIndex</span><span class="o">).</span><span class="na">getFirstName</span><span class="o">();</span>
            <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
                <span class="k">return</span> <span class="n">friends</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">rowIndex</span><span class="o">).</span><span class="na">getName</span><span class="o">();</span>
            <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
                <span class="k">return</span> <span class="n">friends</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">rowIndex</span><span class="o">).</span><span class="na">getColor</span><span class="o">();</span>
            <span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
                <span class="k">return</span> <span class="n">friends</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">rowIndex</span><span class="o">).</span><span class="na">isGender</span><span class="o">();</span>
            <span class="k">case</span> <span class="mi">4</span><span class="o">:</span>
                <span class="k">return</span> <span class="n">friends</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">rowIndex</span><span class="o">).</span><span class="na">getSport</span><span class="o">();</span>
            <span class="k">default</span><span class="o">:</span>
                <span class="k">return</span> <span class="kc">null</span><span class="o">;</span> <span class="c1">//Must never happens</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Class</span> <span class="nf">getColumnClass</span><span class="o">(</span><span class="kt">int</span> <span class="n">columnIndex</span><span class="o">){</span>
        <span class="k">switch</span><span class="o">(</span><span class="n">columnIndex</span><span class="o">){</span>
            <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
                <span class="k">return</span> <span class="n">Color</span><span class="o">.</span><span class="na">class</span><span class="o">;</span>
            <span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
                <span class="k">return</span> <span class="n">Boolean</span><span class="o">.</span><span class="na">class</span><span class="o">;</span>
            <span class="k">case</span> <span class="mi">4</span> <span class="o">:</span>
                <span class="k">return</span> <span class="n">Sport</span><span class="o">.</span><span class="na">class</span><span class="o">;</span>
            <span class="k">default</span><span class="o">:</span>
                <span class="k">return</span> <span class="n">Object</span><span class="o">.</span><span class="na">class</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isCellEditable</span><span class="o">(</span><span class="kt">int</span> <span class="n">rowIndex</span><span class="o">,</span> <span class="kt">int</span> <span class="n">columnIndex</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="kc">true</span><span class="o">;</span> <span class="c1">//All the cells editable</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setValueAt</span><span class="o">(</span><span class="n">Object</span> <span class="n">aValue</span><span class="o">,</span> <span class="kt">int</span> <span class="n">rowIndex</span><span class="o">,</span> <span class="kt">int</span> <span class="n">columnIndex</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span><span class="n">aValue</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">){</span>
            <span class="n">Friend</span> <span class="n">friend</span> <span class="o">=</span> <span class="n">friends</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">rowIndex</span><span class="o">);</span>

            <span class="k">switch</span><span class="o">(</span><span class="n">columnIndex</span><span class="o">){</span>
                <span class="k">case</span> <span class="mi">0</span><span class="o">:</span>
                    <span class="n">friend</span><span class="o">.</span><span class="na">setFirstName</span><span class="o">((</span><span class="n">String</span><span class="o">)</span><span class="n">aValue</span><span class="o">);</span>
                    <span class="k">break</span><span class="o">;</span>
                <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
                    <span class="n">friend</span><span class="o">.</span><span class="na">setName</span><span class="o">((</span><span class="n">String</span><span class="o">)</span><span class="n">aValue</span><span class="o">);</span>
                    <span class="k">break</span><span class="o">;</span>
                <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
                    <span class="n">friend</span><span class="o">.</span><span class="na">setColor</span><span class="o">((</span><span class="n">Color</span><span class="o">)</span><span class="n">aValue</span><span class="o">);</span>
                    <span class="k">break</span><span class="o">;</span>
                <span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
                    <span class="n">friend</span><span class="o">.</span><span class="na">setGender</span><span class="o">((</span><span class="n">Boolean</span><span class="o">)</span><span class="n">aValue</span><span class="o">);</span>
                    <span class="k">break</span><span class="o">;</span>
                <span class="k">case</span> <span class="mi">4</span><span class="o">:</span>
                    <span class="n">friend</span><span class="o">.</span><span class="na">setSport</span><span class="o">((</span><span class="n">Sport</span><span class="o">)</span><span class="n">aValue</span><span class="o">);</span>
                    <span class="k">break</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addFriend</span><span class="o">(</span><span class="n">Friend</span> <span class="n">friend</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">friends</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">friend</span><span class="o">);</span>

        <span class="n">fireTableRowsInserted</span><span class="o">(</span><span class="n">friends</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">-</span><span class="mi">1</span><span class="o">,</span> <span class="n">friends</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">-</span><span class="mi">1</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">removeFriend</span><span class="o">(</span><span class="kt">int</span> <span class="n">rowIndex</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">friends</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">rowIndex</span><span class="o">);</span>

        <span class="n">fireTableRowsDeleted</span><span class="o">(</span><span class="n">rowIndex</span><span class="o">,</span> <span class="n">rowIndex</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>The first method return true because all the cells are editable. The second return the modified friend and function of the column modify the good property of the Friend object.</p>
<p>Now our model is editable, but this is not enough to work alone because JTable doesn't know how to edit Color, Sport or Gender by default. We must use a new concept, the TableCellEditor. An editor is simpley an object enabling to edit a cell. By default, JTable can edit directly all the objects with a JTextField and the Boolean with checkbox. In our case, it will work with the name and first, but doesn't work with the other columns. So we must create 3 editors.</p>
<p>The first and the most simple is the one for the Sport column. For that, we'll use a simple combo box. It's more than simple because the DefaultCellEditor can take JComboBox in parameter. So we'll use it :</p>
<div class="code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SportCellEditor</span> <span class="kd">extends</span> <span class="n">DefaultCellEditor</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">SportCellEditor</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="k">new</span> <span class="n">JComboBox</span><span class="o">(</span><span class="n">Sport</span><span class="o">.</span><span class="na">value</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>We can see that create an editor for an enumerated type is extremely easy.</p>
<p>We will now go to the editor for the color. We could use a text field with the hexadecimal value of the color or 3 text fields with each RGB component, but it would not be very practice for the user. We've a good color chooser in Swing, so we can use it. On the other side, we cannot directly use it as editor. We must use a button who display the JColorChooser. This will show us how to do an editor a little more complicated. So here is a color editor :</p>
<div class="code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ColorCellEditor</span> <span class="kd">extends</span> <span class="n">AbstractCellEditor</span> <span class="kd">implements</span> <span class="n">TableCellEditor</span><span class="o">,</span> <span class="n">ActionListener</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">Color</span> <span class="n">color</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">JButton</span> <span class="n">button</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">JColorChooser</span> <span class="n">colorChooser</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">JDialog</span> <span class="n">dialog</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">ColorCellEditor</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">();</span>

        <span class="n">button</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JButton</span><span class="o">();</span>
        <span class="n">button</span><span class="o">.</span><span class="na">setActionCommand</span><span class="o">(</span><span class="s">"change"</span><span class="o">);</span>
        <span class="n">button</span><span class="o">.</span><span class="na">addActionListener</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
        <span class="n">button</span><span class="o">.</span><span class="na">setBorderPainted</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>

        <span class="n">colorChooser</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JColorChooser</span><span class="o">();</span>
        <span class="n">dialog</span> <span class="o">=</span> <span class="n">JColorChooser</span><span class="o">.</span><span class="na">createDialog</span><span class="o">(</span><span class="n">button</span><span class="o">,</span> <span class="s">"Pick a Color"</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="n">colorChooser</span><span class="o">,</span> <span class="k">this</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">actionPerformed</span><span class="o">(</span><span class="n">ActionEvent</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="s">"change"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getActionCommand</span><span class="o">()))</span> <span class="o">{</span>
            <span class="n">button</span><span class="o">.</span><span class="na">setBackground</span><span class="o">(</span><span class="n">color</span><span class="o">);</span>
            <span class="n">colorChooser</span><span class="o">.</span><span class="na">setColor</span><span class="o">(</span><span class="n">color</span><span class="o">);</span>
            <span class="n">dialog</span><span class="o">.</span><span class="na">setVisible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>

            <span class="n">fireEditingStopped</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">color</span> <span class="o">=</span> <span class="n">colorChooser</span><span class="o">.</span><span class="na">getColor</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Object</span> <span class="nf">getCellEditorValue</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">color</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Component</span> <span class="nf">getTableCellEditorComponent</span><span class="o">(</span><span class="n">JTable</span> <span class="n">table</span><span class="o">,</span> <span class="n">Object</span> <span class="n">value</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">isSelected</span><span class="o">,</span> <span class="kt">int</span> <span class="n">row</span><span class="o">,</span> <span class="kt">int</span> <span class="n">column</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">color</span> <span class="o">=</span> <span class="o">(</span><span class="n">Color</span><span class="o">)</span><span class="n">value</span><span class="o">;</span>

        <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>This time, we can see that it is a little more hard. The TableCellEditor itself is a JButton. The getTableCellEditorComponent method must return the editor component. The getCellEditorValue method retourne the edited value. We call the fireEditingStopped method when the edition is finished to say to the JTable to display again the renderer.</p>
<p>And the last one for the gender. Once again, we have several solutions : a list with both choices, radio buttons, checkbox, .... In our case, we'll do very simple. A simple button that changes the gender each times the user click :</p>
<div class="code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">GenderCellEditor</span> <span class="kd">extends</span> <span class="n">AbstractCellEditor</span> <span class="kd">implements</span> <span class="n">TableCellEditor</span><span class="o">,</span> <span class="n">ActionListener</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">gender</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">JButton</span> <span class="n">button</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">GenderCellEditor</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">();</span>

        <span class="n">button</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JButton</span><span class="o">();</span>
        <span class="n">button</span><span class="o">.</span><span class="na">addActionListener</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
        <span class="n">button</span><span class="o">.</span><span class="na">setBorderPainted</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">actionPerformed</span><span class="o">(</span><span class="n">ActionEvent</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">gender</span> <span class="o">^=</span> <span class="kc">true</span><span class="o">;</span>

        <span class="n">fireEditingStopped</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Object</span> <span class="nf">getCellEditorValue</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">gender</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Component</span> <span class="nf">getTableCellEditorComponent</span><span class="o">(</span><span class="n">JTable</span> <span class="n">table</span><span class="o">,</span> <span class="n">Object</span> <span class="n">value</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">isSelected</span><span class="o">,</span> <span class="kt">int</span> <span class="n">row</span><span class="o">,</span> <span class="kt">int</span> <span class="n">column</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">gender</span> <span class="o">=</span> <span class="o">(</span><span class="n">Boolean</span><span class="o">)</span><span class="n">value</span><span class="o">;</span>

        <span class="k">return</span> <span class="n">button</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>We keep the simple principle than for color choice except that this time, its easier. We just have to invert the boolean value and return it.</p>
<p>Finally, we configure our JTable with our editors :</p>
<div class="code"><pre><span class="n">table</span><span class="o">.</span><span class="na">setDefaultEditor</span><span class="o">(</span><span class="n">Sport</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="k">new</span> <span class="n">SportCellEditor</span><span class="o">());</span>
<span class="n">table</span><span class="o">.</span><span class="na">setDefaultEditor</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="k">new</span> <span class="n">ColorCellEditor</span><span class="o">());</span>
<span class="n">table</span><span class="o">.</span><span class="na">setDefaultEditor</span><span class="o">(</span><span class="n">Boolean</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="k">new</span> <span class="n">GenderCellEditor</span><span class="o">());</span>
</pre></div>


<p>The principle is the same than for renderers, we've an editor by column class. So here is the result of the edition of a color :</p>
<p><a href="wp-content/uploads/2009/12/JTableWithEditor.png"><img class="size-medium wp-image-55" title="JTable With Editor" src="wp-content/uploads/2009/12/JTableWithEditor-300x282.png" alt="JTable With Editor" width="300" height="282"></a></p>
<p>We've a now a tablea fully functional. In the next chapters, we will improve the table enabling to sort/filter the content of the table.</p>
<!--nextpage-->

<h4>7. Sort content</h4>

<p>We will now make our table sortable by column. This give the possibility to a user to sort the contenu of all the table using a column for index only by clicking on a header column. This is done with a RowSorter object. The JTable has a method to enable a default sorter : d'activer un sorter par défaut :</p>
<div class="code"><pre><span class="n">table</span><span class="o">.</span><span class="na">setAutoCreateRowSorter</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</pre></div>


<p>This will sort all the column of class String in alphabetical order depending on the current Locale, the columns of a class implementing Comparable with their compareTo() order and the other columns with the alphabetical order of the toString() value.</p>
<p>In most of the case, it's enough. But we can customize the sorter. Of course, we could create our custom RowSorter, but it's easier to use the TableRowSorter class and to customize it to make our changes instead of create a new implementation. Here are a way to customize the sorter :</p>
<div class="code"><pre><span class="n">TableRowSorter</span> <span class="n">sorter</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TableRowSorter</span><span class="o">(</span><span class="n">table</span><span class="o">.</span><span class="na">getModel</span><span class="o">());</span>
<span class="n">table</span><span class="o">.</span><span class="na">addSorter</span><span class="o">(</span><span class="n">sorter</span><span class="o">);</span>
</pre></div>


<p>The first thing we can do is to specify a column not sortable with the setSortable method :</p>
<div class="code"><pre><span class="n">sorter</span><span class="o">.</span><span class="na">setSortable</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>
</pre></div>


<p>This code set the column "Color" non sortable. Then, we can also indicate to the sorter if it must sort the table after an update in the model :</p>
<div class="code"><pre><span class="n">sorter</span><span class="o">.</span><span class="na">setSortsOnUpdates</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</pre></div>


<p>This code indicate the sorter that it must resort the table after each modification of the data. An other interesting thing is that we can specify our custom comparator for a specific column. In our case, this is what we need for the Color column, because Color doesn't implement Comparable and so, is sorted by its toString() value what is not very useful. We will sort the Color by its blue level. We start defining a Comparator for our Color :</p>
<div class="code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ColorComparator</span> <span class="kd">implements</span> <span class="n">Comparator</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">compare</span><span class="o">(</span><span class="n">Color</span> <span class="n">c1</span><span class="o">,</span> <span class="n">Color</span> <span class="n">c2</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Integer</span><span class="o">(</span><span class="n">c1</span><span class="o">.</span><span class="na">getBlue</span><span class="o">()).</span><span class="na">compareTo</span><span class="o">(</span><span class="n">c2</span><span class="o">.</span><span class="na">getBlue</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>Then, we specify that the column 2 must use this new comparator :</p>
<div class="code"><pre><span class="n">sorter</span><span class="o">.</span><span class="na">setComparator</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="k">new</span> <span class="n">ColorComparator</span><span class="o">());</span>
</pre></div>


<p>Here is what it will display after a sort on the Color column :</p>
<p><a href="wp-content/uploads/2009/12/JTableSortable.png"><img class="size-medium wp-image-54" title="Sortable JTable" src="wp-content/uploads/2009/12/JTableSortable-300x181.png" alt="Sortable JTable" width="300" height="181"></a></p>
<p>You can see that it's very easy to sort a table.</p>
<p>But now, when the table is sorted, we will have problemsn to delete lines. You can try with the current code if you sort the table and then try removing lines. You will see that the removed lines are not good ones. What happens ?</p>
<p>Because the returned index by the getSelectedRows() method are the index in the view, not the model. When the table isn't sorted, this two sort of indexes are the same. So there is no problem. But when the table is sorted, the two indexes are not corresponding. We can easily solve this problem using the convertRowIndexTomodel() method of the RowSorter class. This method convert an index of the view to an index of the model. We will correct our RemoveAction with this new method :</p>
<div class="code"><pre><span class="kd">private</span> <span class="kd">class</span> <span class="nc">RemoveAction</span> <span class="kd">extends</span> <span class="n">AbstractAction</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nf">RemoveAction</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="s">"Remove"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">actionPerformed</span><span class="o">(</span><span class="n">ActionEvent</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span><span class="o">[]</span> <span class="n">selection</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="na">getSelectedRows</span><span class="o">();</span>
        <span class="kt">int</span><span class="o">[]</span> <span class="n">modelIndexes</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="n">selection</span><span class="o">.</span><span class="na">length</span><span class="o">];</span>

        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&amp;</span><span class="n">amp</span><span class="o">;</span><span class="n">lt</span><span class="o">;</span> <span class="n">selection</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++){</span>             
            <span class="n">modelIndexes</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="na">getRowSorter</span><span class="o">().</span><span class="na">convertRowIndexToModel</span><span class="o">(</span><span class="n">selection</span><span class="o">[</span><span class="n">i</span><span class="o">]);</span>         
        <span class="o">}</span>         

        <span class="n">Arrays</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">modelIndexes</span><span class="o">);</span>         

        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">modelIndexes</span><span class="o">.</span><span class="na">length</span> <span class="o">-</span> <span class="mi">1</span><span class="o">;</span> <span class="n">i</span> <span class="o">&amp;</span><span class="n">amp</span><span class="o">;</span><span class="n">gt</span><span class="o">;=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">--){</span>
            <span class="n">model</span><span class="o">.</span><span class="na">removeFriend</span><span class="o">(</span><span class="n">modelIndexes</span><span class="o">[</span><span class="n">i</span><span class="o">]);</span> 
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>We start with getting the indexes of the views, then we convert them to indexes of the model. And finally we sort them to delete the elements from the end. You will see that with this new action the deletion of elements will work fine.</p>
<p>At the next chapter, we will extends this feature enabling to filter the content of the table.</p>
<!--nextpage-->

<h4>8. Filter content</h4>

<p>In addition to sort the table, the RowSorter class enable also to filter the content of the table. We can use for that the setRowFilter method who takes a RowFilter in parameter. RowFilter has several static methods to easily create filters. So we have methods to make "and" or "or" operations on filters. Moreover we've also a very useful method to create a regex filter for one or more columns.</p>
<p>We will add a button to filter on the "name" and "firstname" columns :</p>
<div class="code"><pre><span class="kd">private</span> <span class="kd">class</span> <span class="nc">FilterAction</span> <span class="kd">extends</span> <span class="n">AbstractAction</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nf">FilterAction</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="s">"Filter"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">actionPerformed</span><span class="o">(</span><span class="n">ActionEvent</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">regex</span> <span class="o">=</span> <span class="n">JOptionPane</span><span class="o">.</span><span class="na">showInputDialog</span><span class="o">(</span><span class="s">"Filter regex : "</span><span class="o">);</span>

        <span class="n">sorter</span><span class="o">.</span><span class="na">setRowFilter</span><span class="o">(</span><span class="n">RowFilter</span><span class="o">.</span><span class="na">regexFilter</span><span class="o">(</span><span class="n">regex</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>Like you can see, it's very easy to filter the content of table on one or several columns. Here is the result with a filter "mp" :</p>
<p><a href="wp-content/uploads/2009/12/JTableFilterable.png"><img class="size-medium wp-image-53" title="Filterable JTable" src="wp-content/uploads/2009/12/JTableFilterable-300x150.png" alt="Filterable JTable" width="300" height="150"></a></p>
<p>For flexibility, you can also extends RowFilter who has only one methods include(Entry entry) who indicates if a line must be included in the table or not.</p>
<!--nextpage-->

<h4>9. Conclusion</h4>

<p>Here we are. We have now covered all the main aspects of the creation and manipulation of tables (JTable) with Swing. I hope than this tutorial enable you to master this component who is, once the aspects undestood, not that hard to use.</p></div>
        </div>
            
        
    <p>
        <a href="posts/2009/12/swing-user-interface-jtable.html#disqus_thread" data-disqus-identifier="cache/posts/2009/12/swing-user-interface-jtable.html">Comments</a>


        </p></article>
        <article class="postbox h-entry post-text">
        <h1 class="p-name"><a href="posts/2009/12/jtheque-movies-1-0.html" class="u-url">JTheque Movies 1.0</a>
        <br><small>  
             Posted: <time class="published dt-published" datetime="2009-12-23T13:31:27+01:00">2009-12-23 13:31</time>
        </small></h1>
        <hr>
        <div class="e-content">
        <div><p>I finished the development of <strong>JTheque Movies 1.0</strong> :)</p>
<p>This application enable the user to manage a collection of movies and to read them directly in the application. For this last functionality, on Windows, you need Windows Media Player and on Linux you need VLC Media Player as web plugin. The user interface has been completely remade to be more esthetic.</p>
<!--more-->

<p>Here are two screenshots of this new versions.</p>
<p><a href="wp-content/uploads/2010/03/JTheque-Movies-1.0-1.png"><img alt="JTheque Movies 1.0 - View Movie" src="wp-content/uploads/2010/03/JTheque-Movies-1.0-1-300x233.png" title="JTheque Movies 1.0 - View Movie"></a>
<a href="wp-content/uploads/2010/03/JTheque-Movies-1.0-2.png"><img alt="JTheque Movies 1.0 - Play Movie" src="wp-content/uploads/2010/03/JTheque-Movies-1.0-2-300x233.png" title="JTheque Movies 1.0 - Play Movie"></a></p>
<p>You can download the both versions here :</p>
<ul>
    <li><a href="http://projets.developpez.com/attachments/download/345/JTheque_Movies_1.0_Windows.zip">Windows Version</a></li>
    <li><a href="http://projets.developpez.com/attachments/download/344/JTheque_Movies_1.0_Linux.zip">Linux Version</a></li>
</ul>

<p>This version integrate this modules (french forge) :</p>
<ul>
    <li><a href="http://projets.developpez.com/projects/show/jtheque-movies-mod">JTheque Movies Module 1.3</a></li>
    <li><a href="http://projets.developpez.com/projects/show/jtheque-memory-mod">JTheque Memory Module 1.4.1</a></li>
    <li><a href="http://projets.developpez.com/projects/show/jtheque-tools-mod">JTheque Tools Module 1.0.2</a></li>
</ul>

<p>All the sources of this modules and of the core (JTheque Core) are all availabes under GPL V3 on the project management system (<a href="http://projets.developpez.com">here (French)</a>).</p>
<p>I hope that this program will be useful for somebody.</p></div>
        </div>
            
        
    <p>
        <a href="posts/2009/12/jtheque-movies-1-0.html#disqus_thread" data-disqus-identifier="cache/posts/2009/12/jtheque-movies-1-0.html">Comments</a>


        </p></article>
        <article class="postbox h-entry post-text">
        <h1 class="p-name"><a href="posts/2009/12/improve-performance-web-site.html" class="u-url">Improve performance of your web site with Page Speed</a>
        <br><small>  
             Posted: <time class="published dt-published" datetime="2009-12-15T07:55:29+01:00">2009-12-15 07:55</time>
        </small></h1>
        <hr>
        <div class="e-content">
        <div><p>Page Speed is a Firefox addon who add a new functionality to Firebug enabling the user to evaluate and improve the performances of a web site.</p>
<p>Although as improving perofrmances of a web site is no longer as critical as in the past with the evolution of new technologies, this has some advantages :</p>
<ul>
    <li>Make your site faster and logically more cumfortable for users. Moreover, all the users doesn't have broadband and improve the rendering speed can save users.</li>
    <li>Reduce the used bandwith and the hosting costs</li>
    <li>Improve the web itself respecting some simple rules.</li>
</ul>

<p>Discover how to achieve this objectives with Page Speed.</p>
<!--more-->

<p>Page Speed needs Firebug to work because it add a new tab to the Firebug view. The installation is very simple. You just have to download the plugin from the <a href="http://code.google.com/intl/fr/speed/page-speed/download.html">official page</a> and to install it like any other Firefox plugin.</p>
<p>Then, you can launch Firebug and you should see a new tab "Page speed" :</p>
<p><img title="Page Speed" src="http://baptiste-wicht.developpez.com/public/images/Page-Speed.png" alt="Page Speed"></p>
<p>You can now launch the analysis with the "Analyze Performance" button. Once the scan is complete (a few seconds normally), Page Speed will indicate what are the critical points of your web page.</p>
<p>The advices are grouped into 5 categories :</p>
<ul>
    <li>Improve caching : Verify that the most of the objects can be cached</li>
    <li>Minimize the number of requests grouping the different requests</li>
    <li>Minimize the size of the request</li>
    <li>Minimize the size of the page</li>
    <li>Improve browser rendering</li>
</ul>

<p>You can see the complete list of best practices on the <a href="http://code.google.com/intl/fr/speed/page-speed/docs/rules_intro.html">site of Page Speed</a>.</p>
<p>Here are some example advices it can give to you :</p>
<ul>
    <li>CSS : Combine CSS files in a single file to limit requests, delete unused CSS and minimize the size of CSS file compacting it.</li>
    <li>Optimize images. This functionality is very interesting and provide directly an optimized version of images, it seems a lighter image but with the same quality. I use a lot this function.</li>
    <li>Minimize Javascript code</li>
    <li>Enable GZip compression on all the pages. That could save more than 80% of the bandwith.</li>
    <li>Parrallelize downloads distributing across several domains.</li>
    <li>etc...</li>
</ul>

<p>For fast all advices, the plugin say you how to solve the problem and improve the performances.</p>
<p>To conclude, i would say that this plugin is essential for everybody who want to keep its web site faster.</p>
<p>Links :</p>
<ul>
    <li><a href="http://code.google.com/intl/fr/speed/page-speed/">Page Speed on Google Code</a></li>
    <li><a href="http://code.google.com/intl/fr/speed/page-speed/docs/rules_intro.html">Best practices for web performances</a></li>
</ul></div>
        </div>
            
        
    <p>
        <a href="posts/2009/12/improve-performance-web-site.html#disqus_thread" data-disqus-identifier="cache/posts/2009/12/improve-performance-web-site.html">Comments</a>


        </p></article>
        <article class="postbox h-entry post-text">
        <h1 class="p-name"><a href="posts/2009/12/intellij-idea-9-review.html" class="u-url">Review of Jetbrains Intellij Idea 9 Ultimate Edition</a>
        <br><small>  
             Posted: <time class="published dt-published" datetime="2009-12-14T06:01:11+01:00">2009-12-14 06:01</time>
        </small></h1>
        <hr>
        <div class="e-content">
        <div><p>Here is my review of the IDE Jetbrains Intellij Idea 9 Ultimate Edition.</p>
<h4>1. Introduction</h4>

<p>JetBrains just released the 9 version of Intellij Idea. This version is available in two editions :</p>
<ul>
    <li><strong>Community Edition</strong> : Opensource version and free. Contains only the basic functionalities of the IDE.</li>
    <li><strong>Ultimate Edition</strong> : Complete commercial version of the IDE. I am going to introduce here this version.</li>
</ul>

<p>This IDE is principally made for Java development, but now supports also a lot of others languages : JavaScript/Flex, HTML/XHTML/CSS, XML/XSL, Ruby/JRuby, Groovy, SQL, FreeMarker/Velocity and PHP.</p>
<p>For Java Development, it supports numerous frameworks and technologies : JSP, JSF, EJB, AJAX, GWT, Struts, Struts 2, JBoss Seam, Spring, JPA/Hibernate, Web Services, Rails, Grails, Java ME MIDP/CLDC, Tapestry, Google App Engine, Android or OSGi.</p>
<p>I am going to introduce some of this news functionalités and give you my opinion about the different themes.</p>
<p><img alt="IntelliJ Idea 9 loading view" src="wp-content/uploads/2009/12/splashscreen-300x224.png" title="IntelliJ Idea 9 loading view"></p>
<h4>2. Installation</h4>

<p>The installation is very easy. It's a common installer like all others instlallers you can found, with the basic operations : License, folder, shortcuts, start menu and finish. Nothing special about that.</p>
<p>Once installation is complete, we must enter the license and choose the modules to activate like it was already the case in the previous versions. précédentes versions.</p>
<!--nextpage-->

<h4>3. General improvements</h4>

<p>The first thing we note is a real improvement of performance. More tasks are made in background. This is the case for indexing who launches at start but doesn't block the user interface. Thus, we can start work during indexation but some actions are not available, like refactorings.</p>
<p><img alt="Background indexing" src="wp-content/uploads/2009/12/background-300x48.png" title="Background indexing"></p>
<p>We can also see that there is much less freeze of graphical interface who is also more reactive. The feedback of the different actions has been improved. It seems that we can see that an action has been launched or done and we're not to ask us if something happens or not, like that can happens with Idea 8.</p>
<!--nextpage-->

<h4>4. User Interface</h4>

<p>As previously stated, the reactivity of the user interface has been greatly improved.</p>
<p>The views have not major changes, but we can still note that there is some interesting new functionalities.</p>
<p>First of all, we can now debug and launch directly from keyboard shortcuts :</p>
<ul>
    <li>Alt+Shift+F9 : Open debbuging view</li>
    <li>Alt+Shift+F10 : Open launch view</li>
</ul>

<p>Here are these new views :</p>
<p><img alt="Quick Debug View" src="wp-content/uploads/2009/12/debug.png" title="Quick Debug View">
<img alt="Quick Run View" src="wp-content/uploads/2009/12/run.png" title="Quick Run View"></p>
<p>Then, we've also a new bookmarks management functionality. We can now put bookmarks in every portion of code, either class or lines of code. We've now there shortcuts :</p>
<ul>
<li>F11 : Create a new bookmark at the selected item (file in project view or line of code in editor)</li>
<li>Shift + F11 : Show the bookmarks and enable the user to go to one bookmark.</li>
</ul>
<p>An example of bookmark on a line of code :</p>
<p><img alt="Bookmark on a line of code" src="wp-content/uploads/2009/12/bookmark-300x21.png" title="Bookmark on a line of code"></p>
<p>And the view of bookmarks :</p>
<p><img alt="Bookmarks" src="wp-content/uploads/2009/12/bookmarks-300x185.png" title="Bookmarks"></p>
<p>And last but not least, we can now copy files/directory from operating system and paste them in Idea and vice-versa. That is very practice but was not available in the previous versions.</p>
<!--nextpage-->

<h4>5. Maven support</h4>

<p>The "Maven Projects" view has had little modifications. In the "Lifecycle" folder, only the main goals are displayed (clean, validate, compile, test, package, install, site et deploy) . I think it's a good thing, because we use especially these goals. Of course, we can display all the goals with an option in the tool bar.</p>
<p>Always in this view, we can now see the profiles (Maven 2 profiles) who are configured in settings.xml and go quickly to this settings.xml file. More than the profiles, we can now directly display the the dependencies of a project : Maven 2 :</p>
<p><img alt="Maven 2 project dependencies" src="wp-content/uploads/2009/12/maven-dependencies-286x300.png" title="Maven 2 project dependencies"></p>
<p>We also have access to a dependency graph for a Maven module :</p>
<p><img alt="Maven 2 dependency graph" src="wp-content/uploads/2009/12/maven-dependencies-300x134.png" title="Maven 2 dependency graph"></p>
<p>It is now possible to automatically reimport the Maven projects after a change in the pom.xml files.</p>
<p>For the reimport, we can now reimport only projects who have changes in their pom.xml or concerned by the others changes. More than this improvement, the speed of this operation has been improved by a factor of 3 or 4.</p>
<!--nextpage-->

<h4>6. OSGI support</h4>

<p>From this version, Idea natively integrate an OSGi plugin, Osmorc. This plugin try to make easier the development of OSGi applications in Idea. I'll try to show you the main functionalities who are now integrated in Idea.</p>
<p>The first thing to do is to configure the project for OSGi. To do that, we just need to activate the OSGi facet for the necessary modules. Then (or before, as you want), we must configure the installed OSGi instances.</p>
<p><img alt="Configuration of installed OSGi instances" src="wp-content/uploads/2009/12/osgi-settings-instance-300x174.png" title="Configuration of installed OSGi instances"></p>
<p>Then, we must configure the instance to use for the project :</p>
<p><img alt="Configure the OSGi instance for the project" src="wp-content/uploads/2009/12/osgi-settings-instance-project-300x139.png" title="Configure the OSGi instance for the project"></p>
<p>We can then go to the creation of a simple OSGi project.</p>
<p>The first functionality to note is of course the code completion of the MANIFEST.MF entries :</p>
<p><img alt="OSGi Headers code completion" src="wp-content/uploads/2009/12/osgi-completion-300x209.png" title="OSGi Headers code completion"></p>
<p>When you add the Import-Package header, we can use the classes of this package from the project without doing anything else.</p>
<p>But we can also define a Manifest file from Idea :</p>
<p><img alt="Manifest configuration" src="wp-content/uploads/2009/12/osgi-manifest-300x122.png" title="Manifest configuration"></p>
<p>Et we continue with an activator :</p>
<div class="code"><pre><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">pragprog</span><span class="o">.</span><span class="na">hello</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.osgi.framework.BundleActivator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.osgi.framework.BundleContext</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">HelloWorld</span> <span class="kd">implements</span> <span class="n">BundleActivator</span><span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">start</span><span class="o">(</span><span class="n">BundleContext</span> <span class="n">bundleContext</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"I'm in OSGi :)"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">stop</span><span class="o">(</span><span class="n">BundleContext</span> <span class="n">bundleContext</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"I'm leaving OSGi :("</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>To finish, we create a new run configuration "OSGi bundles". For That, we just need to add the bundle to the list and in the "Parameters" tab to choose the good OSGi instance to run :</p>
<p><img alt="OSGi run configuration" src="wp-content/uploads/2009/12/osgi-run-configuration-300x261.png" title="OSGi run configuration"></p>
<p>And we launch the configuration, that give us :</p>
<p><img alt="OSGi application" src="wp-content/uploads/2009/12/osgi-run.png" title="OSGi run configuration"></p>
<p>But we cannot interact with the OSGi instance from Idea, that's not very practical. We cannot stop modules or either manage them from the console. But the OSGi development is still facilitated by Idea. But it would have been better to have something a bit more advanced.</p>
<!--nextpage-->

<h4>7. PHP support</h4>

<p>Here is a functionality who's perhaps not interesting for everybody but that will be interesting for the Java developers who manages a PHP site or simply for the PHP developers. For me, who manages also a PHP website, it's a great news. Before that, i used other editors and IDE to edit my website, but now i can do everything from my favourite IDE.</p>
<p>First and of course, we have syntax highlighting of PHP files :</p>
<p><img alt="Syntax highlighting of PHP file" src="wp-content/uploads/2009/12/php-color-300x238.png" title="Syntax highlighting of PHP file"></p>
<p>We also have automatic code completion for PHP functions :</p>
<p><img alt="Automatic Code Completion" src="wp-content/uploads/2009/12/php-complete-300x161.png" title="Automatic Code Completion"></p>
<p>But the IDE make more than simple code completion. In fact, it discovers automatically the fields and methods from a class and fields and methods from the standard library. You can see this functionalities in the next images :</p>
<p><img alt="Contextual Code completion" src="wp-content/uploads/2009/12/php-smart-300x213.png" title="Contextual Code Completion"></p>
<p><img alt="Advanced Code completion" src="wp-content/uploads/2009/12/php-smarter-300x292.png" title="Advanced Code Completion"></p>
<p>Moreover, Idea also supports PHPDcod documentation and make code completion based on PHPDoc :</p>
<p><img alt="Code Completion PHPDoc based" src="wp-content/uploads/2009/12/php-phpdoc-300x226.png" title="Code Completion PHPDoc based"></p>
<p>We can also note that it's possible to do PHP Debugging and unit tests with PHPUnit. But this is out of the scope of this article.</p>
<!--nextpage-->

<h4>8. Task management</h4>

<p>This functionnality isn't for me a major change, but it remains interesting. It enables the user to save state of view in a specified task.</p>
<p>A task save the current changelist, the open editions, the state of the project view, the run configurations and the breakpoints. If you work in two parts of a project, you can create two tasks and you have also the same properties when you switch from one to the other. And you can quickly commit only the changes of a task because of the decoupled changelists.</p>
<p><img alt="Task Creation" src="wp-content/uploads/2009/12/task-create-300x192.png" title="Task Creation"></p>
<p>Then, it is possible to go to a specific task, who has for effect to save the state of the current task and restore the state of the task to open.</p>
<p><img alt="Open task" src="wp-content/uploads/2009/12/task-open.png" title="Open task"></p>
<p>It's also possible to synchronize the different tasks with YouTrack or JIRA.</p>
<!--nextpage-->

<h4>9. Miscellaneous</h4>

<p>More that these new big news, there is many other changes that i will not detail including :</p>
<ul>
    <li>It is now possible to create a module from a Grails/Griffon project in the same way we can import project from Eclipse. We can also create Griffon/Grails modules or applications.</li>
    <li>There is now a Spell Checking inspection for the code and resources who is enabled by default in this new version.</li>
    <li>The public classes and methods who aren't used are not directly shaded like it was already the case for unused private fields and methods.</li>
    <li>Grails support improvement with Griffon and Gradle support</li>
    <li>Android support</li>
    <li>Flex support improvements</li>
</ul>

<!--nextpage-->

<h4>10. Conclusion</h4>

<p>To conclude, JetBrains has one more times demonstrated its expertise in Java IDE presenting an excellent new version full of new functionalities and improvements that made the Java development even better.</p>
<p>The only thing i had to complain in this version, is the lack of documentation of OSGi plugin and the limitations of the latter.</p>
<p>You can download IntelliJ Idea 9 on the official site.</p></div>
        </div>
            
        
    <p>
        <a href="posts/2009/12/intellij-idea-9-review.html#disqus_thread" data-disqus-identifier="cache/posts/2009/12/intellij-idea-9-review.html">Comments</a>


        </p></article>
        <article class="postbox h-entry post-text">
        <h1 class="p-name"><a href="posts/2009/12/google-analytics-asynchronous.html" class="u-url">Google Analytics goes asynchronous !</a>
        <br><small>  
             Posted: <time class="published dt-published" datetime="2009-12-07T14:37:10+01:00">2009-12-07 14:37</time>
        </small></h1>
        <hr>
        <div class="e-content">
        <div><p>From this month, Google provide a new Google Analytics script that works in an asynchronous way.</p>
<p>This has several advantages :</p>
<ul>
    <li>The time to load the script has less impact on the page loading time.</li>
    <li>Best data recovery and so more saved visits. The visits terminated before the script loading doesn't happens anymore. Because, due to the asynchronous way of loading, we can add the analytics code in the head of the page.</li>
    <li>Less tracking errors.</li>
</ul>

<p>Voici le nouveau code à insérer dans vos pages :</p>
<div class="code"><pre>  <span class="kd">var</span> <span class="nx">_gaq</span> <span class="o">=</span> <span class="nx">_gaq</span> <span class="o">||</span> <span class="p">[];</span>
  <span class="nx">_gaq</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="s1">'_setAccount'</span><span class="p">,</span> <span class="s1">'UA-XXXXX-X'</span><span class="p">]);</span>
  <span class="nx">_gaq</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="s1">'_trackPageview'</span><span class="p">]);</span>

  <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">ga</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'script'</span><span class="p">);</span>
    <span class="nx">ga</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'https:'</span> <span class="o">==</span> <span class="nb">document</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">protocol</span> <span class="o">?</span> <span class="s1">'https://ssl'</span> <span class="o">:</span> 
        <span class="s1">'http://www'</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'.google-analytics.com/ga.js'</span><span class="p">;</span>
    <span class="nx">ga</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">'async'</span><span class="p">,</span> <span class="s1">'true'</span><span class="p">);</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">ga</span><span class="p">);</span>
  <span class="p">})();</span>
</pre></div>


<p>We have to note that this code use the async parameter of HTML 5 and that functionality is not supported by all the browsers. If you use that script in a non HTML-5 Browser, the script will be executed exactly as the old Analytics script in an synchronous way. </p>
<p>That's a good news for the fans of performances. </p>
<p>Source : <a href="http://googlecode.blogspot.com/2009/12/google-analytics-launches-asynchronous.html">Google Analytics Launches Asynchronous Tracking</a></p></div>
        </div>
            
        
    <p>
        <a href="posts/2009/12/google-analytics-asynchronous.html#disqus_thread" data-disqus-identifier="cache/posts/2009/12/google-analytics-asynchronous.html">Comments</a>


        </p></article>
    
        <div>
        <ul class="pager">
            <li class="previous">
                <a href="index-2.html" rel="prev">← Newer posts</a>
            </li>
        </ul>
        </div>

    
        
       <script>var disqus_shortname="blogwichtounet";(function(){var a=document.createElement("script");a.async=true;a.src="//"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>


	


            </div>
        </div>
    </div>
</div>

<!-- Footer -->

<footer>
    Contents © 2014         <a href="mailto:baptistewicht@gmail.com">Baptiste Wicht</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by/4.0/88x31.png"></a>
        <ul class="footer_inline_ul">
            
        </ul>
</footer>


            <script src="assets/js/all-nocdn.js" type="text/javascript"></script>


<!-- Late loading stuff  -->

    <script type="text/javascript">
      $(document).ready(function() {
        jQuery.getJSON('/assets/js/tag_cloud_data.json', function(data) {
            var items = [];

            $.each(data, function(key, val) {
                items.push('<li><a href="' + val[1] +'" '+'data-weight="'+val[0]+'"'+'>' + key + '</a></li>');
            });

            $('<div/>', {
                'id': 'tags',
                html: '<ul>' + items.join('') + '</ul>'
            }).appendTo('body');

            if(!$('#tags_canvas').tagcanvas({
                textColour: '#FFFFFF',
                outlineColour: '#ff00ff',
                reverse: true,
                depth: 0.8,
                maxSpeed: 0.05,
                weight: true,
                weightFrom: "data-weight",
                weightSizeMin: 8,
                weightSizeMax: 24
            },'tags')) {
                //something went wrong, hide the canvas container
                $('#tags_container').hide();
            }});
        });
    </script>

<!-- Google platform JS -->
    
<script type="text/javascript" src="https://apis.google.com/js/platform.js"></script>


    


<!-- Tipue Search -->

<script type="text/javascript">
    $(document).ready(function() {
        $('#tipue_search_input').tipuesearch({
        'mode': 'json',
        'contentLocation': '/assets/js/tipuesearch_content.json',
        'showUrl': false
        });
        });
</script>






</body>
</html>