<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/"><channel><title>@Blog("Baptiste Wicht") (Sonar)</title><link>http://baptiste-wicht.com/</link><description></description><language>en</language><lastBuildDate>Sat, 07 Mar 2015 16:18:27 GMT</lastBuildDate><generator>http://getnikola.com/</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>SonarQube inspections for C++ projects</title><link>http://baptiste-wicht.com/posts/2014/10/sonarqube-inspections-for-cpp-projects.html</link><dc:creator>Baptiste Wicht</dc:creator><description>&lt;p&gt;Back in the days, when I used to develop in Java (I hadn't discovered the
wonders of C++ :) ), I used Sonar a lot for my projects. Sonar is a great tool
for quality inspections of a project. Sonar has been made for Java and is mostly
free and opensource (some plugins are commercial) to inspect Java projects.
Unfortunately, this is not the case for C++ inspection. Indeed, the C++ plugin
cost 7000 euros (more than 8500$). As I mostly work on C++ for opensource and
school projects, I'm definitely not able to buy it. I wanted for a long time to
test the commercial C++ plugin. For this article, sonarsource provided me with a
short (very short) time license for the C++ plugin.&lt;/p&gt;
&lt;p&gt;There is also another option for C++ which is the C++ community plugin:
&lt;a class="reference external" href="https://github.com/wenns/sonar-cxx"&gt;https://github.com/wenns/sonar-cxx&lt;/a&gt;. I have tested it some time ago, but I was
not satisfied with it, I had several errors and had to use a dev version to make
it work a bit. Moreover, the C++11 support is inexistant and management of
parsing error is not really satisfying. But maybe it is good for you. This
article will only focus on the commercial plugin.&lt;/p&gt;
&lt;div class="section" id="usage"&gt;
&lt;h2&gt;Usage&lt;/h2&gt;
&lt;p&gt;For each project that you want to analyze with Sonar, you have to create a
sonar-project.properties files describing some basic information about your
project.&lt;/p&gt;
&lt;p&gt;Then, there are two ways to inspect a C++ project. The first one and recommended
one is to use the &lt;em&gt;build-wrapper&lt;/em&gt; executable. It is a sub project that you have
to download and install alongside Sonar. It works by wrapping the commands to
your build systems:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
build-wrapper make all
&lt;/pre&gt;
&lt;p&gt;and this should generate enough informations for not having to fill each field
in the project configuration. The, you have to use the &lt;em&gt;sonar-runner&lt;/em&gt; program to
upload to Sonar.&lt;/p&gt;
&lt;p&gt;I tried it on several projects and there seems to be a problem with the
includes. It didn't include the header files in the Sonar inspections.&lt;/p&gt;
&lt;p&gt;I finally ended up using manual configuration of the Sonar project and the
header files were included correctly. However, you normally have to include many
information in the configuration including all macros for instance. For now, I
haven't bothered generating them and it doesn't seem to impact too much the
results.&lt;/p&gt;
&lt;p&gt;When I look in the log, it seems that there are still a lot of parsing errors.
They seem mostly related to some compiler macro, especially the __has_feature__
macro of clang. This is the same problem with the build-wrapper. When I don't
use the build-wrapper I also have other problems with macros for unit testing.&lt;/p&gt;
&lt;p&gt;I also have other errors coming during the inspection, for instance:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
error directive: This file requires compiler and library support for the ISO C++
2011 standard. This support is currently experimental, and must be enabled with
the -std=c++11 or -std=gnu++11 compiler options
&lt;/pre&gt;
&lt;p&gt;I think it comes from the fact that I compile with std=c++1y and that Sonar
does not support C++14.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="inspections"&gt;
&lt;h2&gt;Inspections&lt;/h2&gt;
&lt;p&gt;Here is the results of inspection on my ETL project:&lt;/p&gt;
&lt;img alt="/images/etl_dashboard.png" src="http://baptiste-wicht.com/images/etl_dashboard.png"&gt;
&lt;p&gt;I really like the web interface of Sonar, it really sums well all the
information and the various plugins play quite nice with each other. Moreover,
when you check issues, you can see directly the source code very clearly. I
really think this is the strong point of Sonar.&lt;/p&gt;
&lt;p&gt;Here is the Hotspots view for instance:&lt;/p&gt;
&lt;img alt="/images/etl_dashboard.png" src="http://baptiste-wicht.com/images/etl_dashboard.png"&gt;
&lt;p&gt;Or the Time Machine view:&lt;/p&gt;
&lt;img alt="/images/etl_dashboard.png" src="http://baptiste-wicht.com/images/etl_dashboard.png"&gt;
&lt;p&gt;The issues that are reported by Sonar are quite good. On this project there is a
lot of them related to naming conventions because I don't follow the conventions
configured by default. However, you can easily configure the inspections to give
your own naming regex or simple enable/disable some inspections.&lt;/p&gt;
&lt;p&gt;There are some good inspections:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Some missing explicit keyword&lt;/li&gt;
&lt;li&gt;Some commented block of code that can be removed&lt;/li&gt;
&lt;li&gt;An if-elseif construct that should have had a else&lt;/li&gt;
&lt;li&gt;Files with too high complexity&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;However, there are also some important false positives. For instance:&lt;/p&gt;
&lt;img alt="/images/etl_false_positive_1.png" src="http://baptiste-wicht.com/images/etl_false_positive_1.png"&gt;
&lt;p&gt;In here, there are no reasons to output this issue since the operator is
deleted. It proves that the C++11 support is rather incomplete. I have other
false positives of the same kind for &lt;em&gt;= default&lt;/em&gt; operators and constructors.
Here is another example:&lt;/p&gt;
&lt;img alt="/images/etl_false_positive_2.png" src="http://baptiste-wicht.com/images/etl_false_positive_2.png"&gt;
&lt;p&gt;In this case, the varadic template support is mixed with the old ellipsis
notation, making it again a lack of C++11 support. There are also other false
positives for instance because of lambdas, but all of them were related to
C++11.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="various"&gt;
&lt;h2&gt;Various&lt;/h2&gt;
&lt;p&gt;If you don't think you have enough quality rules, you can also include the one
from cppcheck simply by givin the path to cppcheck in sonar-project.properties.
I think this is great, since it works all by itself. You can also create your
own rule, but you'll have to use XPath for path.&lt;/p&gt;
&lt;p&gt;If you want, you can also include unit test reports inside Sonar. I haven't
tested this support since they only support cppunit test reports and I use only
Catch for my unit tests. It would have been great if JUnit format would have
been supported since many tool support it.&lt;/p&gt;
&lt;p&gt;The last option that is supported by this plugin is the support of GCOV reports
for code coverage information. I haven't been able to make it work, I had errors
indicating that the source files were not found. I didn't figure this out. It
may come from the fact that I used llvm and clang to generate the GCOV reports
and not G++.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;First, here are some pros and cons for the C++ support in SonarQube.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Pros&lt;/strong&gt;&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Good default inspections&lt;/li&gt;
&lt;li&gt;Great web interface.&lt;/li&gt;
&lt;li&gt;cppcheck very well integrated&lt;/li&gt;
&lt;li&gt;Issues are easily configurable&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Cons&lt;/strong&gt;&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;C++11 support is incomplete and no C++14 support&lt;/li&gt;
&lt;li&gt;build-wrapper support seems instable. It should be integrated directly into
sonar.&lt;/li&gt;
&lt;li&gt;Unit tests support is limited to cppunit&lt;/li&gt;
&lt;li&gt;Haven't been able to make Code Coverage work&lt;/li&gt;
&lt;li&gt;Macro support not flexible enough&lt;/li&gt;
&lt;li&gt;Too expensive&lt;/li&gt;
&lt;li&gt;Quite complicated&lt;/li&gt;
&lt;li&gt;No support for other static analyzer than cppcheck&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The general web interface feeling is quite good, everything looks great and the
report are really useful. However, the usage of the tool does not feel very
professional. I had a lot more problems than I expected to use it. I was also
really disappointed by the C++11. The syntax seems to be supported but not the
language feature in the inspections, making the C++11 support completely
useless. This is weird since they cite C+11 as supported. Moreover, there not
yet any C++14 support, but this is less dramatic. It is also a bit sad that they
limit the import to cppcheck and no other static analyzers and the same stands
for cppunit.&lt;/p&gt;
&lt;p&gt;In my opinion, it is really an inferior product compared to the Java support.
I was expecting more from a 8500 dollars product.&lt;/p&gt;
&lt;p&gt;For now, I won't probably use it anymore on my projects since all of them use at
least C++11, but I will probably retry Sonar for C++ in the future hoping that
it will become as the Sonar Java support.&lt;/p&gt;
&lt;/div&gt;</description><category>C++</category><category>Review</category><category>Sonar</category><category>Tools</category><guid>http://baptiste-wicht.com/posts/2014/10/sonarqube-inspections-for-cpp-projects.html</guid><pubDate>Sun, 05 Oct 2014 12:55:46 GMT</pubDate></item><item><title>Sonar 2.1 has been released</title><link>http://baptiste-wicht.com/posts/2010/05/sonar-2-1-has-been-released.html</link><dc:creator>Baptiste Wicht</dc:creator><description>&lt;p&gt;The version 2.1 of Sonar has just been released. This version includes 51 bugfixes and improvements. The major new features are :&lt;/p&gt;
&lt;ul&gt;
    &lt;li&gt;A new page "Librairies" displays all the librairies of the project (Maven dependencies)&lt;/li&gt;
    &lt;li&gt;A new page "Dependencies" searches for library usages&lt;/li&gt;
    &lt;li&gt;A new page "System Info" display the system properties, installed plugins, database and VM memory stats.&lt;/li&gt;
    &lt;li&gt;New rules to detect unused methods.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Normally, all the plugins compatible with version 2.0 should be compatible with this new version.&lt;/p&gt;</description><category>Java</category><category>Releases</category><category>Sonar</category><guid>http://baptiste-wicht.com/posts/2010/05/sonar-2-1-has-been-released.html</guid><pubDate>Wed, 05 May 2010 08:45:17 GMT</pubDate></item><item><title>First build of JTheque with Sonar 2.0</title><link>http://baptiste-wicht.com/posts/2010/05/first-build-jtheque-sonar-2-0.html</link><dc:creator>Baptiste Wicht</dc:creator><description>&lt;p&gt;This week-end I updated the version of Sonar to &lt;a href="http://www.baptiste-wicht.com/2010/03/sonar-2-0-released/"&gt;the new version 2.0&lt;/a&gt; and migrated it from Tomcat 5.5 to Tomcat 6.0. I waited until now for the plugins I use to be compatible. Now, all my plugins are compatible :&lt;/p&gt;
&lt;ul&gt;
    &lt;li&gt;Motion Chart : An elegant chart demonstrating the evolutions of metrics build after build&lt;/li&gt;
    &lt;li&gt;Quality Index : Compute a quality index for each project based on 4 axes : Coding, Complexity, Coverage and Style&lt;/li&gt;
    &lt;li&gt;Radiator : Display a view like the main view of all projects (all the rectangles with a lot of colors) for all the components of a project&lt;/li&gt;
    &lt;li&gt;Rules Meter : Indicate for each project how many rules were activated during analysis&lt;/li&gt;
    &lt;li&gt;SCM Activity : Compute some metrics about the SCM Activity of the project&lt;/li&gt;
    &lt;li&gt;TagList : Analyze some tag (@TODO, @FIXME, ...) in your code and display them in the project&lt;/li&gt;
    &lt;li&gt;Technical Debt : Compute a technical debt estimation for all the problems of your project&lt;/li&gt;
    &lt;li&gt;Timeline : Display a chart of the evolution of the metrics build after build&lt;/li&gt;
    &lt;li&gt;Build Stability : Display the stability of the builds on the continuous integration system&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Now I made the first build of JTheque with Sonar 2.0.&lt;/p&gt;
&lt;p&gt;At first view, there is not a lot of changes with this new version, but the main view has been a little improved and the new analysis are good. Now you've metrics about your design and about the dependencies to cut to make your design better. They added a good dependency matrix to each project.&lt;/p&gt;
&lt;p&gt;This version works well like the older. The only things to pay attention for the update is the long time the database upgrade takes.&lt;/p&gt;
&lt;p&gt;I've also updated Hudson to the last version and also migrated it to my Tomcat 6.0.&lt;/p&gt;</description><category>JTheque</category><category>Java</category><category>Sonar</category><guid>http://baptiste-wicht.com/posts/2010/05/first-build-jtheque-sonar-2-0.html</guid><pubDate>Sun, 02 May 2010 13:09:45 GMT</pubDate></item><item><title>The version 2.0 of Sonar has been released</title><link>http://baptiste-wicht.com/posts/2010/03/sonar-2-0-released.html</link><dc:creator>Baptiste Wicht</dc:creator><description>&lt;p&gt;The developers of Sonar have just released the version 2.0 of Sonar.&lt;/p&gt;
&lt;p&gt;Several major features:&lt;/p&gt;
&lt;ul&gt;
    &lt;li&gt;Architecture analysis : The architecture of the projects are now analyzed. We can see a matrix of project dependencies and a list of dependencies to delete to improve architecture quality.&lt;/li&gt;
    &lt;li&gt;Object oriented analysis : New metrics for the quality of the object oriented conception.&lt;/li&gt;
    &lt;li&gt;Improvements of the user interface.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Only good stuff :)&lt;/p&gt;
&lt;p&gt;I didn't test this new version, i will wait that my plugins be compatibles with the new version, but i will give informations of the new version once installed.&lt;/p&gt;
&lt;p&gt;More informations on the &lt;a title="Sonar source" href="http://sonar.codehaus.org/sonar-2-0-in-screenshots/" target="_blank"&gt;Sonar website&lt;/a&gt;.&lt;/p&gt;</description><category>Java</category><category>Releases</category><category>Sonar</category><guid>http://baptiste-wicht.com/posts/2010/03/sonar-2-0-released.html</guid><pubDate>Thu, 11 Mar 2010 14:27:25 GMT</pubDate></item></channel></rss>