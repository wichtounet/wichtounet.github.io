<p>The <strong>version 1.1.0</strong> of the <strong>EDDI Compiler</strong> (eddic) is available. It took much less time to implement that version than I thought. </p>
<p>The main change to the language is the <strong>support of member functions</strong>. Each structure can now declare some functions. Functions can be called in each structure object. Here is an example of what can be done with that feature in EDDI:</p>
<pre class="code literal-block"><span class="k">struct</span> <span class="n">Counter</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">value</span><span class="p">;</span>

    <span class="kt">void</span> <span class="nf">increment</span><span class="p">(){</span>
        <span class="k">this</span><span class="p">.</span><span class="n">value</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="n">value</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">add</span><span class="p">(</span><span class="kt">int</span> <span class="n">number</span><span class="p">){</span>
        <span class="k">this</span><span class="p">.</span><span class="n">value</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="n">value</span> <span class="o">+</span> <span class="n">number</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">add</span><span class="p">(</span><span class="kt">int</span> <span class="n">n1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n2</span><span class="p">){</span>
        <span class="k">this</span><span class="p">.</span><span class="n">value</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="n">value</span> <span class="o">+</span> <span class="n">n1</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="n">value</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="n">value</span> <span class="o">+</span> <span class="n">n2</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">main</span><span class="p">(){</span>
    <span class="n">Counter</span> <span class="n">counter</span><span class="p">;</span>
    <span class="n">counter</span><span class="p">.</span><span class="n">increment</span><span class="p">();</span>
    <span class="n">println</span><span class="p">(</span><span class="n">counter</span><span class="p">.</span><span class="n">value</span><span class="p">);</span>

    <span class="n">counter</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="mi">99</span><span class="p">);</span>
    <span class="n">println</span><span class="p">(</span><span class="n">counter</span><span class="p">.</span><span class="n">value</span><span class="p">);</span>

    <span class="n">counter</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">69</span><span class="p">);</span>
    <span class="n">println</span><span class="p">(</span><span class="n">counter</span><span class="p">.</span><span class="n">value</span><span class="p">);</span>
<span class="p">}</span>
</pre>


<p>The <em>this</em> pointer is available in each member function. The pointer is passed on the stack just like any other parameter. </p>
<p>Another improvement is the support of the <strong>ternary operator</strong>:</p>
<pre class="code literal-block"><span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="mi">2</span> <span class="o">?</span> <span class="mi">44</span> <span class="o">:</span> <span class="mi">66</span><span class="p">;</span>
    <span class="n">println</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
<span class="p">}</span>
</pre>


<p>The inliner has been improved to support inlining member functions and functions with pointer parameters. The parameter allocation in register is only done starting at O1. </p>
<p>The peephole optimizer has also been improved. Some stacks operations optimization are performed and some unnecessary copies of parameter register are removed.  </p>
<p>Finally, the assembly generation has been improved to not use stack frames starting at O2. When this optimization is enabled, the local variables are addressed using stack pointers instead of the base pointer that is not used anymore. This optimization reduces the overhead of function calls. </p>
<h3>Future work</h3>

<p>The next version of the EDDI Compiler will be the <strong>version 1.1.1</strong>.</p>
<h3>Download</h3>

<p>You can find the compiler sources on the Github repository: <a title="eddic on GitHub" href="https://github.com/wichtounet/eddic">https://github.com/wichtounet/eddic</a></p>
<p>The exact version I refer to is the v1.1 available in the GitHub tags or directly as the release branch.</p>