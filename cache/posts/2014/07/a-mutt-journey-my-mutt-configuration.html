<p>If you've followed my Mutt posts, you'll know that I'm <a class="reference external" href="/posts/2014/07/a-mutt-journey-filter-mails-with-imapfilter.html">filtering my mails with
imapfilter</a> and
<a class="reference external" href="/posts/2014/07/a-mutt-journey-download-mails-with-offlineimap.html">downloading them with offlineimap</a>.</p>
<p>In this post, I'll share my Mutt configuration. I'm not using Mutt directly, but
mutt-kz which is a fork with good notmuch integration. For this post, it won't
change anything.</p>
<div class="section" id="configuration">
<h1>Configuration</h1>
<p>The complete configuration is made in the .muttrc file. Mutt configuration
supports the source command so that you can put some of your settings in another
files and source them from the .muttrc file. You'll see that the configuration
can soon grow large and therefore, splitting it in several files will save you a
lot of maintenance issues ;)</p>
<p>First, let's tell Mutt who we are:</p>
<pre class="literal-block">
set from = &quot;baptiste.wicht&#64;gmail.com&quot;
set realname = &quot;Baptiste Wicht&quot;
</pre>
</div>
<div class="section" id="receive-mail">
<h1>Receive mail</h1>
<p>As I'm using offlineimap to get my mails, there is no IMAP settings in my
configuration. But you need to tell Mutt where the mails are:</p>
<pre class="literal-block">
set folder = /data/oi/

set spoolfile = &quot;+Gmail/INBOX&quot;
set postponed = &quot;+Gmail/drafts&quot;

source ~/.mutt/mailboxes
</pre>
<p>The spoolfile and postponed are specifying the inbox and draft mailboxes. The
.mutt/mailboxes file is generated by offlineimap.</p>
<p>By default, Mutt will ask you to move read messages from INBOX to another
mailbox (set by mbox). I personally let my read messages in my inbox and move
them myself in a folder. For that, you have to disable the move:</p>
<pre class="literal-block">
set move = no
</pre>
<p>If you move a mail from a mailbox to another, Mutt will ask for confirmation,
you can disable this confirmation:</p>
<pre class="literal-block">
set confirmappend = no
</pre>
<p>If you use Mutt, you want to read plaintext messages rather than monstruous
HTML. You can tell Mutt to always open text plain if any:</p>
<pre class="literal-block">
alternative_order text/plain text/html
</pre>
<p>If the mail has no text/plain part, you can manage to read HTML in Mutt in an
almost sane format. First, you need to tell Mutt to open html messages:</p>
<pre class="literal-block">
auto_view text/html
</pre>
<p>And then, you need to tell it how to open it. Mutt reads a mailcap file to know
how to open content. You can tell Mutt where it is:</p>
<pre class="literal-block">
set mailcap_path = ~/.mailcap
</pre>
<p>And then, you have to edit the .mailcap file:</p>
<pre class="literal-block">
text/html; w3m -I %{charset} -T text/html; copiousoutput;
</pre>
<p>That will use w3m to output the message inside Mutt. It works quite well. You
can also use linx if you prefer.</p>
</div>
<div class="section" id="send-mail">
<h1>Send mail</h1>
<p>You need to indicate Mutt how to send mail:</p>
<pre class="literal-block">
set smtp_url = &quot;smtp://baptistewicht&#64;smtp.gmail.com:587/&quot;
set smtp_pass = &quot;SECRET&quot;
</pre>
<p>Some people prefer to use another SMTP client instead of Mutt builtin SMTP
support, you can also do that by setting sendmail to the mailer program.</p>
<p>It is generally a good idea to enforce the charset of sent mail:</p>
<pre class="literal-block">
set send_charset=&quot;utf-8&quot;
</pre>
<p>You can choose another charset if you prefer ;)</p>
<p>You need to configure vim to correctly handle mail editing:</p>
<pre class="literal-block">
set editor='vim + -c &quot;set textwidth=72&quot; -c &quot;set wrap&quot; -c &quot;set spell spelllang=en&quot;'
</pre>
<p>It sets the width of the text, enable wrap and configure spelling.</p>
<p>By default, Mutt will ask you if you want to include the body of the message you
reply to in your answer and the reply subject. You can make that faster by using
these two lines:</p>
<pre class="literal-block">
set include=yes
set fast_reply
</pre>
<p>Once mail are sent, they are copied in your outgoing mailbox. If you use GMail,
the STMP server already does that for you, therefore you should disable this
behavior:</p>
<pre class="literal-block">
set copy = no
</pre>
</div>
<div class="section" id="appearance">
<h1>Appearance</h1>
<p>Many things can also be configured in the appearance of Mutt. If you like the
threaded view of GMail, you want to configure Mutt in a similar way:</p>
<pre class="literal-block">
set sort = 'threads'
set sort_aux = 'reverse-last-date-received'
</pre>
<p>It is not as good as the GMail view, but it does the job :)</p>
<p>You can make reading mail more comfortable using smart wrapping:</p>
<pre class="literal-block">
set smart_wrap
</pre>
<p>A mail has many many headers and you don't want to see them all:</p>
<pre class="literal-block">
ignore *
unignore From To Reply-To Cc Bcc Subject Date Organization X-Label X-Mailer User-Agent
</pre>
<p>With that, you just configure which headers you're interested in.</p>
<p>If you're using the sidebar patch (and you should be ;), you can configure the
sidebar:</p>
<pre class="literal-block">
set sidebar_visible = yes
set sidebar_width = 35
set sort_sidebar = desc

color sidebar_new yellow default
</pre>
<p>It makes the sidebar always visible with a width of 35 and sort the mailboxes.
The last line makes yellow the mailboxes that have unread mails.</p>
<p>The index_format allows you to set what will shown for every mail in the index
view:</p>
<pre class="literal-block">
set index_format = &quot;%4C %Z %{%b %d} %-15.15L %?M?(#%03M)&amp;(%4l)? %?y?{%.20y}? %?g?{%.20g} ?%s (%c)&quot;
</pre>
<p>This is a classical example that display the sender, the flags, the date, the
subject, the size of the mail and so on. You will need to look at the <a class="reference external" href="http://www.mutt.org/doc/manual/manual-6.html">Reference</a> to have more information on
what you can do with the format variables. There are plenty of information that
can be shown.</p>
<p>You can also configure the text that is present on the status bar:</p>
<pre class="literal-block">
set status_chars  = &quot; *%A&quot;
set status_format = &quot;───[ Folder: %f ]───[%r%m messages%?n? (%n new)?%?d? (%d to delete)?%?t? (%t tagged)? ]───%&gt;─%?p?( %p postponed )?───&quot;
</pre>
<p>The example here displays the current folder, the number of mails in it with
some details on deleted and unread mails and finally the number of postponed
mail. Again, if you want more information, you can read the reference.</p>
<p>You can configure Mutt so that the index view is always visible when you read
mails. For instance, to always show 8 mails in the index:</p>
<pre class="literal-block">
set pager_index_lines=8
</pre>
<p>Another important thing you can configure is the colors of Mutt. I'm not gonna
cover everything, since Mutt is very powerful on this part. For instance, here
are some examples from my configuration:</p>
<p>color index         red             white           &quot;~v~(~F)!~N&quot;                # collapsed thread with flagged, no unread
color index         yellow          white           &quot;~v~(~F~N)&quot;                 # collapsed thread with some unread &amp; flagged
color index_subject brightred       default         &quot;~z &gt;100K&quot;
color header        blue            default         &quot;^(Subject)&quot;</p>
<p>Unless you are really wanting to spend time on this part, I recommend to pick an
existing theme. I took a Solarized theme <a class="reference external" href="https://github.com/altercation/mutt-colors-solarized">here</a>. It looks quite good
and works well. There other themes available, you'll surely find the one that
looks best for you.</p>
</div>
<div class="section" id="bindings">
<h1>Bindings</h1>
<p>Bindings are always very important. If like me, you're a vim aficionado, you'll
want your Mutt bindings to be as close as possible to vim. The default settings
are quite good, but not always close to vim.</p>
<p>Something that is important to know when you configure Mutt bindings is that
they are relative to the current view open (index, pager,browser,attach, ...).
You can bind a keystroke to a different action in each view. You can also select
several views in which the keystroke is valid.</p>
<p>If you are using the sidebar patch (and again, you should ;) ), you'll want to
configure fast bindings for it. Here are mine:</p>
<pre class="literal-block">
bind index,pager \Ck sidebar-prev
bind index,pager \Cj sidebar-next
bind index,pager \Cl sidebar-open
bind index,pager \Cn sidebar-scroll-up
bind index,pager \Cv sidebar-scroll-down
bind index,pager \Ct sidebar-toggle
</pre>
<p>I use Ctrl+j,k to move inside the sidebar. I use Ctrl+l to open a folder and
Ctrl+n,v to scroll up and down. The last one is to toggle between multiple
sidebars for instance if you use notmuch.</p>
<p>I find l very good to open messages in the index too:</p>
<pre class="literal-block">
bind index l display-message
bind index gg first-entry
bind index G last-entry
bind index h noop               # Disable h
</pre>
<p>gg and G are used to go to the first and last element. Here I disabled h which
had a not often used command.</p>
<p>The pager is the view where you read mail:</p>
<pre class="literal-block">
bind pager h exit
bind pager gg top
bind pager G bottom
bind pager J next-line
bind pager K previous-line
</pre>
<p>In this view, I use h to get out of the pager, gg and G as usual. As I always
let the index open, I already use j and k to move in the index, so I chose J and
K to move in the pager.</p>
<p>The browser is the view where you select folders for instance:</p>
<pre class="literal-block">
bind browser l select-entry
bind browser L view-file
bind browser gg first-entry
bind browser G last-entry
bind browser h exit
</pre>
<p>Again, I use l and h to go back and forth and gg and G to go first and last. j
and k are already used here to go up and down.</p>
<p>In the attach view:</p>
<pre class="literal-block">
bind attach h exit
bind attach e edit-type # Edit MIME Types
bind attach l view-attach
</pre>
<p>I use h to exit and l to view an attachment.</p>
<p>That is it for my bindings, but you configure a lot more of them.</p>
</div>
<div class="section" id="conclusion">
<h1>Conclusion</h1>
<p>This is the end of this post. I have covered my complete Mutt configuration
here. My .muttrc is available <a class="reference external" href="https://github.com/wichtounet/dotfiles/blob/master/.muttrc">online</a>.</p>
<p>If you have comments on my configuration, you're welcome to let a comment on
this post ;)</p>
<p>In the next blog post about my &quot;Mutt journey&quot;, I'll talk about notmuch and this
will likely be the last post on this series.</p>
</div>
