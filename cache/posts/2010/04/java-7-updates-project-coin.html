<p>I continue my posts on the new features of Java 7. In this post, I'll detail the news coming from the Project Coin. This project has computed more than 70 new features proposal from the Java community for integration in Java 7.</p>
<p>In this post, I'll detail the Final Five (or So) features chosen from this project to be included in Java 7.</p>
<h3>Diamond Syntax</h3>

<p>This feature is a really simple syntax improvement for generics. With that feature, you can avoid to write twice the generics type in a generics declaration. A little  example :</p>
<p>Instead of writing this :</p>
<pre class="code literal-block"><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Collection</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedHashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Collection</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;();</span>
</pre>


<p>You can now write that :</p>
<pre class="code literal-block"><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Collection</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedHashMap</span><span class="o">&lt;&gt;();</span>
</pre>


<p>That's really practical, but not essential.</p>
<h3>Simplified Varargs Method Invocation</h3>

<p>This improvement is not a new functionality, but only a move of a warning. Like you must know, we cannot create arrray of generics type because the type verification is not made at the same time. But with the Ellipse of Java 5, you can made that type of array implicitely and the compiler generate warning at each invocation of that kind of method, so the warning has moved to the method declaration to have less warnings.</p>
<h3>Integers declaration</h3>

<p>You'll can declare integers using binary values :</p>
<pre class="code literal-block"><span class="kt">int</span> <span class="n">binary</span> <span class="o">=</span> <span class="mi">0</span><span class="n">b11001001001</span><span class="o">;</span>
</pre>


<p>and you can use _ (underscores) in the declaration :</p>
<pre class="code literal-block"><span class="kt">double</span> <span class="n">amount</span> <span class="o">=</span> <span class="mi">1</span><span class="n">_999_888_777</span><span class="o">.</span><span class="mi">25</span><span class="o">;</span>
<span class="kt">int</span> <span class="n">color</span> <span class="o">=</span> <span class="mh">0xdd</span><span class="n">_dd_dd</span><span class="o">;</span>
<span class="kt">int</span> <span class="n">binary</span> <span class="o">=</span> <span class="mi">0</span><span class="n">b110_0100_1001</span><span class="o">;</span>
</pre>


<p>That's allow to make more verbose code, but it's only sugar.</p>
<h3>Collections manipulations and declaration</h3>

<p>Another improvements to code verbosity, is the support of collections in the language. You'll have code facility to access and edit indexed collections like list and maps and to declare easily collections.</p>
<p>First, you can access to an element using the same syntax as the array :</p>
<pre class="code literal-block"><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="o">...;</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="o">...;</span>
<span class="n">String</span> <span class="n">firstValue</span> <span class="o">=</span> <span class="n">list</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>
<span class="n">map</span><span class="o">[</span><span class="s">&quot;Test&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="n">firstValue</span><span class="o">;</span>
<span class="n">String</span> <span class="n">valueFromMap</span> <span class="o">=</span> <span class="n">map</span><span class="o">[</span><span class="s">&quot;Test&quot;</span><span class="o">];</span>
</pre>


<p>For the maps, that works with any type of key. So if you have one of your class for key, you can directly pass it in the code like the Strings in my example.</p>
<p>And, you can also quickly declare collections like array :</p>
<p>Lists with [] :</p>
<pre class="code literal-block"><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">numbers</span> <span class="o">=</span> <span class="o">[</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">8</span><span class="o">,</span> <span class="mi">16</span><span class="o">,</span> <span class="mi">32</span><span class="o">,</span> <span class="mi">64</span><span class="o">,</span> <span class="mi">128</span> <span class="o">];</span>
</pre>


<p>Sets with {}</p>
<pre class="code literal-block"><span class="n">Set</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">numbers</span> <span class="o">=</span> <span class="o">{</span> <span class="mi">256</span><span class="o">,</span> <span class="mi">512</span><span class="o">,</span> <span class="mi">1024</span><span class="o">,</span> <span class="mi">2048</span><span class="o">,</span> <span class="mi">4096</span> <span class="o">};</span>
</pre>


<p>And Maps with {} and : to split value and key :</p>
<pre class="code literal-block"><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">translations</span> <span class="o">=</span> <span class="o">{</span>
  <span class="s">&quot;Hi&quot;</span> <span class="o">:</span> <span class="s">&quot;Bonjour&quot;</span><span class="o">,</span>
  <span class="s">&quot;Goodbye&quot;</span> <span class="o">:</span> <span class="s">&quot;Au revoir&quot;</span><span class="o">,</span>
  <span class="s">&quot;Thanks&quot;</span> <span class="o">:</span> <span class="s">&quot;Merci&quot;</span>
<span class="o">}</span> 
</pre>


<p>All that created collections are immutables.</p>
<h3>Strings switch</h3>

<p>A really good feature : Switch with Strings values. You can now do that kind of switch : ¨</p>
<pre class="code literal-block"><span class="n">String</span> <span class="n">value</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">;</span>

<span class="k">switch</span> <span class="o">(</span><span class="n">language</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">case</span> <span class="s">&quot;fr&quot;</span><span class="o">:</span>
    <span class="n">value</span> <span class="o">=</span> <span class="s">&quot;Bonjour&quot;</span><span class="o">;</span>
    <span class="k">break</span><span class="o">;</span>
  <span class="k">case</span> <span class="s">&quot;en&quot;</span><span class="o">:</span>
    <span class="n">value</span> <span class="o">=</span> <span class="s">&quot;Hi&quot;</span><span class="o">;</span>
    <span class="k">break</span><span class="o">;</span>
  <span class="k">case</span> <span class="s">&quot;de&quot;</span><span class="o">:</span>
    <span class="n">value</span> <span class="o">=</span> <span class="s">&quot;Guten tag&quot;</span><span class="o">;</span>
    <span class="k">break</span><span class="o">;</span>
  <span class="k">default</span><span class="o">:</span>
    <span class="n">value</span> <span class="o">=</span> <span class="s">&quot;Hello&quot;</span><span class="o">;</span>
    <span class="k">break</span><span class="o">;</span>
<span class="o">}</span>
</pre>


<p>I thinks, it's really great. With that, we can delete a lot of ugly list of if/else if code.</p>
<h3>Automatic Resource Management (ARM)</h3>

<p>Another great feature, you can automatically close the resources using a new try clause :</p>
<pre class="code literal-block"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">write</span><span class="o">(</span><span class="n">URL</span> <span class="n">url</span><span class="o">,</span> <span class="n">File</span> <span class="n">file</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
  <span class="k">try</span> <span class="o">(</span> <span class="n">FileOutputStream</span> <span class="n">fos</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileOutputStream</span><span class="o">(</span><span class="n">file</span><span class="o">);</span> <span class="n">InputStream</span> <span class="n">is</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="na">openStream</span><span class="o">()</span> <span class="o">)</span> <span class="o">{</span>
    <span class="kt">byte</span><span class="o">[]</span> <span class="n">buf</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">2048</span><span class="o">];</span>
    <span class="kt">int</span> <span class="n">len</span><span class="o">;</span>
    <span class="k">while</span> <span class="o">((</span><span class="n">len</span> <span class="o">=</span> <span class="n">is</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="n">buf</span><span class="o">))</span> <span class="o">&amp;</span><span class="n">amp</span><span class="o">;</span><span class="n">gt</span><span class="o">;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">fos</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">buf</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">len</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre>


<p>In that code, the FileOutputStream and the InputStream will automatically be closed after the try, making a cleared code and you cannot forgot a resource with that.</p>
<p>And last, the modifications to support the JSR 292 directly in the language. I've already described that features in other post : <a title="Java 7 : More dynamics" href="http://www.baptiste-wicht.com/2010/04/java-7-more-dynamics/" target="_self">Java 7 : More Dynamics</a></p>
<p>That's all for these new language enhancements from the Project Coin.</p>
<p>For me, i like the new ARM and the Strings Switch, but i think this is simple enhancements, they were others proposals in the Project Coin i found better, like the "Improved Exception Handling for Java", "Improved Wildcard Syntax for Java" or "Elvis and Other Null-Safe Operators", but this a good start.</p>