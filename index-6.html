<!DOCTYPE html><html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Website about vtechnologies Java, Spring, OSGi, Hardware,...">
    <meta name="author" content="Baptiste Wicht">
    <title>@Blog("Baptiste Wicht") (old posts, page 6) | @Blog("Baptiste Wicht")</title>
    
            <link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
      <link rel="canonical" href="http://wichtounet.github.io/index-6.html">
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js" type="text/javascript"></script>
    <![endif]-->
            <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">

    
    
    
<link rel="stylesheet" type="text/css" href="assets/css/tipuesearch.css">
</head><body><div id="tipue_search_content" style="margin-left: auto; margin-right: auto; padding: 20px;"></div>



<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container-fluid"><!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://wichtounet.github.io/">@Blog("Baptiste Wicht")</a>
        </div><!-- /.navbar-header -->
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                
                <li><a href="stories/about.html">About</a>
                </li><li><a href="stories/publications.html">Publications</a>
                </li><li><a href="stories/donate.html">Donate</a>
                </li><li><a href="stories/faq.html">FAQ</a>
                </li><li><a href="stories/legal.html">Legal</a>
                </li><li><a href="archive.html">Archives</a>
                </li><li><a href="categories/index.html">Tags</a>
                </li><li><a href="rss.xml">RSS</a>

            </li></ul>
                
<span class="navbar-form pull-left">
<input type="text" id="tipue_search_input">
</span>

            <ul class="nav navbar-nav navbar-right">
                
                
                    
            </ul>
        </div><!-- /.navbar-collapse -->
    </div><!-- /.container-fluid -->
</nav>

<!-- End of Menubar -->

<div class="container">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
        <article class="postbox h-entry post-text">
        <h1 class="p-name"><a href="posts/2010/05/improve-performance-builds-maven-cli-plugin.html" class="u-url">Improve the performance of your Maven builds with maven-cli-plugin</a>
        <small>  
             Posted: <time class="published dt-published" datetime="2010-05-26T03:09:22+00:00">2010-05-26 03:09</time>
        </small></h1>
        <hr>
        <div class="e-content">
        <div><p></p><p>When you makes a lot of build using <strong>Maven</strong>, this is quickly a pain to wait for the end of the build. So this is always good to have solutions to improve the <strong>performances</strong> of the builds.</p>
<p>The better improvement i found until now is the <strong>maven-cli-plugin</strong>. This plugin provides an <strong>interactive command line</strong> interface to launch builds. The improvement is that the first phases of the build are made only once. So multiple builds are really <strong>faster</strong>. We loose a little time at the first build to make some <strong>caching</strong> improvements.</p>
<p>With these features, I save a lot of time when I made a lot of builds. For example a simple clean takes sometimes 20 seconds on a big multimodule project. When using the cli, it takes 20 seconds including the time to load the shell for the first time and then it takes only 1 second the make the following cleans. The effect is the same on other phases like install, package, compile, ...</p>
<p>The installation is quite simple. First you must add a plugin group to the settings.xml file :</p>
<p>[xml]&lt;settings&gt;
  &lt;pluginGroups&gt;
    &lt;pluginGroup&gt;org.twdata.maven&lt;/pluginGroup&gt;
    ...
  &lt;/pluginGroups&gt;
  ...
&lt;/settings&gt;[/xml]</p>
<p>And then add a new repository for the manve-cli-plugin : </p>
<p>[xml]&lt;pluginRepositories&gt;
     &lt;pluginRepository&gt;
          &lt;id&gt;twdata-m2-repository&lt;/id&gt;
          &lt;name&gt;twdata.org Maven 2 Repository&lt;/name&gt;
          &lt;url&gt;http://twdata-m2-repository.googlecode.com/svn/&lt;/url&gt;
     &lt;/pluginRepository&gt;
&lt;/pluginRepositories&gt;[/xml]</p>
<p>And you just have to use the following command on a Maven project : </p>
<p></p><pre>mvn cli:execute-phase</pre>
<p>With that the plugin will be downloaded automatically and the next commands will be executed directly. </p>
<p>The usage is very easy. This plugin has 2 useful goals : </p>
<ul>
    <li>execute : Open a shell and allows you to execute goals of plugins. </li>
    <li>execute-phase : Open a shell and allows you to execute phases of the maven build. </li>
</ul>

<p>The main difference is that if you launch install from the execute-phase, all the preceding phases will be executed, but that's not the case with execute, only install will be executed. </p>
<p>Personally, I only execute phases, so I always use the execute-phase of the cli plugin. </p>
<p>When you're in the shell, you can launch several phases or goals : </p>
<pre>maven&gt; clean install</pre>

<p>And you can directly add arguments in the command : </p>
<pre>maven&gt; clean install -Dmaven.test.skip=true</pre>

<p>And when you are building a multimodule projects, you can also execute phases only on several modules : </p>
<pre>maven&gt; module1 module2 module3 clean install</pre>

<p>You can use the ls command in a multi module project to list all the modules of the project. You can use the "Tab" key to auto complete the goals, phases and modules name. </p>
<p>When you've finished your builds, you can simply use the "exit" command to exit from the command line. </p>
<p>I think it's really a great essential plugin for each person who make Maven builds.  </p>
<p>More information <a href="http://wiki.github.com/mrdon/maven-cli-plugin/" target="_blank">on the official site</a>. </p></div>
        </div>
            
        
    <p>
        <a href="posts/2010/05/improve-performance-builds-maven-cli-plugin.html#disqus_thread" data-disqus-identifier="cache/posts/2010/05/improve-performance-builds-maven-cli-plugin.html">Comments</a>


        </p></article>
        <article class="postbox h-entry post-text">
        <h1 class="p-name"><a href="posts/2010/05/evernote-a-very-smart-note-book.html" class="u-url">Evernote : A very smart note-book</a>
        <small>  
             Posted: <time class="published dt-published" datetime="2010-05-19T06:32:54+00:00">2010-05-19 06:32</time>
        </small></h1>
        <hr>
        <div class="e-content">
        <div><p></p><p>Like any developer, I write a lot of notes with different tools :
</p><ul>
    <li>A lot of paper</li>
    <li>Office Word</li>
    <li>My iPhone</li>
    <li>My emails</li>
    <li>Web applications like RememberTheMilk</li>
</ul>
<p>I use them depending on what I do and  where I am. But this not a really good way to manage notes. The notes are not centralized and I've not always them when I need them.</p>
<p>Some days ago, I discovered a new web application than can perhaps solve my problem. This web tool is <a href="http://www.evernote.com/" target="_blank">Evernote</a>.</p>
<p>The site allows you to store elements on the web or offline in your storage space and organize all the elements like you want. With Evernote, you can :</p>
<ul>
    <li>Write TODO List</li>
    <li>Write some notes</li>
    <li>Send them by email</li>
    <li>Take screenshot</li>
    <li>Add photo</li>
    <li>Capture contents of web pages</li>
    <li>Record audio records</li>
</ul>

<p>But there is more, this service make also Optical Character Recognition (OCR) in your images. So when you take a picture and send them in the Evernote account, the text in the photo is indexed and taken for your next searches. All the text of the other documents is of course also indexed. So with that you can search documents easily.</p>
<p>Evernote is also more than an web application, it's also a desktop client for Windows and Mac OS. There is also Windows Mobile, Java and soon iPhone versions. With the client versions, you can directly drag and drop content to your account.</p>
<p>So to resume, Evernote is a kind of aggregator for your content. So after writing something on paper, you can take a picture and add it to your Evernote and then make searches in your content. With the free registration, you have 40MB of upload monthly. To have more upload capacity, you can pay the premium account for 5$/month.</p>
<p>For more informations, you can consult the <a href="http://www.evernote.com/" target="_blank">Official site</a></p></div>
        </div>
            
        
    <p>
        <a href="posts/2010/05/evernote-a-very-smart-note-book.html#disqus_thread" data-disqus-identifier="cache/posts/2010/05/evernote-a-very-smart-note-book.html">Comments</a>


        </p></article>
        <article class="postbox h-entry post-text">
        <h1 class="p-name"><a href="posts/2010/05/java-concurrency-part-2-manipulate-threads.html" class="u-url">Java Concurrency : Part 2 - Manipulate Threads</a>
        <small>  
             Posted: <time class="published dt-published" datetime="2010-05-17T06:33:07+00:00">2010-05-17 06:33</time>
        </small></h1>
        <hr>
        <div class="e-content">
        <div><p></p><a href="http://www.baptiste-wicht.com/2010/05/java-concurrency-part-1-threads/">After seeing how to create Threads</a>, we'll see in this article what we can do to <strong>manipulate Threads</strong>.
<p>When we've Threads, we can make several operations on the Threads :</p>
<ul>
    <li>Make the current Thread <strong>sleeping</strong> during x milliseconds</li>
    <li><strong>Wait</strong> for an other thread to complete</li>
    <li>Manage the <strong>priorities</strong> of Threads and pause a thread to give an other thread the opportunity to run</li>
    <li><strong>Interrupt</strong> a thread</li>
</ul>

<p>We'll now see how to do all these things.</p>
<!--more-->

<p>First and easier, we can make a thread sleeping for a certain number of milliseconds. To do that, the Thread class has a method sleep(long millis). But this method is static, so you can only make the current Thread sleeping. You cannot choose the thread you want to make sleeping, your only choice is the current Thread so :</p>
<p>[java]Thread.sleep(1000);[/java]</p>
<p>makes the current Thread sleep during 1000 milliseconds (1 second). But, you have to catch an exception, InterruptedException. This exception occurs if the sleeping thread is interrupted. So you have to do that :</p>
<p>[java]try {
    Thread.sleep(1000);
} catch (InterruptedException e){
    e.printStackTrace();
}[/java]</p>
<p>But this not the good way to manage the InterruptedException. We'll see in one moment, how to deal with this exception. </p>
<p>If you want more precision, you can use the overloaded version of sleep that takes the number of milliseconds plus a certain number of nanoseconds to sleep. The precision of this sleep depends on the system timers and clocks.</p>
<p>For example, if you want to sleep 1000 milliseconds and 1000 nanoseconds (1 microsecond), you can do like that :</p>
<p>[java]try {
    Thread.sleep(1000, 1000);
} catch (InterruptedException e){
    e.printStackTrace();
}[/java]</p>
<p>Here is a little example to test that :</p>
<p>[java]public class SleepThread {
    public static void main(String[] args) {
        System.out.println("Current time millis : " + System.currentTimeMillis());</p>
<div class="code"><pre>    <span class="n">try</span> <span class="p">{</span>
        <span class="n">Thread</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
    <span class="p">}</span> <span class="n">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">e</span><span class="p">.</span><span class="n">printStackTrace</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="n">System</span><span class="p">.</span><span class="n">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Current time millis : "</span> <span class="o">+</span> <span class="n">System</span><span class="p">.</span><span class="n">currentTimeMillis</span><span class="p">());</span>

    <span class="n">System</span><span class="p">.</span><span class="n">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Nano time : "</span> <span class="o">+</span> <span class="n">System</span><span class="p">.</span><span class="n">nanoTime</span><span class="p">());</span>

    <span class="n">try</span> <span class="p">{</span>
        <span class="n">Thread</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5000</span><span class="p">);</span>
    <span class="p">}</span> <span class="n">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">e</span><span class="p">.</span><span class="n">printStackTrace</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="n">System</span><span class="p">.</span><span class="n">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Nano time : "</span> <span class="o">+</span> <span class="n">System</span><span class="p">.</span><span class="n">nanoTime</span><span class="p">());</span>
<span class="p">}</span>
</pre></div>


<p>}[/java]</p>
<p>In my computer, this produce this result :</p>
<pre>Current time millis : 1273959308480

Current time millis : 1273959309480

Nano time : 5878165216075

Nano time : 5878166730976</pre>

<p>You can see that the sleep of milliseconds is very precise, but with nanoseconds the result can vary a lot. And of course, the result depends of your computer, your operating system and your configuration.</p>
<p>An other thing, you can do with Threads, is waiting for an other thread to die. For example, you can create five thread to compute sub result and wait for these 5 threads to finish to compute the final results based on the results of the five threads. To do that, you can use the join() method of the Thread class. This method is not static, so you can use it on any thread to wait for it to die. Like sleep() this method throws InterruptedException in the when the thread is interrupted during waiting for an other thread. So to wait on thread2, you just have to do that :</p>
<p>[java]try {
    thread2.join();
} catch (InterruptedException e){
    e.printStackTrace();
}[/java]</p>
<p>That will make the current Thread waiting for thread2 to die. You can also add a timeout in millis, or millis + nanos, with the overloaded versions of join(), join(long millis) and join(long millis, int nanos). Here is little example that shows all that stuff :</p>
<p>[java]public class JoinThread {
    public static void main(String[] args) {
        Thread thread2 = new Thread(new WaitRunnable());
        Thread thread3 = new Thread(new WaitRunnable());</p>
<div class="code"><pre>    <span class="n">System</span><span class="p">.</span><span class="n">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Current time millis : "</span> <span class="o">+</span> <span class="n">System</span><span class="p">.</span><span class="n">currentTimeMillis</span><span class="p">());</span>

    <span class="n">thread2</span><span class="p">.</span><span class="n">start</span><span class="p">();</span>

    <span class="n">try</span> <span class="p">{</span>
        <span class="n">thread2</span><span class="p">.</span><span class="n">join</span><span class="p">();</span>
    <span class="p">}</span> <span class="n">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">e</span><span class="p">.</span><span class="n">printStackTrace</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="n">System</span><span class="p">.</span><span class="n">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Current time millis : "</span> <span class="o">+</span> <span class="n">System</span><span class="p">.</span><span class="n">currentTimeMillis</span><span class="p">());</span>

    <span class="n">thread3</span><span class="p">.</span><span class="n">start</span><span class="p">();</span>

    <span class="n">try</span> <span class="p">{</span>
        <span class="n">thread3</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
    <span class="p">}</span> <span class="n">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">e</span><span class="p">.</span><span class="n">printStackTrace</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="n">System</span><span class="p">.</span><span class="n">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Current time millis : "</span> <span class="o">+</span> <span class="n">System</span><span class="p">.</span><span class="n">currentTimeMillis</span><span class="p">());</span>
<span class="p">}</span>

<span class="n">private</span> <span class="k">static</span> <span class="n">class</span> <span class="n">WaitRunnable</span> <span class="n">implements</span> <span class="n">Runnable</span> <span class="p">{</span>
    <span class="err">@</span><span class="n">Override</span>
    <span class="n">public</span> <span class="kt">void</span> <span class="n">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">try</span> <span class="p">{</span>
            <span class="n">Thread</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5000</span><span class="p">);</span>
        <span class="p">}</span> <span class="n">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">e</span><span class="p">.</span><span class="n">printStackTrace</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="p">}</span>
</pre></div>


<p>}[/java]</p>
<p>That produce this result on my computer :</p>
<pre>Current time millis : 1274015478535

Current time millis : 1274015483538

Current time millis : 1274015484538</pre>

<p>You can see that the first join() wait 5 seconds for the other thread and when we set a timeout, we wait only 1 seconds and return from join method.</p>
<p>When working with Threads, it's also possible to change the priority of a Thread. In the Java Virtual Machine, the Thread scheduler, use a priority-based scheduling. So if a Thread enter in Runnable state with a higher priority than the running Thread, the new Thread will run and the current running thread will return to Runnable state and waits for its turn. But this behavior is not guaranteed and is completely depending on the virtual machine you are working on. So, do not rely on thread priorities, just use them to improve efficiency of your program.</p>
<p>Normally, the priority range of Threads is an integer from 0 to 10, but some virtual machine have lower or higher ranges. To know the range of priority, you can use constants of the Thread class :</p>
<p>[java]public class ThreadPriorityRange {
    public static void main(String[] args) {
        System.out.println("Minimal priority : " + Thread.MIN_PRIORITY);
        System.out.println("Maximal priority : " + Thread.MAX_PRIORITY);
        System.out.println("Norm priority : " + Thread.NORM_PRIORITY);
         }
}[/java]</p>
<p>On my computer, I've the most current values :</p>
<pre>Minimal priority : 1

Maximal priority : 10

Norm priority</pre>

<p>To set the priority of a Thread, you can use the setPriority(int priority) method of the Thread class. If you enter a value greater than the maximal priority, the maximal value will be used. If you don't specify a priority, the used priority, will be the priority of the current Thread.</p>
<p>An other way to works with priority is the yield() method. This method is static, so this works on the current Thread. The purpose of this method is to make the Thread going to Runnable again and to give the opportunity to other threads to get their turn. But in practice, the behavior of this method is not guaranteed. It can be implemented as a no-op on certain systems. It's not easy to test that in practice, because the results can truly depends on your computer, virtual machine and operating system. It's a good things to not use the priorities of Threads in practice.</p>
<p>The last thing you can do with a Thread, is to interrupt it. In Java, you have no way to force a Thread to stop, if the Thread is not well-done, it can continue its execution infinitely. But you can interrupt a Thread with the interrupt() method. This method interrupt the thread, if the thread is sleeping or joining an other Thread, an InterruptedException is thrown. You have to know that if the thread was sleeping or joining, the interrupted status of the Thread will be cleared. Namely, the method isInterrupted() will return false. A little example to demonstrate that :</p>
<p>[java]public class InterruptThread {
    public static void main(String[] args) {
        Thread thread1 = new Thread(new WaitRunnable());</p>
<div class="code"><pre>    <span class="n">thread1</span><span class="p">.</span><span class="n">start</span><span class="p">();</span>

    <span class="n">try</span> <span class="p">{</span>
        <span class="n">Thread</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
    <span class="p">}</span> <span class="n">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">e</span><span class="p">.</span><span class="n">printStackTrace</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="n">thread1</span><span class="p">.</span><span class="n">interrupt</span><span class="p">();</span>
<span class="p">}</span>

<span class="n">private</span> <span class="k">static</span> <span class="n">class</span> <span class="n">WaitRunnable</span> <span class="n">implements</span> <span class="n">Runnable</span> <span class="p">{</span>
    <span class="err">@</span><span class="n">Override</span>
    <span class="n">public</span> <span class="kt">void</span> <span class="n">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">System</span><span class="p">.</span><span class="n">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Current time millis : "</span> <span class="o">+</span> <span class="n">System</span><span class="p">.</span><span class="n">currentTimeMillis</span><span class="p">());</span>

        <span class="n">try</span> <span class="p">{</span>
            <span class="n">Thread</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5000</span><span class="p">);</span>
        <span class="p">}</span> <span class="n">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="n">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"The thread has been interrupted"</span><span class="p">);</span>
            <span class="n">System</span><span class="p">.</span><span class="n">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"The thread is interrupted : "</span> <span class="o">+</span> <span class="n">Thread</span><span class="p">.</span><span class="n">currentThread</span><span class="p">().</span><span class="n">isInterrupted</span><span class="p">());</span>
        <span class="p">}</span>

        <span class="n">System</span><span class="p">.</span><span class="n">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Current time millis : "</span> <span class="o">+</span> <span class="n">System</span><span class="p">.</span><span class="n">currentTimeMillis</span><span class="p">());</span>
    <span class="p">}</span>
    <span class="p">}</span>
</pre></div>


<p>}[/java]</p>
<p>That produce that kind of result :</p>
<pre>Current time millis : 1274017633151

The thread has been interrupted

The thread is interrupted : false

Current time millis : 1274017634151</pre>

<p>You can see that after one second, the second thread is interrupted and that the interrupted status has been set to false. If you are not sleeping, but making a lot of heavy actions, you can test for interrupt like that to make your thread correctly interrupts :</p>
<p>[java]public class InterruptableRunnable implements Runnable {
    @Override
    public void run() {
        while(!Thread.currentThread().isInterrupted()){
            //Heavy operation
        }
    }
}[/java]</p>
<p>Now that you know how to interrupt a thread, you can imagine, that simply catch the InterruptedException is not enough to make your thread "interrupt safe". Imagine that your thread something like that : </p>
<p>[java]public class UglyRunnable implements Runnable {
    @Override
    public void run() {
        while(!Thread.currentThread().isInterrupted()){
            //Heavy operation
            try {
                Thread.sleep(5000);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            //Other operation
        }
    }
}[/java]</p>
<p>And now, an other thread want to interrupt your thread while your thread is sleeping. The sleep will be interrupted, but the interrupted status will be cleared so the loop will continue. A solution to make a better thread is to interrupt again the thread after an InterruptedException : </p>
<p>[java]public class BetterRunnable implements Runnable {
    @Override
    public void run() {
        while(!Thread.currentThread().isInterrupted()){
            //Heavy operation
            try {
                Thread.sleep(5000);
            } catch (InterruptedException e) {
                Thread.currentThread().interrupt();
            }
            //Other operation
        }
    }
}[/java]</p>
<p>With that code, the interrupted status will be restored and the loop will be stopped after interrupt. Depending on your code, you can also add a continue statement after the interrupt() to not make operations after interrupt. In some cases, you'll also needs to make several if statements to test the interrupted status to do or not to do some operations. </p>
<p>So, we've now covered the main operations you can do on threads. I hope you found this article interesting.</p>
<p>You can download the sources of this article here : <a href="wp-content/uploads/2010/05/Part2.tar.gz">Java Concurrency Sources - Part 2</a></p>
<p>In the next article about Java Concurrency, we'll see how to synchronize code to make it Thread-safe.</p></div>
        </div>
            
        
    <p>
        <a href="posts/2010/05/java-concurrency-part-2-manipulate-threads.html#disqus_thread" data-disqus-identifier="cache/posts/2010/05/java-concurrency-part-2-manipulate-threads.html">Comments</a>


        </p></article>
        <article class="postbox h-entry post-text">
        <h1 class="p-name"><a href="posts/2010/05/tip-add-resources-dynamically-to-a-classloader.html" class="u-url">Tip : Add resources dynamically to a ClassLoader</a>
        <small>  
             Posted: <time class="published dt-published" datetime="2010-05-15T06:40:03+00:00">2010-05-15 06:40</time>
        </small></h1>
        <hr>
        <div class="e-content">
        <div><p></p><p>Theoretically, it's not possible to ad resources to a <strong>ClassLoader</strong> in Java after creation. I say theoretically, because, we can do that using <strong>Reflection</strong>. </p>
<p>In fact, the <strong>URLClassLoader</strong> class has a <em>addUrl(URL url)</em> method to add a new URL, so we can invoke that method to add an URL where the ClassLoader can search to load a class. But this method is protected. So here is an example taking advantage of Reflection to add URL to the <strong>system ClassLoader</strong> : </p>
<p>[java]public static void addURLToSystemClassLoader(URL url) throws IntrospectionException { 
  URLClassLoader systemClassLoader = (URLClassLoader) ClassLoader.getSystemClassLoader(); 
  Class<urlclassloader> classLoaderClass = URLClassLoader.class; </urlclassloader></p>
<p>try { 
    Method method = classLoaderClass.getDeclaredMethod("addURL", new Class[]{URL.class}); 
    method.setAccessible(true); 
    method.invoke(systemClassLoader, new Object[]{url}); 
  } catch (Throwable t) { 
    t.printStackTrace(); 
    throw new IntrospectionException("Error when adding url to system ClassLoader "); 
  } 
}[/java]</p>
<p>This is easy and that can be done for any URLClassLoader. But of course, this is an ugly hack and that must not be always used but can be useful sometimes. An other way to do that is to create a new Class extending URLClassLoader and make the <em>addUrl(URL url)</em> public, but that can be done with the system ClassLoader. </p></div>
        </div>
            
        
    <p>
        <a href="posts/2010/05/tip-add-resources-dynamically-to-a-classloader.html#disqus_thread" data-disqus-identifier="cache/posts/2010/05/tip-add-resources-dynamically-to-a-classloader.html">Comments</a>


        </p></article>
        <article class="postbox h-entry post-text">
        <h1 class="p-name"><a href="posts/2010/05/modular-application-loading-modules.html" class="u-url">Develop a modular application - The loading</a>
        <small>  
             Posted: <time class="published dt-published" datetime="2010-05-14T06:33:40+00:00">2010-05-14 06:33</time>
        </small></h1>
        <hr>
        <div class="e-content">
        <div><p></p><p>Now that we've seen <a href="http://www.baptiste-wicht.com/2010/05/develop-a-modular-application-implementation/">how to describe a module in Java</a>, we'll see how to load it dynamically in our application.</p>
<p>In Java, all the classes are loaded using several ClassLoader.In this article, we'll develop a loader for our modules and watch the problems that arrive when working with custom ClassLoaders.</p>
<!--more-->

<p>Normally, Java use the system ClassLoader to load all the classes of our application. So it contains all the classes of our application and all the classes our application needs to work. But the problem is that we cannot add our modules jar files into classpath because the application doesn't know the modules jar files names.</p>
<p>Moreover, we cannot theoretically add files to the system ClassLoader. I say theoretically because, we can add files using reflection and call to a private method, but i thing it's not a really good practice.</p>
<p>So we've to create a new ClassLoader to load our modules. We'll do that in two phases :</p>
<p></p><ol>
    <li>Browse the module files to get the classes of the modules and the URLs of the modules Jar files</li>
    <li>Load the modules into our ClassLoader using the URLs of the first phase</li>
</ol>
<p>We'll do all the loading in a new class ModularLoader. so let's create a create a method that return the list of classes to load :</p>
<p>[java]public class ModuleLoader { 
  private static List&lt;URL&gt; urls = new ArrayList&lt;URL&gt;(); </p>
<p>private static List&lt;String&gt; getModuleClasses(){ 
    List&lt;String&gt; classes = new ArrayList&lt;String&gt;(); </p>
<div class="code"><pre><span class="c1">//Get all the modules of the modules folder</span>
<span class="n">File</span><span class="p">[]</span> <span class="n">files</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="p">(</span><span class="s">"folder"</span><span class="p">).</span><span class="n">listFiles</span><span class="p">(</span><span class="k">new</span> <span class="n">ModuleFilter</span><span class="p">());</span>

<span class="k">for</span><span class="p">(</span><span class="n">File</span> <span class="n">f</span> <span class="o">:</span> <span class="n">files</span><span class="p">){</span> 
  <span class="n">JarFile</span> <span class="n">jarFile</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span>

  <span class="n">try</span> <span class="p">{</span> 
    <span class="c1">//Open the Jar File</span>
    <span class="n">jarFile</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JarFile</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>

    <span class="c1">//We get the manifest</span>
    <span class="n">Manifest</span> <span class="n">manifest</span> <span class="o">=</span> <span class="n">jarFile</span><span class="p">.</span><span class="n">getManifest</span><span class="p">();</span>

    <span class="c1">//We get the class name from the manifest attributes</span>
    <span class="n">classes</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">manifest</span><span class="p">.</span><span class="n">getMainAttributes</span><span class="p">().</span><span class="n">getValue</span><span class="p">(</span><span class="s">"Module-Class"</span><span class="p">));</span>

    <span class="n">urls</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">toURI</span><span class="p">().</span><span class="n">toURL</span><span class="p">());</span> 
  <span class="p">}</span> <span class="n">catch</span> <span class="p">(</span><span class="n">IOException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span> 
    <span class="n">e</span><span class="p">.</span><span class="n">printStackTrace</span><span class="p">();</span> 
  <span class="p">}</span> <span class="n">finally</span> <span class="p">{</span> 
    <span class="k">if</span><span class="p">(</span><span class="n">jarFile</span> <span class="o">!=</span> <span class="k">null</span><span class="p">){</span> 
      <span class="n">try</span> <span class="p">{</span> 
        <span class="n">jarFile</span><span class="p">.</span><span class="n">close</span><span class="p">();</span> 
      <span class="p">}</span> <span class="n">catch</span> <span class="p">(</span><span class="n">IOException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span> 
        <span class="n">e</span><span class="p">.</span><span class="n">printStackTrace</span><span class="p">();</span> 
      <span class="p">}</span> 
    <span class="p">}</span> 
  <span class="p">}</span> 
<span class="p">}</span>

<span class="k">return</span> <span class="n">classes</span><span class="p">;</span>
</pre></div>


<p>} </p>
<p>private static class ModuleFilter implements FileFilter { 
    @Override 
    public boolean accept(File file) { 
      return file.isFile() &amp;&amp; file.getName().toLowerCase().endsWith(".jar"); 
    } 
  } 
}[/java]</p>
<p>Like you see, it's not complicated at all. We search all the module files and then for each jar file, we open it, get the manifest et read the class name of the module. And then, for the second phase, we get the URL to the Jar file. </p>
<p>Of course, this loader is not perfect. We can have modules with no manifest or manifest with no class name and the errors must be correctly treated, but this is not the objective of this post to be perfect. </p>
<p>Now we can do the second phase, adding a method to create the ClassLoader, instantiate the modules and return them : </p>
<p>[java]private static ClassLoader classLoader; </p>
<p>public static List&lt;IModule&gt; loadModules(){ 
  List&lt;IModule&gt; modules = new ArrayList&lt;IModule&gt;(); </p>
<p>AccessController.doPrivileged(new PrivilegedAction&lt;Object&gt;(){ 
    @Override 
    public Object run() { 
      classLoader = new URLClassLoader( 
          urls.toArray(new URL[urls.size()]),<br>
          ModuleLoader.class.getClassLoader()); </p>
<div class="code"><pre>  <span class="k">return</span> <span class="n">null</span><span class="p">;</span> 
<span class="p">}</span>
</pre></div>


<p>}); </p>
<p>//Load all the modules
  for(String c : getModuleClasses()){ 
    try { 
      Class&lt;?&gt; moduleClass = Class.forName(c, true, classLoader); </p>
<div class="code"><pre>  <span class="k">if</span><span class="p">(</span><span class="n">IModule</span><span class="p">.</span><span class="n">class</span><span class="p">.</span><span class="n">isAssignableFrom</span><span class="p">(</span><span class="n">moduleClass</span><span class="p">)){</span> 
    <span class="n">Class</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">IModule</span><span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="n">castedClass</span> <span class="o">=</span> <span class="p">(</span><span class="n">Class</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">IModule</span><span class="o">&amp;</span><span class="n">gt</span><span class="p">;)</span> <span class="n">moduleClass</span><span class="p">;</span>

    <span class="n">IModule</span> <span class="n">module</span> <span class="o">=</span> <span class="n">castedClass</span><span class="p">.</span><span class="n">newInstance</span><span class="p">();</span>

    <span class="n">modules</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">module</span><span class="p">);</span> 
  <span class="p">}</span>  
<span class="p">}</span> <span class="n">catch</span> <span class="p">(</span><span class="n">ClassNotFoundException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span> 
  <span class="n">e</span><span class="p">.</span><span class="n">printStackTrace</span><span class="p">();</span> 
<span class="p">}</span> <span class="n">catch</span> <span class="p">(</span><span class="n">InstantiationException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span> 
  <span class="n">e</span><span class="p">.</span><span class="n">printStackTrace</span><span class="p">();</span> 
<span class="p">}</span> <span class="n">catch</span> <span class="p">(</span><span class="n">IllegalAccessException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span> 
  <span class="n">e</span><span class="p">.</span><span class="n">printStackTrace</span><span class="p">();</span> 
<span class="p">}</span>
</pre></div>


<p>} </p>
<p>return modules; 
}[/java]</p>
<p>So we start creating a new ClassLoader taking the urls of the Jar files. Then, we use this ClassLoader to load all the module classes and instantiate them. We only verify if the class is of type IModule. </p>
<p>This is all for our ModuleLoader. We can now test our simple modular application. We create a JAR file for the module of the previous post and then we create a very simple application to test that : </p>
<p>[java]List&lt;IModule&gt; modules = ModuleLoader.loadModules(); </p>
<p>for(IModule module : modules){ 
  System.out.println("Plug : " + module.getName()); 
  module.plug(); 
} </p>
<p>System.out.println("Lot of other things done by the application. "); </p>
<p>for(IModule module : modules){ 
  module.unplug(); 
}[/java]</p>
<p>And here is the output of the application : </p>
<pre>Plug : Simple module

Hello kernel !

Lot of other things done by the application. 

Bye kernel !</pre>

<p>Like you can see, we just created a modular applications ! The application doesn't know the modules, but the modules can do things in the application. </p>
<p>Of course, to create a real applicatio, we have to develop all the extension points and services, but this is a base to start with. </p>
<p>However, there is some problems with the current implementations : </p>
<ul>
    <li>We cannot deploy modules without restarting the application, because we must create a new ClassLoader for the modules. This is possible if there is no interation between modules, but that's not often the case. You have also the possibility to isolate all the modules in a specific ClassLoader, but with that second solution, the interations between modules are made harder. </li>
    <li>Using a second ClassLoader may be problematic with libraries loading dynamically the classes like Spring or Hibernate. To make these libraries working with your ClassLoader, you have to look at case by case depending on the library. Often, you achieve specifying the contextClassLoader using the method  Thread.currentThread().setContextClassLoader(ClassLoader cl) with your ClassLoader</li>
</ul>

<p>So here is the end of this four posts about creating a modular application. I hope you find these posts interesting. </p></div>
        </div>
            
        
    <p>
        <a href="posts/2010/05/modular-application-loading-modules.html#disqus_thread" data-disqus-identifier="cache/posts/2010/05/modular-application-loading-modules.html">Comments</a>


        </p></article>
        <article class="postbox h-entry post-text">
        <h1 class="p-name"><a href="posts/2010/05/develop-a-modular-application-implementation.html" class="u-url">Develop a modular application – Implementation</a>
        <small>  
             Posted: <time class="published dt-published" datetime="2010-05-12T06:29:23+00:00">2010-05-12 06:29</time>
        </small></h1>
        <hr>
        <div class="e-content">
        <div><p></p><p>Now that we saw in details <a href="http://www.baptiste-wicht.com/2010/05/modular-application-modules/">the characteristics of the modules</a>, we'll see how to implement a module.</p>
<p>We need a simple container for our module to load it after with a loader from the modular application.</p>
<p>In this post, we'll only see what will be a module in Java, we'll the loading of the modules in the next (and last) post.</p>
<!--more-->

<p>A module is completely independent of the module, so we cannot include it directly in the application. We must distinguish the file of the module and the file of the application.</p>
<p>So what will be these files ? Because we're in Java, we use Jar files. So the modules will be Jar files extending the applications.</p>
<p>And now in Java, a module will be an interface  describing the main characteristics of the module. We'll be simple for the moment. A module must be pluggable to the application and unpluggable. Moreover the module has also a name and we can get this name. At this moment, this is all we need :</p>
<p>We must have a simple interface to describe a module :</p>
<p>[java]public interface IModule {
  public void plug();
  public void unplug();
  public String getName();
}[/java]</p>
<p>With that interface, we can create the most simple module that only prints to the console :</p>
<p>[java]package org.modules.simple; </p>
<p>public class SimpleModule implements IModule {
  @Override
  public void plug(){
    System.out.println("Hello kernel !");
  } </p>
<p>@Override
  public void unplug(){
    System.out.println("Bye kernel !");
  } </p>
<p>@Override
  public String getName(){
    return "Simple module";
  }
}[/java]</p>
<p>So we'll create a Jar file containing our class. We need a solution for the application to know which class to launch. So we need write this somewhere.</p>
<p>A naïve solution is to browse the Jar file and test each class if it implements the interface. This method works but is not optimal but that can be really inefficient in large Jar file. So we'll use the tools offered by Java and add an information in the Jar manifest to indicate to the application which class must be loaded.</p>
<p>So here it's the manifest for our example :</p>
<p></p><pre>Manifest-Version: 1.0
<p>Module-Class: org.modules.simple.SimpleModule</p></pre>
<p>With that the module loader will know which class it must instantiate to create a module.  An other solution is to use the ServiceLoader of Java 6.</p>
<p>In the next post, we'll see how to load our module and we'll test an application with two simples modules.</p></div>
        </div>
            
        
    <p>
        <a href="posts/2010/05/develop-a-modular-application-implementation.html#disqus_thread" data-disqus-identifier="cache/posts/2010/05/develop-a-modular-application-implementation.html">Comments</a>


        </p></article>
        <article class="postbox h-entry post-text">
        <h1 class="p-name"><a href="posts/2010/05/modular-application-modules.html" class="u-url">Develop a modular application – The modules</a>
        <small>  
             Posted: <time class="published dt-published" datetime="2010-05-10T06:24:29+00:00">2010-05-10 06:24</time>
        </small></h1>
        <hr>
        <div class="e-content">
        <div><p></p><p>After <a href="http://www.baptiste-wicht.com/2010/05/develop-a-modular-application-bases/">explaining what's a modular application</a>, I'll now explain with more details the concept of modules.</p>
<p>We said that a module add features to the application. But before writing any code, we've to define exactly what are the modules, what they can do if there is several types of modules, ...</p>
<p>This is what we'll see in this post.</p>
<!--more-->

<p>The first question to ask is "What can a module do ?". Namely, defining all the things a module can add to the application and how they can add these things. Moreover, a module can also modify the application.</p>
<p>What the modules can do depends on the type of the modular application :</p>
<p></p><ul>
    <li>For the first type (simple application with extension capability), the module adds specific features depending on the application. By example, in the case of an application that allows to watch television from internet, the modules can add a new channel or the support of a new video format. It can also adds a complete feature like statistics about channels. </li>
    <li>For the second type (empty application and modules that make the application features), the modules don't add features to the application, they do the application. In this case, the modules are often bigger than in the first case, because, modules are applications. There is often no links between modules, one can create a calculator and the other a video editor. </li>
</ul>
<p>In the two cases, we've to define several extension points. By example, here are the extension points I created for JTheque : </p>
<ul>
    <li>Add tabs in the main view</li>
    <li>Add components in the state bar</li>
    <li>Add features to the menu</li>
    <li>Add configuration options</li>
</ul>

<p>With there extension points, the modules can do a lot of things. If we want to make a calculator, we can add a tab in the main view or add a feature in the menu that displays a calculator in a dialog. Of course, this extension points depends of the developer and the application, but this is really important to define well a list of this points. </p>
<p>More than providing extension points, the core of the application provide also a set of services to the modules. These services can be simple utility classes or by example a persistence manager or a file manager. </p>
<p>One more time, you've to decided which services the core will provide to the modules. This services are not essential, but that enables to simplify a lot the modules. And that improve the code standard of the modules. With that model, the modules will always use the same type of services, this is easier to manage.  </p>
<p>By example, here are some of services, JTheque Core offers to the modules : </p>
<ul>
    <li>Error manager : To display some errors. </li>
    <li>View manager : To create easily new views, display messages, ask something to the user. </li>
    <li>Resource manager : Provide an image cache and utility methods to load image, create thumbnail, ...</li>
    <li>Persistence manager : Give the ability to modules to persist objects</li>
    <li>State manager : Store states for modules</li>
</ul>

<p>We can also think if we want only one type of modules or several. By example, you can imagine primary modules and normal modules. Only a primary module can be launched at the same time. </p>
<p>The last point I see, is the point of the dependencies between modules. We can allows that a module depends on an other modules. This add a difficulty level for the implementation, because we must verify that the dependencies are solved before launch a module. And what about circular dependencies ? This is the choice of developer, but if you don't allow dependencies between modules, it can e difficult to create good applications. </p>
<p>So I've finished to talk about modules. Don't hesitate to comment if you doesn't agree with something or if you have questions. In the next I'll implement the first modules and in the last, I will create a simple loader for modules. </p></div>
        </div>
            
        
    <p>
        <a href="posts/2010/05/modular-application-modules.html#disqus_thread" data-disqus-identifier="cache/posts/2010/05/modular-application-modules.html">Comments</a>


        </p></article>
        <article class="postbox h-entry post-text">
        <h1 class="p-name"><a href="posts/2010/05/java-concurrency-part-1-threads.html" class="u-url">Java Concurrency - Part 1 : Threads</a>
        <small>  
             Posted: <time class="published dt-published" datetime="2010-05-07T06:12:33+00:00">2010-05-07 06:12</time>
        </small></h1>
        <hr>
        <div class="e-content">
        <div><p></p><p>This post is the first of set of posts about <strong>Java Concurrency</strong>.</p>
<p>The concurrency is the fact to made several things at the same time using several threads.</p>
<p>A thread, also called <strong>Lightweight Process</strong>, is treatment unity. Threads executes code in <strong>parallel</strong> of each other threads currently running. When you've only one processor, there is a thread running at the same time of the others, you only have the impression of <strong>concurrency</strong> (I don't say it's not useful, I say it's different), but when you've <strong>multiple processors</strong>, you'll see the power of multithreading. In this case, you can have your threads distributed on the processors of the computer.</p>
<!--more-->

<p>In Java, a thread is an instance of the class java.lang.Thread. A Thread can be managed in one of these two ways :</p>
<p></p><ol>
    <li>Directly mapped to a native thread of the operating system. This is used when the operating system provide a preemptive threading system.</li>
    <li>Managed by the virtual machine in a preemptive way.</li>
</ol>
<p>A preemptive system, is a system in which the threads are managed by a scheduler and can be interrupted at any time to give processor to an other thread. When you program, you doesn't have to pay attention of which type of threads you use, the result will normally be the same. But you've to know that there can differences between operating systems.</p>
<p>There is three very important concepts when doing concurrent programming :</p>
<ol>
    <li>Atomicity : An operation is said atomic when it cannot be interrupted. There is almost no atomic operations in Java, the only we've is the assignation a = 5, but a = b++ is not atomic. In some cases, you'll have to make atomic some actions with synchronization, we'll see later how to do that.</li>
    <li>Visibility : This occurs when a thread must watch the actions of an other threads by example the termination of the thread. This also implies some kind of synchronization.</li>
    <li>Order of execution : When you have normal program, all you lines of code run in the same order every time you launch the application. This is not the case when you make concurrent programming. You first instruction can followed by an instruction of the thread B or by the first instruction. And that can change every time you launch the application. <strong>The order of execution is not guaranteed !</strong> I will certainly repeat that sometimes, but that's important to know.</li>
</ol>

<p>We'll see these concepts more deeply in the others parts of the set.</p>
<p>Lets start introducing the Thread class in Java. You can create threads in two ways :</p>
<ol>
    <li>Extends <strong>Thread</strong></li>
    <li>Implements <strong>Runnable</strong> and pass an instance of your news class to the Thread constructor</li>
</ol>

<p>The first solution isn't a good solution because what you're creating is not a new specialized thread, but several instructions to run in a new Thread, namely a Runnable. Implementing Runnable is also better because Runnable is an interface and so, you can also extends a class and implementing Runnable, that's useful in some cases.</p>
<p>In my examples, I'll always use the second way. So let's declare our first Runnable :</p>
<p>[java]public class MyFirstRunnable implements Runnable{
    @Override
    public void run() {
        System.out.println("In a thread");
    }
}[/java]</p>
<p>And use it to create a new Thread and start it :</p>
<p>[java]Thread thread = new Thread(new MyFirstRunnable());</p>
<p>thread.start();[/java]</p>
<p>The Thread will stopped when the end of the run() will be reached. You cannot force a thread to stop (there is stop() method, but deprecated), we'll see later how to properly stop a thread.</p>
<p>And now, what happens if we add a simple line of code to our program :</p>
<p>[java]Thread thread = new Thread(new MyFirstRunnable());</p>
<p>thread.start();</p>
<p>System.out.println("In the main Thread");[/java]</p>
<p>Can you predict the result of this code ? Nobody can't, it's not predictable, you can have :</p>
<pre>In a thread

In the main Thread</pre>

<p>or</p>
<pre>In the main Thread

In a thread</pre>

<p>And we cannot do better than that.</p>
<p>You can use the Runnable several times :</p>
<p>[java]Runnable runnable = new MyFirstRunnable();</p>
<p>for(int i = 0; i &amp;lt; 25; i++){
    new Thread(runnable).start();
}[/java]</p>
<p>Now, 25 threads are launched.</p>
<p>You can also give names to Thread using the setName() method. You can get the name of the current thread using Thread.currentThread().getName(). Let's do a little example :</p>
<p>[java]public class MySecondRunnable implements Runnable{
    @Override
    public void run() {
        System.out.printf("I'm running in thread %s \n", Thread.currentThread().getName());
    }
}[/java]</p>
<p>[java]Runnable runnable = new MySecondRunnable();</p>
<p>for(int i = 0; i &amp;lt; 25; i++){
    Thread thread = new Thread(runnable);
    thread.setName("Thread " + i);
    thread.start();
}[/java]</p>
<p>This is the best example to see that the other is unpredictable. Here are two executions on my machine :</p>
<p>1.</p>
<pre>I'm running in thread Thread 0

I'm running in thread Thread 1

I'm running in thread Thread 2

I'm running in thread Thread 3

I'm running in thread Thread 4

I'm running in thread Thread 5

I'm running in thread Thread 7

I'm running in thread Thread 14

I'm running in thread Thread 13

I'm running in thread Thread 12

I'm running in thread Thread 11

I'm running in thread Thread 10

I'm running in thread Thread 9

I'm running in thread Thread 8

I'm running in thread Thread 6

I'm running in thread Thread 15

I'm running in thread Thread 16

I'm running in thread Thread 17

I'm running in thread Thread 18

I'm running in thread Thread 19

I'm running in thread Thread 20

I'm running in thread Thread 21

I'm running in thread Thread 22

I'm running in thread Thread 23

I'm running in thread Thread 24</pre>

<p>2.</p>
<pre>I'm running in thread Thread 0

I'm running in thread Thread 1

I'm running in thread Thread 2

I'm running in thread Thread 3

I'm running in thread Thread 4

I'm running in thread Thread 5

I'm running in thread Thread 6

I'm running in thread Thread 7

I'm running in thread Thread 8

I'm running in thread Thread 9

I'm running in thread Thread 10

I'm running in thread Thread 11

I'm running in thread Thread 12

I'm running in thread Thread 13

I'm running in thread Thread 14

I'm running in thread Thread 15

I'm running in thread Thread 16

I'm running in thread Thread 17

I'm running in thread Thread 18

I'm running in thread Thread 19

I'm running in thread Thread 20

I'm running in thread Thread 21

I'm running in thread Thread 22

I'm running in thread Thread 23

I'm running in thread Thread 24</pre>

<p>Like you can see, the order the threads instructions are executed is not guaranteed at all.</p>
<p>So here we are with the first part of this suite of articles about Java Concurrency. In the next post, we'll see the operations you can make directly on threads (stopping, joining, sleeping, ...).</p>
<p>I hope you found that post interesting.</p>
<p>The sources of this post are available here : <a href="wp-content/uploads/2010/05/Part1.tar.gz">Java Concurrency Sources Part 1</a>. </p></div>
        </div>
            
        
    <p>
        <a href="posts/2010/05/java-concurrency-part-1-threads.html#disqus_thread" data-disqus-identifier="cache/posts/2010/05/java-concurrency-part-1-threads.html">Comments</a>


        </p></article>
        <article class="postbox h-entry post-text">
        <h1 class="p-name"><a href="posts/2010/05/develop-a-modular-application-bases.html" class="u-url">Develop a modular application – Bases</a>
        <small>  
             Posted: <time class="published dt-published" datetime="2010-05-06T06:28:38+00:00">2010-05-06 06:28</time>
        </small></h1>
        <hr>
        <div class="e-content">
        <div><p></p><p>This is the first post of four posts about modular applications.</p>
<p>I'll try to explain all the things we must think of when we develop a modular application. I'm developing a generic core for modular applications, JTheque. So what I'm saying in this posts are taken from my experience developing this framework. </p>
<p>In this post, i'll start talking of the bases of the conception of modular application. So what's a modular application, a module and what give to the developer and the user to have a modular application ? In the next posts, I'll describe the problems we could found relating to modules and loading. The examples will be in Java, but all the concepts can be applied to every language. I'll not talk about OSGi, this is more an introduction to modular programming without specific framework, but of course, OSGi is a very good solution to modular programming.</p>
<p>Of course, I don't think i'm a professional in modular programming and what I'll say in this post, is nothing else than my point of view. If you think there is better solutions than what I present, don't hesitate to say that in comments.</p>
<!--more-->

<p>To start, what's a modular application ? A modular application is made of 2 distinct parts : </p>
<p>The core : Like its name says, this is the central part of the application. This part must be completely independent of the modules. </p>
<p>The modules : It's the dynamic parts we'll add to the application to add features. There is other name for modules : add-ons, plugins and lot of other name, but the concept is the same. </p>
<p>I think there is two types of modular applications. The first type is a normal application who provide several features and give the user the possibility to add functionalities with modules. The second type is an application who has a core without feature. All the features are provided by the modules, so, "All is module". </p>
<p>The main difference is that the first type can be used like any other application without modules, but the second one is not useful without modules. </p>
<p>In these two types of applications, you've to define some extension points for the modules. With that extension points, the modules can add features to the application or modify some features. </p>
<p>JTheque is based on the second type. JTheque Core is a simple core to develop modular applications. We can also talk of Eclipse that is a fully modular framework. </p>
<p>Now the question is : that seems good but what the hell does that offer ? First, from the point of view of a developer, this allows to clearly separate the different parts of its application. We've distinct modules easier to maintain than a big applications. It's also easy to add features to applications. And last but not least, you can use the core several times for building different applications. From the point of view of the user, he can choose which modules he want to launch, add new modules and perhaps create some modules if he can. So he can customize applications. </p>
<p>But, that not trivial to make, you've to make a good conceptions and implement it in a clean way. When you do, you find some problmens to solve and a lot of questions to ask. We'll see all the problems and questions in <a href="http://www.baptiste-wicht.com/2010/05/modular-application-modules/">the next post</a>. </p></div>
        </div>
            
        
    <p>
        <a href="posts/2010/05/develop-a-modular-application-bases.html#disqus_thread" data-disqus-identifier="cache/posts/2010/05/develop-a-modular-application-bases.html">Comments</a>


        </p></article>
        <article class="postbox h-entry post-text">
        <h1 class="p-name"><a href="posts/2010/05/sonar-2-1-has-been-released.html" class="u-url">Sonar 2.1 has been released</a>
        <small>  
             Posted: <time class="published dt-published" datetime="2010-05-05T10:45:17+00:00">2010-05-05 10:45</time>
        </small></h1>
        <hr>
        <div class="e-content">
        <div><p></p><p>The version 2.1 of Sonar has just been released. This version includes 51 bugfixes and improvements. The major new features are :
</p><ul>
    <li>A new page "Librairies" displays all the librairies of the project (Maven dependencies)</li>
    <li>A new page "Dependencies" searches for library usages</li>
    <li>A new page "System Info" display the system properties, installed plugins, database and VM memory stats.</li>
    <li>New rules to detect unused methods.</li>
</ul>
<p>Normally, all the plugins compatible with version 2.0 should be compatible with this new version. </p></div>
        </div>
            
        
    <p>
        <a href="posts/2010/05/sonar-2-1-has-been-released.html#disqus_thread" data-disqus-identifier="cache/posts/2010/05/sonar-2-1-has-been-released.html">Comments</a>


        </p></article>
    
        <div>
        <ul class="pager">
            <li class="previous">
                <a href="index-7.html" rel="prev">← Newer posts</a>
            </li>
            <li class="next">
                <a href="index-5.html" rel="next">Older posts →</a>
            </li>
        </ul>
        </div>

    
        
       <script>var disqus_shortname="blogwichtounet";(function(){var a=document.createElement("script");a.async=true;a.src="//"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>


	


        </div>
        <!--End of body content-->

        <footer>
            Contents © 2014         <a href="mailto:baptistewicht@gmail.com">Baptiste Wicht</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by/4.0/88x31.png"></a>
        </footer>
    </div>
</div>


            <script src="assets/js/all-nocdn.js" type="text/javascript"></script>


    
<!-- Social buttons -->
<div id="addthisbox" class="addthis_toolbox addthis_peekaboo_style addthis_default_style addthis_label_style addthis_32x32_style">
<a class="addthis_button_more">Share</a>
<ul><li><a class="addthis_button_facebook"></a>
</li><li><a class="addthis_button_google_plusone_share"></a>
</li><li><a class="addthis_button_linkedin"></a>
</li><li><a class="addthis_button_twitter"></a>
</li></ul>
</div>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4f7088a56bb93798"></script>
<!-- End of social buttons -->


    <script type="text/javascript">jQuery("a.image-reference").colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script>
    

<script type="text/javascript" src="assets/js/tipuesearch_set.js"></script>
<script type="text/javascript" src="assets/js/tipuesearch.js"></script>
<script type="text/javascript">
$(document).ready(function() {
  $('#tipue_search_input').tipuesearch({
      'mode': 'json',
      'contentLocation': '/assets/js/tipuesearch_content.json',
      'showUrl': false
  });
});
</script>


</body></html>